# AIRIS EPM Application Service
apiVersion: v1
kind: Service
metadata:
  name: airis-epm-app-service
  namespace: airis-epm
  labels:
    app: airis-epm
    component: application
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-type: nlb
spec:
  type: LoadBalancer
  ports:
  - port: 80
    targetPort: 3000
    protocol: TCP
    name: http
  - port: 443
    targetPort: 3000
    protocol: TCP
    name: https
  selector:
    app: airis-epm
    component: application

---
# Internal ClusterIP Service for app-to-app communication
apiVersion: v1
kind: Service
metadata:
  name: airis-epm-internal
  namespace: airis-epm
  labels:
    app: airis-epm
    component: application
spec:
  type: ClusterIP
  ports:
  - port: 3000
    targetPort: 3000
    protocol: TCP
    name: http
  selector:
    app: airis-epm
    component: application

---
# ClickHouse Service
apiVersion: v1
kind: Service
metadata:
  name: airis-epm-clickhouse
  namespace: airis-epm
  labels:
    app: airis-epm
    component: clickhouse
spec:
  type: ClusterIP
  ports:
  - port: 8123
    targetPort: 8123
    protocol: TCP
    name: http
  - port: 9000
    targetPort: 9000
    protocol: TCP
    name: native
  selector:
    app: airis-epm
    component: clickhouse

---
# PostgreSQL Service
apiVersion: v1
kind: Service
metadata:
  name: airis-epm-postgres
  namespace: airis-epm
  labels:
    app: airis-epm
    component: postgres
spec:
  type: ClusterIP
  ports:
  - port: 5432
    targetPort: 5432
    protocol: TCP
    name: postgres
  selector:
    app: airis-epm
    component: postgres

---
# Redis Service
apiVersion: v1
kind: Service
metadata:
  name: airis-epm-redis
  namespace: airis-epm
  labels:
    app: airis-epm
    component: redis
spec:
  type: ClusterIP
  ports:
  - port: 6379
    targetPort: 6379
    protocol: TCP
    name: redis
  selector:
    app: airis-epm
    component: redis

---
# MongoDB Service
apiVersion: v1
kind: Service
metadata:
  name: airis-epm-mongodb
  namespace: airis-epm
  labels:
    app: airis-epm
    component: mongodb
spec:
  type: ClusterIP
  ports:
  - port: 27017
    targetPort: 27017
    protocol: TCP
    name: mongodb
  selector:
    app: airis-epm
    component: mongodb

---
# Headless Service for StatefulSet services (if needed)
apiVersion: v1
kind: Service
metadata:
  name: airis-epm-headless
  namespace: airis-epm
  labels:
    app: airis-epm
spec:
  type: ClusterIP
  clusterIP: None
  ports:
  - port: 3000
    targetPort: 3000
    protocol: TCP
    name: http
  selector:
    app: airis-epm