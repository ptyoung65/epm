<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì„¸ì…˜ ë¦¬í”Œë ˆì´ ê´€ë¦¬ - AIRIS APM</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <link href="./css/tailwind.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- rrweb ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
  <script src="https://cdn.jsdelivr.net/npm/rrweb@latest/dist/rrweb.min.js"></script>
  <!-- rrweb í”Œë ˆì´ì–´ -->
  <script src="https://unpkg.com/rrweb-player@latest/dist/index.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/rrweb-player@latest/dist/style.css">
  
  <style>
    * {
      font-family: 'Inter', sans-serif;
    }
    
    /* shadcn/ui CSS Variables */
    :root {
      --background: 0 0% 100%;
      --foreground: 222.2 84% 4.9%;
      --card: 0 0% 100%;
      --card-foreground: 222.2 84% 4.9%;
      --popover: 0 0% 100%;
      --popover-foreground: 222.2 84% 4.9%;
      --primary: 222.2 47.4% 11.2%;
      --primary-foreground: 210 40% 98%;
      --secondary: 210 40% 96%;
      --secondary-foreground: 222.2 47.4% 11.2%;
      --muted: 210 40% 96%;
      --muted-foreground: 215.4 16.3% 46.9%;
      --accent: 210 40% 96%;
      --accent-foreground: 222.2 47.4% 11.2%;
      --destructive: 0 84.2% 60.2%;
      --destructive-foreground: 210 40% 98%;
      --border: 214.3 31.8% 91.4%;
      --input: 214.3 31.8% 91.4%;
      --ring: 222.2 84% 4.9%;
      --radius: 0.5rem;
    }

    .dark {
      --background: 222.2 84% 4.9%;
      --foreground: 210 40% 98%;
      --card: 222.2 84% 4.9%;
      --card-foreground: 210 40% 98%;
      --popover: 222.2 84% 4.9%;
      --popover-foreground: 210 40% 98%;
      --primary: 210 40% 98%;
      --primary-foreground: 222.2 47.4% 11.2%;
      --secondary: 222.2 84% 4.9%;
      --secondary-foreground: 210 40% 98%;
      --muted: 222.2 84% 4.9%;
      --muted-foreground: 215.4 16.3% 46.9%;
      --accent: 222.2 84% 4.9%;
      --accent-foreground: 210 40% 98%;
      --destructive: 0 62.8% 30.6%;
      --destructive-foreground: 210 40% 98%;
      --border: 217.2 32.6% 17.5%;
      --input: 217.2 32.6% 17.5%;
      --ring: 212.7 26.8% 83.9%;
    }

    .bg-background { background-color: hsl(var(--background)); }
    .text-foreground { color: hsl(var(--foreground)); }
    .bg-card { background-color: hsl(var(--card)); }
    .text-card-foreground { color: hsl(var(--card-foreground)); }
    .bg-primary { background-color: hsl(var(--primary)); }
    .text-primary-foreground { color: hsl(var(--primary-foreground)); }
    .text-primary { color: hsl(var(--primary)); }
    .text-muted-foreground { color: hsl(var(--muted-foreground)); }
    .border-border { border-color: hsl(var(--border)); }
    .text-destructive { color: hsl(var(--destructive)); }
    
    .metric-card {
      transition: all 0.2s ease-in-out;
    }
    
    .metric-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }
    
    .chart-container {
      position: relative;
      height: 256px;
      width: 100%;
    }
    
    /* íƒ­ ì‹œìŠ¤í…œ ìŠ¤íƒ€ì¼ */
    .tab-btn {
      transition: all 0.2s ease-in-out;
    }
    
    .tab-btn:hover {
      background-color: hsl(var(--muted));
      color: hsl(var(--foreground));
    }
    
    .tab-content {
      animation: fadeIn 0.3s ease-in-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* ì„¸ì…˜ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
    .session-card {
      transition: all 0.2s ease-in-out;
      border: 1px solid hsl(var(--border));
      background: hsl(var(--card));
    }
    
    .session-card:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px -4px rgba(0, 0, 0, 0.1);
      border-color: hsl(var(--primary));
    }
    
    /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ - shadcn/ui í˜¸í™˜ */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      white-space: nowrap;
      border-radius: calc(var(--radius) - 2px);
      font-size: 0.875rem;
      font-weight: 500;
      transition: all 0.15s ease-in-out;
      border: none;
      cursor: pointer;
      text-decoration: none;
    }
    
    .btn:hover {
      opacity: 0.9;
      transform: translateY(-1px);
    }
    
    .btn:active {
      transform: translateY(0);
    }
  </style>
    
    <!-- AIRIS í†µí•© ì„¸ì…˜ ì¶”ì ê¸° -->
    <script>
      /**
       * AIRIS í†µí•© ì„¸ì…˜ ì¶”ì ê¸° - ì‹¤ì œ ì‘ë™ ë²„ì „
       * rrweb ê¸°ë°˜ ì„¸ì…˜ ê¸°ë¡ ë° ì¬ìƒ ê¸°ëŠ¥
       */
      (function(global) {
        'use strict';

        class AIRISSessionTracker {
          constructor() {
            this.sessionId = null;
            this.isRecording = false;
            this.events = [];
            this.recorder = null;
            this.eventsCount = 0;
            this.pageCount = 1;
            this.startTime = null;
            
            this.logger = {
              info: (msg, data) => console.log(`[AIRIS] ${msg}`, data || ''),
              warn: (msg, data) => console.warn(`[AIRIS] ${msg}`, data || ''),
              error: (msg, data) => console.error(`[AIRIS] ${msg}`, data || '')
            };
            
            this.logger.info('AIRIS ì„¸ì…˜ ì¶”ì ê¸° ì´ˆê¸°í™”ë¨');
          }

          generateSessionId() {
            return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
          }

          startRecording(options = {}) {
            if (this.isRecording) {
              this.logger.warn('ì´ë¯¸ ê¸°ë¡ ì¤‘ì…ë‹ˆë‹¤');
              return { success: false, message: 'ì´ë¯¸ ê¸°ë¡ ì¤‘ì…ë‹ˆë‹¤' };
            }

            this.sessionId = this.generateSessionId();
            this.events = [];
            this.eventsCount = 0;
            this.pageCount = 1;
            this.startTime = Date.now();
            this.isRecording = true;

            try {
              this.recorder = rrweb.record({
                emit: (event, isCheckout) => {
                  if (this.isRecording) {
                    this.events.push(event);
                    this.eventsCount++;
                    
                    // ë©”íƒ€ ì´ë²¤íŠ¸ ì²˜ë¦¬
                    if (event.type === 2) { // Meta event
                      if (event.data && event.data.href && event.data.href !== window.location.href) {
                        this.pageCount++;
                      }
                    }
                    
                    // ì£¼ê¸°ì ìœ¼ë¡œ ë¡œì»¬ ì €ì¥
                    if (this.eventsCount % 50 === 0) {
                      this.saveToLocalStorage();
                    }
                  }
                },
                checkoutEveryNms: 10000,
                sampling: {
                  mousemove: false,
                  mouseInteraction: {
                    MouseUp: false,
                    MouseDown: false,
                    Click: true,
                    ContextMenu: false,
                    DblClick: false,
                    Focus: false,
                    Blur: false,
                    TouchStart: false,
                    TouchEnd: false,
                  }
                }
              });

              this.logger.info('ì„¸ì…˜ ê¸°ë¡ ì‹œì‘ë¨', {
                sessionId: this.sessionId,
                timestamp: new Date().toISOString()
              });

              return {
                success: true,
                sessionId: this.sessionId,
                message: 'ì„¸ì…˜ ê¸°ë¡ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤'
              };

            } catch (error) {
              this.logger.error('ì„¸ì…˜ ê¸°ë¡ ì‹œì‘ ì‹¤íŒ¨', error);
              this.isRecording = false;
              return {
                success: false,
                message: 'ì„¸ì…˜ ê¸°ë¡ ì‹œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message
              };
            }
          }

          stopRecording() {
            if (!this.isRecording) {
              this.logger.warn('í˜„ì¬ ê¸°ë¡ ì¤‘ì´ ì•„ë‹™ë‹ˆë‹¤');
              return { success: false, message: 'í˜„ì¬ ê¸°ë¡ ì¤‘ì´ ì•„ë‹™ë‹ˆë‹¤' };
            }

            try {
              if (this.recorder && typeof this.recorder === 'function') {
                this.recorder();
                this.recorder = null;
              }

              this.isRecording = false;
              const endTime = Date.now();
              const duration = endTime - this.startTime;

              // ìµœì¢… ì €ì¥
              this.saveToLocalStorage(true);

              const result = {
                success: true,
                sessionId: this.sessionId,
                eventsCount: this.eventsCount,
                pageCount: this.pageCount,
                duration: duration,
                events: [...this.events],
                message: `ì„¸ì…˜ ê¸°ë¡ ì™„ë£Œ: ${this.eventsCount}ê°œ ì´ë²¤íŠ¸, ${this.pageCount}ê°œ í˜ì´ì§€, ${Math.round(duration/1000)}ì´ˆ`
              };

              this.logger.info('ì„¸ì…˜ ê¸°ë¡ ì¤‘ì§€ë¨', result);
              return result;

            } catch (error) {
              this.logger.error('ì„¸ì…˜ ê¸°ë¡ ì¤‘ì§€ ì‹¤íŒ¨', error);
              return {
                success: false,
                message: 'ì„¸ì…˜ ê¸°ë¡ ì¤‘ì§€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message
              };
            }
          }

          saveToLocalStorage(isFinal = false) {
            if (!this.sessionId || this.events.length === 0) return;

            try {
              const sessionData = {
                session_id: this.sessionId,
                user_id: 'anonymous',
                url: window.location.href,
                korean_timestamp: new Date().toLocaleString('ko-KR', { timeZone: 'Asia/Seoul' }),
                start_time: this.startTime,
                duration: Date.now() - this.startTime,
                event_count: this.eventsCount,
                page_count: this.pageCount,
                events: [...this.events],
                status: isFinal ? 'completed' : 'recording',
                metadata: {
                  userAgent: navigator.userAgent,
                  viewport: {
                    width: window.innerWidth,
                    height: window.innerHeight
                  }
                }
              };

              const savedSessions = JSON.parse(localStorage.getItem('airisRecordedSessions') || '[]');
              
              // ê¸°ì¡´ ì„¸ì…˜ ì—…ë°ì´íŠ¸ ë˜ëŠ” ìƒˆë¡œ ì¶”ê°€
              const existingIndex = savedSessions.findIndex(s => s.session_id === this.sessionId);
              if (existingIndex >= 0) {
                savedSessions[existingIndex] = sessionData;
              } else {
                savedSessions.unshift(sessionData);
              }
              
              // ìµœëŒ€ 20ê°œ ì„¸ì…˜ë§Œ ë³´ê´€
              localStorage.setItem('airisRecordedSessions', JSON.stringify(savedSessions.slice(0, 20)));
              
              this.logger.info('ì„¸ì…˜ ë¡œì»¬ ì €ì¥ ì™„ë£Œ', {
                sessionId: this.sessionId,
                events: this.eventsCount,
                status: sessionData.status
              });

            } catch (error) {
              this.logger.error('ë¡œì»¬ ì €ì¥ ì‹¤íŒ¨', error);
            }
          }

          getStatus() {
            return {
              isRecording: this.isRecording,
              sessionId: this.sessionId,
              eventsCount: this.eventsCount,
              pageCount: this.pageCount,
              duration: this.startTime ? Date.now() - this.startTime : 0,
              startTime: this.startTime ? new Date(this.startTime) : null,
              eventCount: this.eventsCount,
              bufferSize: this.events.length
            };
          }

          start() {
            return this.startRecording();
          }

          stop() {
            return this.stopRecording();
          }

          getSavedSessions() {
            try {
              return JSON.parse(localStorage.getItem('airisRecordedSessions') || '[]');
            } catch (error) {
              this.logger.error('ì €ì¥ëœ ì„¸ì…˜ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨', error);
              return [];
            }
          }
        }

        // ì „ì—­ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
        window.airisTracker = new AIRISSessionTracker();
        window.airisRecorder = window.airisTracker; // í˜¸í™˜ì„±ì„ ìœ„í•œ ë³„ì¹­
        
        console.log('âœ… AIRIS ì„¸ì…˜ ì¶”ì ê¸° ë¡œë“œ ì™„ë£Œ');
        
      })(window);
    </script>
</head>
<body class="bg-background text-foreground">
  <!-- Header Navigation -->
  <header class="bg-background sticky top-0 z-50 w-full border-b border-border backdrop-blur">
    <div class="container mx-auto flex h-16 items-center px-4">
      <div class="flex items-center space-x-4">
        <div class="h-8 w-8 bg-primary rounded-lg flex items-center justify-center">
          <span class="text-primary-foreground font-bold text-lg">A</span>
        </div>
        <div>
          <h1 class="text-lg font-bold text-foreground">AIRIS APM</h1>
          <p class="text-xs text-muted-foreground">í†µí•© ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ</p>
        </div>
      </div>
      
      <!-- Navigation Menu -->
      <nav class="flex items-center space-x-6 text-sm ml-6">
        <button onclick="window.location.href = '/'" class="text-foreground/60 hover:text-foreground/80 transition-colors bg-transparent border-none cursor-pointer">
          í†µí•© ëŒ€ì‹œë³´ë“œ
        </button>
        <button onclick="window.location.href = '/j2ee-dashboard.html'" class="text-foreground/60 hover:text-foreground/80 transition-colors bg-transparent border-none cursor-pointer">
          J2EE ëª¨ë‹ˆí„°ë§
        </button>
        <button onclick="window.location.href = '/was-dashboard.html'" class="text-foreground/60 hover:text-foreground/80 transition-colors bg-transparent border-none cursor-pointer">
          WAS ëª¨ë‹ˆí„°ë§
        </button>
        <button onclick="window.location.href = '/exception-dashboard.html'" class="text-foreground/60 hover:text-foreground/80 transition-colors bg-transparent border-none cursor-pointer">
          ì˜ˆì™¸ ì¶”ì 
        </button>
        <button onclick="window.location.href = '/topology-dashboard.html'" class="text-foreground/60 hover:text-foreground/80 transition-colors bg-transparent border-none cursor-pointer">
          ì„œë¹„ìŠ¤ í† í´ë¡œì§€
        </button>
        <button onclick="window.location.href = '/alert-dashboard.html'" class="text-foreground/60 hover:text-foreground/80 transition-colors bg-transparent border-none cursor-pointer">
          ì•Œë¦¼ ê´€ë¦¬
        </button>
        <button onclick="window.location.href = '/ontology.html'" class="text-foreground/60 hover:text-foreground/80 transition-colors bg-transparent border-none cursor-pointer">
          ì˜¨í†¨ë¡œì§€
        </button>
        <span class="font-medium text-foreground/80 hover:text-foreground transition-colors">
          ì„¸ì…˜ ë¦¬í”Œë ˆì´
        </span>
        <button onclick="window.location.href = '/session-telemetry-dashboard.html'" class="text-foreground/60 hover:text-foreground/80 transition-colors bg-transparent border-none cursor-pointer">
          ğŸ”— ì„¸ì…˜-í…”ë ˆë©”íŠ¸ë¦¬ ë¶„ì„
        </button>
      </nav>
      
      <div class="flex items-center space-x-4 ml-auto">
        <select id="timeRange" class="text-sm border border-border rounded-md px-3 py-1 bg-background">
          <option value="1h">ìµœê·¼ 1ì‹œê°„</option>
          <option value="24h" selected>ìµœê·¼ 24ì‹œê°„</option>
          <option value="7d">ìµœê·¼ 7ì¼</option>
          <option value="30d">ìµœê·¼ 30ì¼</option>
        </select>
        
        <button id="refreshBtn" class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-3">
          ìƒˆë¡œê³ ì¹¨
        </button>
        
        <button id="themeToggle" class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 w-9">
          ğŸŒ™
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="container mx-auto px-4 py-6">
    <!-- Session Status Card -->
    <div class="bg-card border border-border rounded-lg p-6 shadow-sm mb-6 metric-card">
      <h3 class="text-lg font-semibold text-card-foreground mb-4">ğŸ“Š ì„¸ì…˜ ìƒíƒœ</h3>
      <div id="sessionStatus" class="text-muted-foreground mb-4">ë¡œë”© ì¤‘...</div>
      
      <div class="flex flex-wrap gap-3">
        <button id="testBtn" class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-orange-500 text-white hover:bg-orange-600 h-9 px-4 py-2">
          ğŸ§ª í…ŒìŠ¤íŠ¸ ë²„íŠ¼
        </button>
        <button id="startBtn" class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-green-500 text-white hover:bg-green-600 h-9 px-4 py-2">
          ğŸ”´ ê¸°ë¡ ì‹œì‘
        </button>
        <button id="stopBtn" class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-red-500 text-white hover:bg-red-600 h-9 px-4 py-2">
          â¹ï¸ ê¸°ë¡ ì¤‘ì§€
        </button>
        <button id="updateBtn" class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-9 px-4 py-2">
          ğŸ”„ ìƒíƒœ ì—…ë°ì´íŠ¸
        </button>
      </div>
    </div>

    <!-- Interactive Test Card -->
    <div class="bg-card border border-border rounded-lg p-6 shadow-sm mb-6 metric-card">
      <h3 class="text-lg font-semibold text-card-foreground mb-4">ğŸ§ª ìƒí˜¸ì‘ìš© í…ŒìŠ¤íŠ¸</h3>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
        <div class="space-y-2">
          <label for="nameInput" class="text-sm font-medium text-foreground">ì´ë¦„</label>
          <input type="text" id="nameInput" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" 
                 class="flex h-10 w-full rounded-md border border-border bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50">
        </div>
        
        <div class="space-y-2">
          <label for="categorySelect" class="text-sm font-medium text-foreground">ì¹´í…Œê³ ë¦¬</label>
          <select id="categorySelect" 
                  class="flex h-10 w-full items-center justify-between rounded-md border border-border bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50">
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <option value="home">í™ˆí˜ì´ì§€</option>
            <option value="product">ì œí’ˆ í˜ì´ì§€</option>
            <option value="about">íšŒì‚¬ ì†Œê°œ</option>
          </select>
        </div>
      </div>
      
      <div class="space-y-2 mb-4">
        <label for="memoTextarea" class="text-sm font-medium text-foreground">ë©”ëª¨</label>
        <textarea id="memoTextarea" rows="3" placeholder="ë©”ëª¨ë¥¼ ì‘ì„±í•˜ì„¸ìš”"
                  class="flex min-h-[80px] w-full rounded-md border border-border bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"></textarea>
      </div>
      
      <div class="flex flex-wrap gap-3">
        <button id="randomBtn" class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-9 px-4 py-2">
          ğŸ² ëœë¤ ì•¡ì…˜
        </button>
        <button id="errorBtn" class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-yellow-500 text-white hover:bg-yellow-600 h-9 px-4 py-2">
          âš ï¸ ì˜¤ë¥˜ ë°œìƒ
        </button>
      </div>
    </div>

    <!-- Tab-based Session Management System -->
    <div class="bg-card border border-border rounded-lg p-6 metric-card">
      <h3 class="text-lg font-semibold text-card-foreground mb-6">ğŸ¬ ì„¸ì…˜ ê´€ë¦¬ ì‹œìŠ¤í…œ</h3>
      
      <!-- Tab Navigation -->
      <div class="border-b border-border mb-6">
        <nav class="flex space-x-1" role="tablist">
          <button class="tab-btn px-4 py-2 font-medium text-sm rounded-t-md transition-colors" 
                  data-tab="sessions" onclick="switchTab('sessions')" 
                  style="color: hsl(var(--primary)); border-bottom: 2px solid hsl(var(--primary));">
            ğŸ“‹ ì„¸ì…˜ ëª©ë¡
          </button>
          <button class="tab-btn px-4 py-2 font-medium text-sm rounded-t-md transition-colors text-muted-foreground hover:text-foreground" 
                  data-tab="player" onclick="switchTab('player')">
            ğŸ¥ ì„¸ì…˜ í”Œë ˆì´ì–´
          </button>
          <button class="tab-btn px-4 py-2 font-medium text-sm rounded-t-md transition-colors text-muted-foreground hover:text-foreground" 
                  data-tab="settings" onclick="switchTab('settings')">
            âš™ï¸ ì„¤ì •
          </button>
        </nav>
      </div>
                
      <!-- Tab Contents -->
      
      <!-- Sessions List Tab -->
      <div id="tab-sessions" class="tab-content" style="display: block;">
        <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
          <h4 class="text-green-800 font-medium mb-2">ğŸ“‹ ì €ì¥ëœ ì„¸ì…˜ ê´€ë¦¬</h4>
          <p class="text-green-700 text-sm">ê¸°ë¡ëœ ì„¸ì…˜ì„ í™•ì¸í•˜ê³  ê´€ë¦¬í•˜ì„¸ìš”. ì„¸ì…˜ì„ ì„ íƒí•˜ë©´ í”Œë ˆì´ì–´ íƒ­ì—ì„œ ì¬ìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>
        
        <div class="flex flex-wrap gap-3 mb-4 items-center">
          <button onclick="refreshSessionList()" class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-green-500 text-white hover:bg-green-600 h-9 px-4 py-2">
            ğŸ”„ ìƒˆë¡œê³ ì¹¨
          </button>
          <button onclick="clearAllSessions()" class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-red-500 text-white hover:bg-red-600 h-9 px-4 py-2">
            ğŸ—‘ï¸ ëª¨ë“  ì„¸ì…˜ ì‚­ì œ
          </button>
          <span id="sessionCount" class="text-muted-foreground text-sm">ì„¸ì…˜ ë¡œë”© ì¤‘...</span>
        </div>
        
        <div id="sessionsList" class="max-h-96 overflow-y-auto space-y-2">
          <div class="text-center py-8 text-muted-foreground">
            <h4 class="font-medium mb-2">ğŸ“‚ ì„¸ì…˜ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</h4>
            <p class="text-sm">ì ì‹œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.</p>
          </div>
        </div>
      </div>
                
      <!-- Session Player Tab -->
      <div id="tab-player" class="tab-content" style="display: none;">
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
          <h4 class="text-blue-800 font-medium mb-2">ğŸ¥ í–¥ìƒëœ ì„¸ì…˜ í”Œë ˆì´ì–´</h4>
          <p class="text-blue-700 text-sm">session-player.htmlì˜ ëª¨ë“  ê¸°ëŠ¥ì„ í†µí•©í•œ ê³ ê¸‰ í”Œë ˆì´ì–´ì…ë‹ˆë‹¤. rrweb-playerì™€ ëŒ€ì²´ í”Œë ˆì´ì–´ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.</p>
        </div>
        
        <div class="flex flex-wrap gap-4 items-center mb-4">
          <select id="enhancedSessionSelect" class="flex-1 min-w-[300px] px-3 py-2 border border-border rounded-md bg-background text-foreground focus:ring-2 focus:ring-primary focus:border-transparent">
            <option value="">ì„¸ì…˜ì„ ì„ íƒí•˜ì„¸ìš”...</option>
          </select>
          <button onclick="loadEnhancedSession()" class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-blue-500 text-white hover:bg-blue-600 h-9 px-4 py-2 whitespace-nowrap">
            ğŸ“‚ ì„¸ì…˜ ë¡œë“œ
          </button>
          <span id="enhancedStatus" class="px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800">
            ì¤€ë¹„ ì¤‘...
          </span>
        </div>
        
        <div id="enhancedSessionInfo" class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4 hidden">
          <h4 class="text-blue-800 font-medium mb-2">ğŸ“Š ì„¸ì…˜ ì •ë³´</h4>
          <div id="enhancedSessionDetails" class="text-blue-700 text-sm"></div>
        </div>
        
        <div id="enhancedPlayerContainer" class="w-full min-h-[500px] border border-border rounded-lg bg-card flex items-center justify-center text-muted-foreground">
          <div class="text-center">
            <h4 class="font-medium mb-2">ğŸ¥ ì„¸ì…˜ í”Œë ˆì´ì–´</h4>
            <p class="text-sm mb-4">ìœ„ì—ì„œ ì„¸ì…˜ì„ ì„ íƒí•˜ê³  ë¡œë“œí•˜ë©´ ì—¬ê¸°ì— í”Œë ˆì´ì–´ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.</p>
            <p class="text-xs text-muted-foreground">ğŸ’¡ íŒ: ì„¸ì…˜ ëª©ë¡ íƒ­ì—ì„œ ì„¸ì…˜ì„ í™•ì¸í•œ í›„ ì—¬ê¸°ì„œ ì¬ìƒí•˜ì„¸ìš”.</p>
          </div>
        </div>
      </div>
                
      <!-- Settings Tab -->
      <div id="tab-settings" class="tab-content" style="display: none;">
        <div class="bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4">
          <h4 class="text-amber-800 font-medium mb-2">âš™ï¸ í”Œë ˆì´ì–´ ì„¤ì •</h4>
          <p class="text-amber-700 text-sm">ì„¸ì…˜ í”Œë ˆì´ì–´ì˜ ë™ì‘ê³¼ ì €ì¥ì†Œë¥¼ ì„¤ì •í•˜ì„¸ìš”.</p>
        </div>
        
        <div class="grid gap-6 max-w-2xl">
          <div class="bg-card border border-border rounded-lg p-4">
            <h5 class="font-medium text-card-foreground mb-3">ğŸ® í”Œë ˆì´ì–´ ì˜µì…˜</h5>
            <div class="space-y-2">
              <label class="flex items-center space-x-2">
                <input type="checkbox" id="autoPlay" class="rounded border-border">
                <span class="text-sm text-card-foreground">ìë™ ì¬ìƒ í™œì„±í™”</span>
              </label>
              <label class="flex items-center space-x-2">
                <input type="checkbox" id="showController" checked class="rounded border-border">
                <span class="text-sm text-card-foreground">í”Œë ˆì´ì–´ ì»¨íŠ¸ë¡¤ í‘œì‹œ</span>
              </label>
            </div>
          </div>
          
          <div class="bg-card border border-border rounded-lg p-4">
            <h5 class="font-medium text-card-foreground mb-3">ğŸ’¾ ì €ì¥ì†Œ ê´€ë¦¬</h5>
            <div class="flex flex-wrap gap-2 mb-4">
              <button onclick="exportSessions()" class="btn bg-green-500 text-white px-4 py-2 hover:bg-green-600">
                ğŸ“¤ ì„¸ì…˜ ë‚´ë³´ë‚´ê¸°
              </button>
              <button onclick="importSessions()" class="btn bg-blue-500 text-white px-4 py-2 hover:bg-blue-600">
                ğŸ“¥ ì„¸ì…˜ ê°€ì ¸ì˜¤ê¸°
              </button>
            </div>
            <div id="storageInfo" class="text-sm text-muted-foreground">
              ì €ì¥ì†Œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
            </div>
          </div>
          
          <div class="bg-card border border-border rounded-lg p-4">
            <h5 class="font-medium text-card-foreground mb-3">ğŸ”§ ì‹œìŠ¤í…œ ì •ë³´</h5>
            <div id="systemInfo" class="text-sm text-muted-foreground leading-relaxed">
              ì‹œìŠ¤í…œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
        // ì „ì—­ ì˜¤ë¥˜ ì²˜ë¦¬
        window.addEventListener('error', (e) => {
            console.error('ğŸš¨ JavaScript ì˜¤ë¥˜ ë°œìƒ:', e.error);
            console.error('ğŸš¨ ì˜¤ë¥˜ ìœ„ì¹˜:', e.filename, 'line', e.lineno, 'col', e.colno);
        });
        
        window.addEventListener('unhandledrejection', (e) => {
            console.error('ğŸš¨ Promise ì˜¤ë¥˜:', e.reason);
        });
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìƒíƒœ ì—…ë°ì´íŠ¸
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸ¬ ì„¸ì…˜ ë¦¬í”Œë ˆì´ í˜ì´ì§€ ë¡œë“œë¨');
            console.log('ğŸ” í˜ì´ì§€ ë¡œë“œ ì‹œì  - rrweb ìƒíƒœ:', typeof window.rrweb, window.rrweb);
            console.log('ğŸ” í˜ì´ì§€ ë¡œë“œ ì‹œì  - airisTracker ìƒíƒœ:', typeof window.airisTracker, window.airisTracker);
            
            // ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            const testBtn = document.getElementById('testBtn');
            const startBtn = document.getElementById('startBtn');
            const stopBtn = document.getElementById('stopBtn');
            const updateBtn = document.getElementById('updateBtn');
            const randomBtn = document.getElementById('randomBtn');
            const errorBtn = document.getElementById('errorBtn');
            
            console.log('ğŸ” ë²„íŠ¼ ìš”ì†Œë“¤ í™•ì¸:', {
                testBtn: !!testBtn,
                startBtn: !!startBtn,
                stopBtn: !!stopBtn,
                updateBtn: !!updateBtn,
                randomBtn: !!randomBtn,
                errorBtn: !!errorBtn
            });
            
            // í…ŒìŠ¤íŠ¸ ë²„íŠ¼ (ê¸°ë³¸ ë™ì‘ í™•ì¸)
            if (testBtn) {
                testBtn.addEventListener('click', () => {
                    console.log('âœ… í…ŒìŠ¤íŠ¸ ë²„íŠ¼ í´ë¦­ ì„±ê³µ!');
                    alert('ğŸ‰ JavaScript ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤!');
                });
            }
            
            if (startBtn) {
                startBtn.addEventListener('click', () => {
                    console.log('ğŸ” ì‹œì‘ ë²„íŠ¼ í´ë¦­ë¨!');
                    startTracking();
                });
            }
            
            if (stopBtn) {
                stopBtn.addEventListener('click', () => {
                    console.log('ğŸ” ì¤‘ì§€ ë²„íŠ¼ í´ë¦­ë¨!');
                    stopTracking();
                });
            }
            
            if (updateBtn) {
                updateBtn.addEventListener('click', () => {
                    console.log('ğŸ” ì—…ë°ì´íŠ¸ ë²„íŠ¼ í´ë¦­ë¨!');
                    updateStatus();
                });
            }
            
            if (randomBtn) {
                randomBtn.addEventListener('click', () => {
                    console.log('ğŸ” ëœë¤ ë²„íŠ¼ í´ë¦­ë¨!');
                    generateRandomActions();
                });
            }
            
            if (errorBtn) {
                errorBtn.addEventListener('click', () => {
                    console.log('ğŸ” ì˜¤ë¥˜ ë²„íŠ¼ í´ë¦­ë¨!');
                    simulateError();
                });
            }
            
            // ì¶”ì ê¸° ë¡œë”© ëŒ€ê¸°
            setTimeout(() => {
                console.log('ğŸ” 3ì´ˆ í›„ - rrweb ìƒíƒœ:', typeof window.rrweb, window.rrweb);
                console.log('ğŸ” 3ì´ˆ í›„ - airisTracker ìƒíƒœ:', typeof window.airisTracker, window.airisTracker);
                updateStatus();
            }, 3000);
            
            updateStatus();
            
            // ì…ë ¥ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            document.getElementById('nameInput').addEventListener('input', () => {
                console.log('ğŸ“ ì´ë¦„ ì…ë ¥:', document.getElementById('nameInput').value);
            });
            
            document.getElementById('categorySelect').addEventListener('change', () => {
                console.log('ğŸ“‹ ì¹´í…Œê³ ë¦¬ ì„ íƒ:', document.getElementById('categorySelect').value);
            });
            
            document.getElementById('memoTextarea').addEventListener('input', () => {
                console.log('ğŸ“ ë©”ëª¨ ì…ë ¥:', document.getElementById('memoTextarea').value.length, 'ê¸€ì');
            });
        });

        // ì¶”ì  ì‹œì‘
        function startTracking() {
            console.log('ğŸ” startTracking í•¨ìˆ˜ í˜¸ì¶œë¨');
            console.log('ğŸ” window.airisTracker ìƒíƒœ:', window.airisTracker);
            console.log('ğŸ” window.rrweb ìƒíƒœ:', window.rrweb);
            
            if (window.airisTracker) {
                console.log('ğŸ” AIRIS ì¶”ì ê¸° ë°œê²¬, start() ë©”ì„œë“œ í˜¸ì¶œ ì‹œë„');
                const result = window.airisTracker.start();
                console.log('ğŸ” start() ê²°ê³¼:', result);
                
                if (result && result.success) {
                    console.log('âœ… ì¶”ì  ì‹œì‘ë¨');
                    alert('ğŸ¬ ì„¸ì…˜ ê¸°ë¡ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤!\në‹¤ë¥¸ í˜ì´ì§€ë¡œ ì´ë™í•´ë„ ê³„ì† ì¶”ì ë©ë‹ˆë‹¤.');
                } else {
                    console.log('âš ï¸ ì¶”ì  ì‹œì‘ ì‹¤íŒ¨');
                    alert(`âš ï¸ ${result ? result.message : 'ì¶”ì  ì‹œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'}`);
                }
                updateStatus();
            } else {
                console.log('âŒ AIRIS ì¶”ì ê¸°ê°€ ì—†ìŒ');
                console.log('ğŸ” ëª¨ë“  window í”„ë¡œí¼í‹°:', Object.keys(window).filter(key => key.includes('airis') || key.includes('AIRIS')));
                alert('âŒ AIRIS ì¶”ì ê¸°ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
            }
        }

        // ì¶”ì  ì¤‘ì§€
        function stopTracking() {
            if (window.airisTracker) {
                const result = window.airisTracker.stop();
                if (result && result.success) {
                    console.log('â¹ï¸ ì¶”ì  ì¤‘ì§€ë¨');
                    alert(`â¹ï¸ ${result.message}`);
                } else {
                    alert(`âš ï¸ ${result ? result.message : 'ì¶”ì  ì¤‘ì§€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'}`);
                }
                updateStatus();
            }
        }

        // ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateStatus() {
            const statusDiv = document.getElementById('sessionStatus');
            
            if (window.airisTracker) {
                const status = window.airisTracker.getStatus();
                statusDiv.innerHTML = `
                    <strong>ì„¸ì…˜ ID:</strong> ${status.sessionId}<br>
                    <strong>ê¸°ë¡ ìƒíƒœ:</strong> ${status.isRecording ? 'ğŸ”´ ê¸°ë¡ ì¤‘' : 'â¸ï¸ ì¤‘ì§€ë¨'}<br>
                    <strong>ì‹œì‘ ì‹œê°„:</strong> ${status.startTime ? status.startTime.toLocaleString() : 'N/A'}<br>
                    <strong>ì´ë²¤íŠ¸ ìˆ˜:</strong> ${status.eventCount}<br>
                    <strong>ë²„í¼ í¬ê¸°:</strong> ${status.bufferSize}<br>
                    <strong>í˜„ì¬ í˜ì´ì§€:</strong> ì„¸ì…˜ ë¦¬í”Œë ˆì´ ê´€ë¦¬
                `;
            } else {
                statusDiv.innerHTML = 'âŒ AIRIS ì¶”ì ê¸°ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.';
            }
        }

        // ëœë¤ ì•¡ì…˜ ìƒì„±
        function generateRandomActions() {
            const nameInput = document.getElementById('nameInput');
            const categorySelect = document.getElementById('categorySelect');
            const memoTextarea = document.getElementById('memoTextarea');
            
            // ëœë¤ ë°ì´í„° ìƒì„±
            const names = ['ê¹€ì² ìˆ˜', 'ì´ì˜í¬', 'ë°•ë¯¼ìˆ˜', 'ìµœì§€ì˜', 'ì •íƒœë¯¼'];
            const categories = ['home', 'product', 'about'];
            const memos = ['í…ŒìŠ¤íŠ¸ ë©”ëª¨ì…ë‹ˆë‹¤.', 'ì´ê²ƒì€ ìƒ˜í”Œ í…ìŠ¤íŠ¸ì…ë‹ˆë‹¤.', 'ëœë¤ìœ¼ë¡œ ìƒì„±ëœ ë‚´ìš©ì…ë‹ˆë‹¤.'];
            
            nameInput.value = names[Math.floor(Math.random() * names.length)];
            categorySelect.value = categories[Math.floor(Math.random() * categories.length)];
            memoTextarea.value = memos[Math.floor(Math.random() * memos.length)];
            
            // ì´ë²¤íŠ¸ íŠ¸ë¦¬ê±°
            nameInput.dispatchEvent(new Event('input'));
            categorySelect.dispatchEvent(new Event('change'));
            memoTextarea.dispatchEvent(new Event('input'));
            
            console.log('ğŸ² ëœë¤ ì•¡ì…˜ ì‹¤í–‰ë¨');
        }

        // ì˜¤ë¥˜ ì‹œë®¬ë ˆì´ì…˜
        function simulateError() {
            console.error('âš ï¸ ì‹œë®¬ë ˆì´ì…˜ëœ ì˜¤ë¥˜:', new Error('ì„¸ì…˜ ë¦¬í”Œë ˆì´ í˜ì´ì§€ì—ì„œ ë°œìƒí•œ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜'));
            alert('âš ï¸ ì‹œë®¬ë ˆì´ì…˜ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤ (ì½˜ì†” í™•ì¸)');
        }

        // ì„¸ì…˜ ëª©ë¡ ë¡œë“œ
        function loadSessions() {
            if (!window.airisTracker) {
                console.log('âŒ AIRIS ì¶”ì ê¸°ê°€ ì—†ì–´ ì„¸ì…˜ì„ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                return;
            }

            const sessions = window.airisTracker.getSavedSessions();
            const sessionsList = document.getElementById('sessionsList');
            
            if (sessions.length === 0) {
                sessionsList.innerHTML = '<p>ê¸°ë¡ëœ ì„¸ì…˜ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            let html = '';
            sessions.forEach((session, index) => {
                const duration = Math.round(session.duration / 1000);
                html += `
                    <div style="border: 1px solid #ddd; margin: 10px 0; padding: 10px; border-radius: 5px;">
                        <strong>ì„¸ì…˜ ${session.session_id.split('_')[1]}</strong> 
                        (${session.event_count || session.eventsCount || 0}ê°œ ì´ë²¤íŠ¸, ${duration}ì´ˆ)
                        <br>
                        <small>${session.korean_timestamp || new Date(session.start_time).toLocaleString()}</small>
                        <br>
                        <button onclick="playSession('${session.session_id}', ${index})" class="btn" style="margin-top: 5px;">â–¶ï¸ ì¬ìƒ</button>
                        <button onclick="deleteSession('${session.session_id}', ${index})" class="btn btn-danger" style="margin-top: 5px;">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                `;
            });
            
            sessionsList.innerHTML = html;
        }

        // ì„¸ì…˜ ì¬ìƒ
        function playSession(sessionId, index) {
            if (!window.airisTracker) {
                alert('âŒ AIRIS ì¶”ì ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            const sessions = window.airisTracker.getSavedSessions();
            const session = sessions[index];
            
            if (!session || !session.events || session.events.length === 0) {
                alert('âš ï¸ ì„¸ì…˜ ë°ì´í„°ê°€ ì—†ê±°ë‚˜ ì´ë²¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            const playerContainer = document.getElementById('playerContainer');
            playerContainer.innerHTML = '';

            try {
                // rrweb í”Œë ˆì´ì–´ ìƒì„±
                const replayer = new rrwebPlayer({
                    target: playerContainer,
                    props: {
                        events: session.events,
                        width: playerContainer.offsetWidth - 20,
                        height: 380,
                        autoPlay: false,
                        showController: true,
                        speedOption: [1, 2, 4, 8]
                    }
                });
                
                console.log(`âœ… ì„¸ì…˜ ${sessionId} ì¬ìƒ ì‹œì‘ (${session.events.length}ê°œ ì´ë²¤íŠ¸)`);
                alert(`âœ… ì„¸ì…˜ ì¬ìƒì„ ì‹œì‘í•©ë‹ˆë‹¤!\nì´ë²¤íŠ¸: ${session.events.length}ê°œ\nì‹œê°„: ${Math.round(session.duration/1000)}ì´ˆ`);
                
            } catch (error) {
                console.error('âŒ ì¬ìƒ ì˜¤ë¥˜:', error);
                playerContainer.innerHTML = '<p>âŒ ì¬ìƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>';
                alert('âŒ ì¬ìƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ì„¸ì…˜ ì‚­ì œ
        function deleteSession(sessionId, index) {
            if (!confirm(`ì„¸ì…˜ ${sessionId}ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                return;
            }

            try {
                const sessions = window.airisTracker.getSavedSessions();
                const filteredSessions = sessions.filter(s => s.session_id !== sessionId);
                localStorage.setItem('airisRecordedSessions', JSON.stringify(filteredSessions));
                
                console.log(`ğŸ—‘ï¸ ì„¸ì…˜ ${sessionId} ì‚­ì œë¨`);
                loadSessions(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                alert('âœ… ì„¸ì…˜ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                
            } catch (error) {
                console.error('âŒ ì‚­ì œ ì˜¤ë¥˜:', error);
                alert('âŒ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ëª¨ë“  ì„¸ì…˜ ì‚­ì œ
        function clearAllSessions() {
            if (!confirm('ëª¨ë“  ê¸°ë¡ëœ ì„¸ì…˜ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                return;
            }

            try {
                localStorage.removeItem('airisRecordedSessions');
                loadSessions(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                document.getElementById('playerContainer').innerHTML = '<p>ì„¸ì…˜ì„ ì„ íƒí•˜ë©´ ë¦¬í”Œë ˆì´ê°€ ì‹œì‘ë©ë‹ˆë‹¤</p>';
                
                console.log('ğŸ—‘ï¸ ëª¨ë“  ì„¸ì…˜ ì‚­ì œë¨');
                alert('âœ… ëª¨ë“  ì„¸ì…˜ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                
            } catch (error) {
                console.error('âŒ ì „ì²´ ì‚­ì œ ì˜¤ë¥˜:', error);
                alert('âŒ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ì£¼ê¸°ì ìœ¼ë¡œ ìƒíƒœ ì—…ë°ì´íŠ¸
        setInterval(updateStatus, 5000);

        // í–¥ìƒëœ ì„¸ì…˜ í”Œë ˆì´ì–´ ê¸°ëŠ¥ ì¶”ê°€
        let enhancedPlayerInstance = null;
        
        // í–¥ìƒëœ ì„¸ì…˜ ì„ íƒ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateEnhancedStatus(message, type = 'loading') {
            const statusEl = document.getElementById('enhancedStatus');
            if (statusEl) {
                statusEl.textContent = message;
                statusEl.className = `status ${type}`;
                
                // ìŠ¤íƒ€ì¼ ì ìš©
                const styles = {
                    loading: { background: '#fef3c7', color: '#92400e' },
                    ready: { background: '#d1fae5', color: '#065f46' },
                    error: { background: '#fee2e2', color: '#991b1b' },
                    playing: { background: '#dbeafe', color: '#1d4ed8' }
                };
                
                if (styles[type]) {
                    Object.assign(statusEl.style, styles[type]);
                }
            }
        }
        
        // í–¥ìƒëœ ì„¸ì…˜ ë¡œë“œ
        function loadEnhancedSessions() {
            if (!window.airisTracker) {
                updateEnhancedStatus('AIRIS ì¶”ì ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤', 'error');
                return;
            }
            
            const sessions = window.airisTracker.getSavedSessions();
            const sessionSelect = document.getElementById('enhancedSessionSelect');
            
            if (!sessionSelect) return;
            
            sessionSelect.innerHTML = '<option value="">ì„¸ì…˜ì„ ì„ íƒí•˜ì„¸ìš”...</option>';
            
            if (!sessions || sessions.length === 0) {
                updateEnhancedStatus('ì €ì¥ëœ ì„¸ì…˜ì´ ì—†ìŠµë‹ˆë‹¤', 'error');
                return;
            }
            
            sessions.forEach((session, index) => {
                const option = document.createElement('option');
                option.value = index;
                
                const eventCount = session.event_count || session.eventsCount || 0;
                const duration = session.duration ? Math.round(session.duration/1000) : 0;
                const sessionNum = session.session_id ? session.session_id.split('_')[1] : index + 1;
                
                let displayText = `ì„¸ì…˜ ${sessionNum}`;
                if (eventCount) displayText += ` (${eventCount}ê°œ ì´ë²¤íŠ¸)`;
                if (duration) displayText += ` ${duration}ì´ˆ`;
                if (session.korean_timestamp || session.start_time) {
                    const date = session.korean_timestamp || new Date(session.start_time).toLocaleString();
                    displayText += ` - ${date}`;
                }
                
                option.textContent = displayText;
                sessionSelect.appendChild(option);
            });
            
            updateEnhancedStatus(`${sessions.length}ê°œ ì„¸ì…˜ ë¡œë“œ ì™„ë£Œ`, 'ready');
        }
        
        // í–¥ìƒëœ ì„¸ì…˜ í”Œë ˆì´ì–´ë¡œ ì¬ìƒ
        function loadEnhancedSession() {
            const sessionSelect = document.getElementById('enhancedSessionSelect');
            const sessionIndex = sessionSelect.value;
            
            if (!sessionIndex && sessionIndex !== '0') {
                updateEnhancedStatus('ì„¸ì…˜ì„ ì„ íƒí•´ì£¼ì„¸ìš”', 'error');
                return;
            }
            
            if (!window.airisTracker) {
                updateEnhancedStatus('AIRIS ì¶”ì ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤', 'error');
                return;
            }
            
            const sessions = window.airisTracker.getSavedSessions();
            const session = sessions[parseInt(sessionIndex)];
            
            if (!session) {
                updateEnhancedStatus('ì„¸ì…˜ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤', 'error');
                return;
            }
            
            updateEnhancedStatus('ì„¸ì…˜ ë¡œë”© ì¤‘...', 'loading');
            
            // ì„¸ì…˜ ì •ë³´ í‘œì‹œ
            displayEnhancedSessionInfo(session);
            
            // rrweb ì´ë²¤íŠ¸ í™•ì¸
            if (!session.events || session.events.length === 0) {
                updateEnhancedStatus('ì¬ìƒ ê°€ëŠ¥í•œ ì´ë²¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤', 'error');
                showEnhancedPlayerError('ì´ ì„¸ì…˜ì—ëŠ” rrweb ì´ë²¤íŠ¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // í–¥ìƒëœ í”Œë ˆì´ì–´ë¡œ ì¬ìƒ
            playEnhancedSession(session.events, session);
        }
        
        // í–¥ìƒëœ ì„¸ì…˜ ì •ë³´ í‘œì‹œ
        function displayEnhancedSessionInfo(session) {
            const sessionInfo = document.getElementById('enhancedSessionInfo');
            const sessionDetails = document.getElementById('enhancedSessionDetails');
            
            if (!sessionInfo || !sessionDetails) return;
            
            const details = [];
            details.push(`<strong>ì„¸ì…˜ ID:</strong> ${session.session_id || 'N/A'}`);
            details.push(`<strong>ìƒì„± ì‹œê°„:</strong> ${session.korean_timestamp || new Date(session.start_time).toLocaleString()}`);
            if (session.duration) details.push(`<strong>ì§€ì† ì‹œê°„:</strong> ${Math.round(session.duration/1000)}ì´ˆ`);
            if (session.event_count || session.eventsCount) details.push(`<strong>ì´ë²¤íŠ¸ ìˆ˜:</strong> ${session.event_count || session.eventsCount}ê°œ`);
            if (session.events) details.push(`<strong>rrweb ì´ë²¤íŠ¸:</strong> ${session.events.length}ê°œ`);
            
            sessionDetails.innerHTML = details.join('<br>');
            sessionInfo.style.display = 'block';
        }
        
        // í–¥ìƒëœ í”Œë ˆì´ì–´ë¡œ ì¬ìƒ
        function playEnhancedSession(events, session) {
            const playerContainer = document.getElementById('enhancedPlayerContainer');
            if (!playerContainer) return;
            
            try {
                // ê¸°ì¡´ í”Œë ˆì´ì–´ ì •ë¦¬
                if (enhancedPlayerInstance) {
                    enhancedPlayerInstance.destroy?.();
                }
                
                playerContainer.innerHTML = '';
                
                console.log('í–¥ìƒëœ í”Œë ˆì´ì–´ - rrweb ì´ë²¤íŠ¸ ìˆ˜:', events.length);
                
                // rrweb-player ì‚¬ìš© ì‹œë„
                if (typeof rrwebPlayer !== 'undefined') {
                    enhancedPlayerInstance = new rrwebPlayer({
                        target: playerContainer,
                        props: {
                            events: events,
                            width: playerContainer.offsetWidth - 20,
                            height: 480,
                            autoPlay: false,
                            speedOption: [0.5, 1, 2, 4],
                            showController: true,
                            tags: {
                                'session-id': session.session_id
                            }
                        }
                    });
                    
                    updateEnhancedStatus('ì¬ìƒ ì¤€ë¹„ ì™„ë£Œ', 'playing');
                    console.log('í–¥ìƒëœ rrweb í”Œë ˆì´ì–´ ìƒì„± ì™„ë£Œ');
                } else {
                    // ëŒ€ì²´ í”Œë ˆì´ì–´ ì‚¬ìš©
                    playEnhancedSessionWithReplayer(events, playerContainer);
                }
                
            } catch (error) {
                console.error('í–¥ìƒëœ í”Œë ˆì´ì–´ ìƒì„± ì‹¤íŒ¨:', error);
                updateEnhancedStatus('í”Œë ˆì´ì–´ ìƒì„± ì‹¤íŒ¨', 'error');
                showEnhancedPlayerError(`í”Œë ˆì´ì–´ ìƒì„± ì‹¤íŒ¨: ${error.message}`);
            }
        }
        
        // ëŒ€ì²´ í–¥ìƒëœ í”Œë ˆì´ì–´ (rrweb.Replayer)
        function playEnhancedSessionWithReplayer(events, container) {
            try {
                container.innerHTML = '<div id="enhanced-replayer-container" style="width: 100%; height: 480px; border: 1px solid #ddd; background: #f9fafb;"></div>';
                
                const replayer = new rrweb.Replayer(events, {
                    target: document.getElementById('enhanced-replayer-container'),
                    props: {
                        width: container.offsetWidth - 40,
                        height: 440,
                    }
                });
                
                // í–¥ìƒëœ ì¬ìƒ ì»¨íŠ¸ë¡¤ ì¶”ê°€
                const controls = document.createElement('div');
                controls.style.cssText = 'padding: 1rem; background: #f1f5f9; border-top: 1px solid #e2e8f0; text-align: center; display: flex; gap: 1rem; justify-content: center; align-items: center;';
                controls.innerHTML = `
                    <button onclick="window.enhancedReplayer.play()" class="btn" style="background: #10b981; padding: 0.5rem 1rem;">â–¶ï¸ ì¬ìƒ</button>
                    <button onclick="window.enhancedReplayer.pause()" class="btn" style="background: #f59e0b; padding: 0.5rem 1rem;">â¸ï¸ ì¼ì‹œì •ì§€</button>
                    <button onclick="window.enhancedReplayer.goto(0)" class="btn" style="background: #6b7280; padding: 0.5rem 1rem;">âª ì²˜ìŒìœ¼ë¡œ</button>
                    <span style="color: #64748b; font-size: 0.875rem;">í–¥ìƒëœ ì„¸ì…˜ í”Œë ˆì´ì–´</span>
                `;
                
                container.appendChild(controls);
                window.enhancedReplayer = replayer; // ì „ì—­ ì ‘ê·¼ì„ ìœ„í•´
                
                updateEnhancedStatus('ëŒ€ì²´ í”Œë ˆì´ì–´ ì¤€ë¹„ ì™„ë£Œ', 'playing');
                console.log('í–¥ìƒëœ rrweb.Replayer ìƒì„± ì™„ë£Œ');
                
            } catch (error) {
                console.error('ëŒ€ì²´ í–¥ìƒëœ í”Œë ˆì´ì–´ ì‹¤íŒ¨:', error);
                updateEnhancedStatus('í”Œë ˆì´ì–´ ì™„ì „ ì‹¤íŒ¨', 'error');
                showEnhancedPlayerError(`í”Œë ˆì´ì–´ë¥¼ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${error.message}`);
            }
        }
        
        // í–¥ìƒëœ í”Œë ˆì´ì–´ ì˜¤ë¥˜ í‘œì‹œ
        function showEnhancedPlayerError(message) {
            const playerContainer = document.getElementById('enhancedPlayerContainer');
            if (!playerContainer) return;
            
            playerContainer.innerHTML = `
                <div style="text-align: center; padding: 3rem; color: #ef4444; background: #fef2f2; border-radius: 8px; margin: 1rem;">
                    <h3>âŒ í”Œë ˆì´ì–´ ì˜¤ë¥˜</h3>
                    <p style="margin: 1rem 0; color: #374151;">${message}</p>
                    <div style="margin-top: 2rem; padding: 1rem; background: white; border-radius: 8px; text-align: left; color: #6b7280; font-size: 0.875rem;">
                        <h4 style="color: #374151;">í•´ê²° ë°©ë²•:</h4>
                        <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                            <li>ìœ„ì˜ "ê¸°ë¡ì‹œì‘" â†’ "ê¸°ë¡ì¤‘ì§€"ë¡œ ìƒˆ ì„¸ì…˜ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”</li>
                            <li>ë¸Œë¼ìš°ì €ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”</li>
                            <li>ë‹¤ë¥¸ ì„¸ì…˜ì„ ì„ íƒí•´ë³´ì„¸ìš”</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        // íƒ­ ì „í™˜ ê¸°ëŠ¥
        function switchTab(tabName) {
            // ëª¨ë“  íƒ­ ì»¨í…ì¸  ìˆ¨ê¸°ê¸°
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => {
                content.style.display = 'none';
            });
            
            // ëª¨ë“  íƒ­ ë²„íŠ¼ ë¹„í™œì„±í™”
            const buttons = document.querySelectorAll('.tab-btn');
            buttons.forEach(btn => {
                btn.style.color = '#6b7280';
                btn.style.borderBottomColor = 'transparent';
            });
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            const selectedContent = document.getElementById(`tab-${tabName}`);
            const selectedButton = document.querySelector(`[data-tab="${tabName}"]`);
            
            if (selectedContent && selectedButton) {
                selectedContent.style.display = 'block';
                selectedButton.style.color = '#3b82f6';
                selectedButton.style.borderBottomColor = '#3b82f6';
                
                // íƒ­ë³„ ì´ˆê¸°í™”
                if (tabName === 'sessions') {
                    refreshSessionList();
                } else if (tabName === 'player') {
                    loadEnhancedSessions();
                } else if (tabName === 'settings') {
                    loadSettingsInfo();
                }
            }
        }
        
        // ìƒˆë¡œìš´ ì„¸ì…˜ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
        function refreshSessionList() {
            if (!window.airisTracker) {
                document.getElementById('sessionsList').innerHTML = `
                    <div class="text-center py-12 bg-red-50 border border-red-200 rounded-lg">
                        <h4 class="text-red-800 font-medium mb-2">âŒ AIRIS ì¶”ì ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤</h4>
                        <p class="text-red-700 text-sm">í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”.</p>
                    </div>
                `;
                document.getElementById('sessionCount').textContent = 'ì¶”ì ê¸° ì—†ìŒ';
                return;
            }
            
            const sessions = window.airisTracker.getSavedSessions();
            const sessionsList = document.getElementById('sessionsList');
            const sessionCount = document.getElementById('sessionCount');
            
            if (!sessions || sessions.length === 0) {
                sessionsList.innerHTML = `
                    <div class="text-center py-12 bg-gray-50 border border-gray-200 rounded-lg">
                        <h4 class="text-gray-800 font-medium mb-3">ğŸ“‚ ì €ì¥ëœ ì„¸ì…˜ì´ ì—†ìŠµë‹ˆë‹¤</h4>
                        <p class="text-gray-600 text-sm mb-4">ìœ„ì˜ "ğŸ“¹ ì„¸ì…˜ ê¸°ë¡" ì„¹ì…˜ì—ì„œ "ê¸°ë¡ì‹œì‘" ë²„íŠ¼ì„ ëˆŒëŸ¬ ìƒˆë¡œìš´ ì„¸ì…˜ì„ ë…¹í™”í•´ë³´ì„¸ìš”.</p>
                        <div class="max-w-md mx-auto bg-white border border-gray-200 rounded-lg p-4 text-left">
                            <h5 class="text-gray-700 font-medium mb-2">ğŸ’¡ ì„¸ì…˜ ìƒì„± ë°©ë²•:</h5>
                            <ol class="text-gray-600 text-sm space-y-1 list-decimal list-inside">
                                <li>"ê¸°ë¡ì‹œì‘" ë²„íŠ¼ í´ë¦­</li>
                                <li>í˜ì´ì§€ì—ì„œ ì—¬ëŸ¬ ìƒí˜¸ì‘ìš© ìˆ˜í–‰</li>
                                <li>"ê¸°ë¡ì¤‘ì§€" ë²„íŠ¼ í´ë¦­</li>
                                <li>ì„¸ì…˜ ëª©ë¡ì—ì„œ í™•ì¸</li>
                            </ol>
                        </div>
                    </div>
                `;
                sessionCount.textContent = 'ì„¸ì…˜ 0ê°œ';
                return;
            }
            
            let html = '';
            sessions.forEach((session, index) => {
                const duration = session.duration ? Math.round(session.duration/1000) : 0;
                const eventCount = session.event_count || session.eventsCount || 0;
                const createdAt = session.korean_timestamp || new Date(session.start_time).toLocaleString();
                const sessionNum = session.session_id ? session.session_id.split('_')[1] : index + 1;
                
                html += `
                    <div class="session-card bg-card border border-border rounded-lg p-4 mb-3 hover:shadow-lg transition-all duration-200">
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex-1">
                                <h4 class="text-card-foreground font-semibold text-lg mb-2">
                                    ğŸ¬ ì„¸ì…˜ ${sessionNum}
                                </h4>
                                <div class="text-muted-foreground text-sm space-y-1">
                                    <div class="flex flex-wrap gap-4">
                                        <span class="inline-flex items-center">
                                            ğŸ“Š <strong class="ml-1">${eventCount}</strong>ê°œ ì´ë²¤íŠ¸
                                        </span>
                                        <span class="inline-flex items-center">
                                            â±ï¸ <strong class="ml-1">${duration}</strong>ì´ˆ
                                        </span>
                                    </div>
                                    <div class="text-xs">
                                        ğŸ•’ ${createdAt}
                                    </div>
                                </div>
                            </div>
                            <div class="flex gap-2 ml-4">
                                <button onclick="selectSessionForPlayer('${session.session_id}', ${index})" 
                                        class="btn bg-blue-500 text-white px-3 py-1 text-sm hover:bg-blue-600 whitespace-nowrap">
                                    ğŸ¥ í”Œë ˆì´ì–´ë¡œ ë³´ë‚´ê¸°
                                </button>
                                <button onclick="deleteSessionFromList('${session.session_id}', ${index})" 
                                        class="btn bg-red-500 text-white px-3 py-1 text-sm hover:bg-red-600">
                                    ğŸ—‘ï¸ ì‚­ì œ
                                </button>
                            </div>
                        </div>
                        
                        <!-- ì„¸ì…˜ ìƒì„¸ ì •ë³´ (ì ‘ì„ ìˆ˜ ìˆìŒ) -->
                        <div class="border-t border-border pt-3 mt-3">
                            <details class="cursor-pointer">
                                <summary class="font-medium text-card-foreground text-sm hover:text-primary transition-colors">
                                    ğŸ“‹ ìƒì„¸ ì •ë³´ ë³´ê¸°
                                </summary>
                                <div class="mt-2 p-3 bg-muted/50 rounded-md text-xs text-muted-foreground space-y-1">
                                    <div><strong>ì„¸ì…˜ ID:</strong> ${session.session_id}</div>
                                    <div><strong>ì‹œì‘ ì‹œê°„:</strong> ${new Date(session.start_time).toLocaleString()}</div>
                                    <div><strong>í˜ì´ì§€ ìˆ˜:</strong> ${session.page_count || 1}</div>
                                    <div><strong>ë²„í¼ í¬ê¸°:</strong> ${session.buffer_size || 'N/A'}</div>
                                    <div><strong>rrweb ì´ë²¤íŠ¸:</strong> ${session.events ? session.events.length : 0}ê°œ</div>
                                    <div><strong>ì¬ìƒ ê°€ëŠ¥:</strong> ${session.events && session.events.length > 0 ? 'âœ… ì˜ˆ' : 'âŒ ì•„ë‹ˆì˜¤'}</div>
                                </div>
                            </details>
                        </div>
                    </div>
                `;
            });
            
            sessionsList.innerHTML = html;
            sessionCount.textContent = `ì„¸ì…˜ ${sessions.length}ê°œ`;
        }
        
        // ì„¸ì…˜ì„ í”Œë ˆì´ì–´ íƒ­ìœ¼ë¡œ ë³´ë‚´ê¸°
        function selectSessionForPlayer(sessionId, index) {
            // í”Œë ˆì´ì–´ íƒ­ìœ¼ë¡œ ì „í™˜
            switchTab('player');
            
            // ë“œë¡­ë‹¤ìš´ì—ì„œ í•´ë‹¹ ì„¸ì…˜ ì„ íƒ
            const sessionSelect = document.getElementById('enhancedSessionSelect');
            if (sessionSelect) {
                sessionSelect.value = index;
                // ìë™ìœ¼ë¡œ ë¡œë“œ
                setTimeout(() => {
                    loadEnhancedSession();
                    alert(`âœ… ì„¸ì…˜ì´ í”Œë ˆì´ì–´ íƒ­ìœ¼ë¡œ ì´ë™ë˜ì—ˆìŠµë‹ˆë‹¤!\nì„¸ì…˜ì„ ë¡œë“œí•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤...`);
                }, 500);
            }
        }
        
        // ì„¸ì…˜ ëª©ë¡ì—ì„œ ì‚­ì œ
        function deleteSessionFromList(sessionId, index) {
            if (!confirm(`ì„¸ì…˜ "${sessionId}"ì„(ë¥¼) ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)) {
                return;
            }
            
            try {
                const sessions = window.airisTracker.getSavedSessions();
                const filteredSessions = sessions.filter((_, i) => i !== index);
                localStorage.setItem('airisRecordedSessions', JSON.stringify(filteredSessions));
                refreshSessionList(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                loadEnhancedSessions(); // í”Œë ˆì´ì–´ ë“œë¡­ë‹¤ìš´ë„ ìƒˆë¡œê³ ì¹¨
                
                console.log(`ğŸ—‘ï¸ ì„¸ì…˜ ${sessionId} ì‚­ì œë¨`);
                alert('âœ… ì„¸ì…˜ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (error) {
                console.error('ì„¸ì…˜ ì‚­ì œ ì‹¤íŒ¨:', error);
                alert('âŒ ì„¸ì…˜ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // ì„¤ì • ì •ë³´ ë¡œë“œ
        function loadSettingsInfo() {
            // ì €ì¥ì†Œ ì •ë³´
            const storageInfo = document.getElementById('storageInfo');
            if (storageInfo && window.airisTracker) {
                const sessions = window.airisTracker.getSavedSessions();
                const totalSessions = sessions.length;
                const totalEvents = sessions.reduce((sum, s) => sum + (s.event_count || s.eventsCount || 0), 0);
                const storageSize = JSON.stringify(sessions).length;
                
                storageInfo.innerHTML = `
                    ğŸ“Š <strong>ì´ ì„¸ì…˜:</strong> ${totalSessions}ê°œ<br>
                    ğŸ“ˆ <strong>ì´ ì´ë²¤íŠ¸:</strong> ${totalEvents.toLocaleString()}ê°œ<br>
                    ğŸ’¾ <strong>ì €ì¥ í¬ê¸°:</strong> ${(storageSize / 1024).toFixed(1)} KB<br>
                    ğŸ—‚ï¸ <strong>ì €ì¥ ìœ„ì¹˜:</strong> localStorage (airisRecordedSessions)
                `;
            }
            
            // ì‹œìŠ¤í…œ ì •ë³´
            const systemInfo = document.getElementById('systemInfo');
            if (systemInfo) {
                systemInfo.innerHTML = `
                    ğŸŒ <strong>ë¸Œë¼ìš°ì €:</strong> ${navigator.userAgent.split(' ')[0]}<br>
                    ğŸ“± <strong>í”Œë«í¼:</strong> ${navigator.platform}<br>
                    ğŸ¬ <strong>rrweb ë²„ì „:</strong> ${typeof rrweb !== 'undefined' ? 'Available' : 'Not loaded'}<br>
                    ğŸ® <strong>rrweb-player:</strong> ${typeof rrwebPlayer !== 'undefined' ? 'Available' : 'Not loaded'}<br>
                    ğŸ”§ <strong>AIRIS ì¶”ì ê¸°:</strong> ${window.airisTracker ? 'Loaded' : 'Not loaded'}<br>
                    â° <strong>ë¡œë“œ ì‹œê°„:</strong> ${new Date().toLocaleString()}
                `;
            }
        }
        
        // ì„¸ì…˜ ë‚´ë³´ë‚´ê¸°
        function exportSessions() {
            if (!window.airisTracker) {
                alert('âŒ AIRIS ì¶”ì ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const sessions = window.airisTracker.getSavedSessions();
            if (sessions.length === 0) {
                alert('ğŸ“‚ ë‚´ë³´ë‚¼ ì„¸ì…˜ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const exportData = {
                exportDate: new Date().toISOString(),
                version: '1.0',
                totalSessions: sessions.length,
                sessions: sessions
            };
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `airis-sessions-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert(`âœ… ${sessions.length}ê°œ ì„¸ì…˜ì´ ë‚´ë³´ë‚´ê¸°ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }
        
        // ì„¸ì…˜ ê°€ì ¸ì˜¤ê¸°
        function importSessions() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const importData = JSON.parse(e.target.result);
                        if (!importData.sessions || !Array.isArray(importData.sessions)) {
                            throw new Error('ì˜¬ë°”ë¥´ì§€ ì•Šì€ íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤.');
                        }
                        
                        // ê¸°ì¡´ ì„¸ì…˜ê³¼ ë³‘í•©
                        const existingSessions = window.airisTracker ? window.airisTracker.getSavedSessions() : [];
                        const mergedSessions = [...existingSessions, ...importData.sessions];
                        
                        localStorage.setItem('airisRecordedSessions', JSON.stringify(mergedSessions));
                        refreshSessionList();
                        loadEnhancedSessions();
                        loadSettingsInfo();
                        
                        alert(`âœ… ${importData.sessions.length}ê°œ ì„¸ì…˜ì´ ê°€ì ¸ì˜¤ê¸°ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                    } catch (error) {
                        console.error('ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);
                        alert(`âŒ ì„¸ì…˜ ê°€ì ¸ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${error.message}`);
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        // í˜ì´ì§€ ë¡œë“œì‹œ ì´ˆê¸°í™”
        setTimeout(() => {
            // ê¸°ë³¸ ì„¸ì…˜ ëª©ë¡ íƒ­ í™œì„±í™”
            switchTab('sessions');
            
            // í–¥ìƒëœ í”Œë ˆì´ì–´ìš© ì„¸ì…˜ ëª©ë¡ë„ ë¡œë“œ
            loadEnhancedSessions();
        }, 2000);
    </script>
  </main>

  <!-- Theme toggle functionality -->
  <script>
    // Theme toggle functionality
    const themeToggle = document.getElementById('themeToggle');
    let isDark = false;

    themeToggle.addEventListener('click', () => {
      isDark = !isDark;
      document.documentElement.classList.toggle('dark');
      themeToggle.textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
      localStorage.setItem('darkMode', isDark);
    });

    // Load saved theme
    const savedTheme = localStorage.getItem('darkMode');
    if (savedTheme === 'true') {
      isDark = true;
      document.documentElement.classList.add('dark');
      themeToggle.textContent = 'â˜€ï¸';
    }
  </script>
</body>
</html>