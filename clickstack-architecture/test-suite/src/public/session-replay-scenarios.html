<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¬ AIRIS-MON ì„¸ì…˜ ë¦¬í”Œë ˆì´ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸</title>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 1.1rem;
        }
        
        .scenarios-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .scenario-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .scenario-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        
        .scenario-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .scenario-icon {
            font-size: 2.5rem;
            margin-right: 15px;
        }
        
        .scenario-title {
            font-size: 1.4rem;
            color: #2c3e50;
            font-weight: bold;
        }
        
        .scenario-description {
            color: #7f8c8d;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .test-interface {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px dashed #e9ecef;
            min-height: 200px;
            position: relative;
        }
        
        .interface-label {
            position: absolute;
            top: -10px;
            left: 15px;
            background: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.9rem;
            color: #6c757d;
            font-weight: bold;
        }
        
        .bug-interface {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .payment-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            margin-bottom: 5px;
            font-weight: bold;
            color: #495057;
        }
        
        .form-group input, .form-group select {
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .payment-button {
            grid-column: 1 / -1;
            background: #28a745;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .payment-button:hover {
            background: #218838;
            transform: translateY(-2px);
        }
        
        .payment-button.broken {
            background: #dc3545;
            cursor: not-allowed;
        }
        
        .ux-interface {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .navigation-menu {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .nav-item {
            padding: 10px 15px;
            background: #6f42c1;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .nav-item:hover {
            background: #5a32a3;
            transform: scale(1.05);
        }
        
        .content-area {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
        }
        
        .security-interface {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .login-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .login-input {
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .login-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .login-button:hover {
            background: #0056b3;
        }
        
        .attack-simulator {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .attack-button {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
        }
        
        .performance-interface {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }
        
        .dashboard-item {
            background: #17a2b8;
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .dashboard-item:hover {
            background: #138496;
            transform: scale(1.05);
        }
        
        .load-simulator {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .load-button {
            background: #ffc107;
            color: #212529;
            border: none;
            padding: 10px 15px;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .control-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: #007bff;
            color: white;
        }
        
        .btn-primary:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
        }
        
        .btn-warning {
            background: #ffc107;
            color: #212529;
        }
        
        .btn-warning:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }
        
        .btn-info {
            background: #17a2b8;
            color: white;
        }
        
        .btn-info:hover {
            background: #138496;
            transform: translateY(-2px);
        }
        
        .status-display {
            background: #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 3px 0;
        }
        
        .log-success { color: #28a745; }
        .log-error { color: #dc3545; }
        .log-warning { color: #ffc107; }
        .log-info { color: #17a2b8; }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .metric-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .metric-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .scenarios-grid {
                grid-template-columns: 1fr;
            }
            
            .payment-form {
                grid-template-columns: 1fr;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¬ ì„¸ì…˜ ë¦¬í”Œë ˆì´ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸</h1>
            <p>ì‹¤ì œ ì‚¬ìš©ì ìƒí™©ì„ ì‹œë®¬ë ˆì´ì…˜í•˜ì—¬ ì„¸ì…˜ ë¦¬í”Œë ˆì´ ê¸°ëŠ¥ì„ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤</p>
        </div>

        <div class="scenarios-grid">
            <!-- 1. ë²„ê·¸ ì¬í˜„ ë° ë””ë²„ê¹… ì‹œë‚˜ë¦¬ì˜¤ -->
            <div class="scenario-card">
                <div class="scenario-header">
                    <span class="scenario-icon">ğŸ›</span>
                    <div>
                        <div class="scenario-title">ë²„ê·¸ ì¬í˜„ ë° ë””ë²„ê¹…</div>
                    </div>
                </div>
                <div class="scenario-description">
                    "ê²°ì œ ë²„íŠ¼ì„ ëˆŒë €ëŠ”ë° ì•„ë¬´ ë°˜ì‘ì´ ì—†ì–´ìš”" - ì´ëŸ° ì‚¬ìš©ì ì‹ ê³  ìƒí™©ì„ ì¬í˜„í•˜ê³  ì„¸ì…˜ ë¦¬í”Œë ˆì´ë¡œ ì›ì¸ì„ ë¶„ì„í•©ë‹ˆë‹¤.
                </div>
                
                <div class="test-interface">
                    <div class="interface-label">ğŸ›’ ê²°ì œ í˜ì´ì§€ ì‹œë®¬ë ˆì´ì…˜</div>
                    <div class="bug-interface">
                        <div class="payment-form">
                            <div class="form-group">
                                <label>ì¹´ë“œ ë²ˆí˜¸</label>
                                <input type="text" id="cardNumber" placeholder="1234-5678-9012-3456" maxlength="19">
                            </div>
                            <div class="form-group">
                                <label>ë§Œë£Œì¼</label>
                                <input type="text" id="expiry" placeholder="MM/YY" maxlength="5">
                            </div>
                            <div class="form-group">
                                <label>CVV</label>
                                <input type="text" id="cvv" placeholder="123" maxlength="3">
                            </div>
                            <div class="form-group">
                                <label>ì¹´ë“œ íƒ€ì…</label>
                                <select id="cardType">
                                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                    <option value="visa">Visa</option>
                                    <option value="master">MasterCard</option>
                                    <option value="amex">American Express</option>
                                </select>
                            </div>
                            <button class="payment-button" id="paymentButton">ğŸ’³ ê²°ì œí•˜ê¸° (â‚©50,000)</button>
                        </div>
                    </div>
                </div>
                
                <div class="control-buttons">
                    <button class="btn btn-primary" onclick="startBugScenario()">ğŸ¬ ë²„ê·¸ ì‹œë‚˜ë¦¬ì˜¤ ì‹œì‘</button>
                    <button class="btn btn-success" onclick="fixBugScenario()">ğŸ”§ ë²„ê·¸ ìˆ˜ì • ì ìš©</button>
                    <button class="btn btn-warning" onclick="viewBugReplay()">ğŸ“º ì„¸ì…˜ ë¦¬í”Œë ˆì´ ë³´ê¸°</button>
                </div>
                
                <div class="status-display" id="bugStatus"></div>
            </div>

            <!-- 2. UX/UI ê°œì„  ì‹œë‚˜ë¦¬ì˜¤ -->
            <div class="scenario-card">
                <div class="scenario-header">
                    <span class="scenario-icon">ğŸ“Š</span>
                    <div>
                        <div class="scenario-title">UX/UI ê°œì„  ë¶„ì„</div>
                    </div>
                </div>
                <div class="scenario-description">
                    ì‚¬ìš©ìê°€ íŠ¹ì • í˜ì´ì§€ì—ì„œ í—¤ë§¤ëŠ” íŒ¨í„´ì„ ë°œê²¬í•˜ê³ , ë„¤ë¹„ê²Œì´ì…˜ ê°œì„  ë°©í–¥ì„ ê²°ì •í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ì…ë‹ˆë‹¤.
                </div>
                
                <div class="test-interface">
                    <div class="interface-label">ğŸ§­ ë³µì¡í•œ ë„¤ë¹„ê²Œì´ì…˜ í˜ì´ì§€</div>
                    <div class="ux-interface">
                        <div class="navigation-menu">
                            <button class="nav-item" onclick="navigateTo('home')">í™ˆ</button>
                            <button class="nav-item" onclick="navigateTo('products')">ìƒí’ˆ</button>
                            <button class="nav-item" onclick="navigateTo('categories')">ì¹´í…Œê³ ë¦¬</button>
                            <button class="nav-item" onclick="navigateTo('brands')">ë¸Œëœë“œ</button>
                            <button class="nav-item" onclick="navigateTo('deals')">íŠ¹ê°€</button>
                            <button class="nav-item" onclick="navigateTo('support')">ê³ ê°ì§€ì›</button>
                            <button class="nav-item" onclick="navigateTo('account')">ë‚´ ê³„ì •</button>
                            <button class="nav-item" onclick="navigateTo('cart')">ì¥ë°”êµ¬ë‹ˆ</button>
                            <button class="nav-item" onclick="navigateTo('wishlist')">ì°œëª©ë¡</button>
                            <button class="nav-item" onclick="navigateTo('orders')">ì£¼ë¬¸ë‚´ì—­</button>
                        </div>
                        <div class="content-area" id="uxContent">
                            ì—¬ê¸°ì—ì„œ ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ë©”ë‰´ë¥¼ ì°¾ì•„ë³´ì„¸ìš”...
                        </div>
                    </div>
                </div>
                
                <div class="control-buttons">
                    <button class="btn btn-primary" onclick="startUXScenario()">ğŸ¬ UX ë¶„ì„ ì‹œì‘</button>
                    <button class="btn btn-success" onclick="improveNavigation()">âœ¨ ë„¤ë¹„ê²Œì´ì…˜ ê°œì„ </button>
                    <button class="btn btn-warning" onclick="viewUXReplay()">ğŸ“º ì„¸ì…˜ ë¦¬í”Œë ˆì´ ë³´ê¸°</button>
                    <button class="btn btn-info" onclick="viewUXAnalytics()">ğŸ“ˆ ì‚¬ìš©ì ë¶„ì„ ë³´ê¸°</button>
                </div>
                
                <div class="status-display" id="uxStatus"></div>
            </div>

            <!-- 3. ë³´ì•ˆ ì‚¬ê³  ë¶„ì„ ì‹œë‚˜ë¦¬ì˜¤ -->
            <div class="scenario-card">
                <div class="scenario-header">
                    <span class="scenario-icon">ğŸš¨</span>
                    <div>
                        <div class="scenario-title">ë³´ì•ˆ ì‚¬ê³  ë¶„ì„</div>
                    </div>
                </div>
                <div class="scenario-description">
                    ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ë¡œê·¸ì¸ ì‹œë„ë¥¼ ê°ì§€í•˜ê³ , ì„¸ì…˜ ë¦¬í”Œë ˆì´ë¡œ ì‹¤ì œ ê³µê²© íŒ¨í„´ì„ ë¶„ì„í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ì…ë‹ˆë‹¤.
                </div>
                
                <div class="test-interface">
                    <div class="interface-label">ğŸ” ë¡œê·¸ì¸ í˜ì´ì§€</div>
                    <div class="security-interface">
                        <div class="login-form">
                            <input type="text" class="login-input" id="username" placeholder="ì‚¬ìš©ìëª…">
                            <input type="password" class="login-input" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
                            <button class="login-button" onclick="attemptLogin()">ğŸ”“ ë¡œê·¸ì¸</button>
                        </div>
                        <div class="attack-simulator">
                            <span>ê³µê²© ì‹œë®¬ë ˆì´ì…˜:</span>
                            <button class="attack-button" onclick="simulateBruteForce()">ë¬´ì°¨ë³„ ëŒ€ì…</button>
                            <button class="attack-button" onclick="simulateCredentialStuffing()">í¬ë¦¬ë´ì…œ ìŠ¤í„°í•‘</button>
                            <button class="attack-button" onclick="simulateBot()">ë´‡ ê³µê²©</button>
                        </div>
                    </div>
                </div>
                
                <div class="control-buttons">
                    <button class="btn btn-primary" onclick="startSecurityScenario()">ğŸ¬ ë³´ì•ˆ ë¶„ì„ ì‹œì‘</button>
                    <button class="btn btn-success" onclick="applySecurity()">ğŸ›¡ï¸ ë³´ì•ˆ ê°•í™” ì ìš©</button>
                    <button class="btn btn-warning" onclick="viewSecurityReplay()">ğŸ“º ì„¸ì…˜ ë¦¬í”Œë ˆì´ ë³´ê¸°</button>
                    <button class="btn btn-info" onclick="viewSecurityReport()">ğŸ“‹ ë³´ì•ˆ ë¦¬í¬íŠ¸ ë³´ê¸°</button>
                </div>
                
                <div class="status-display" id="securityStatus"></div>
            </div>

            <!-- 4. ì„±ëŠ¥ ë¬¸ì œ ì§„ë‹¨ ì‹œë‚˜ë¦¬ì˜¤ -->
            <div class="scenario-card">
                <div class="scenario-header">
                    <span class="scenario-icon">âš¡</span>
                    <div>
                        <div class="scenario-title">ì„±ëŠ¥ ë¬¸ì œ ì§„ë‹¨</div>
                    </div>
                </div>
                <div class="scenario-description">
                    "ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ê°€ ë„ˆë¬´ ëŠë ¤ìš”" - ì„±ëŠ¥ ë¬¸ì œë¥¼ ì¬í˜„í•˜ê³  ì„¸ì…˜ ë¦¬í”Œë ˆì´ë¡œ ë³‘ëª© ì§€ì ì„ ì°¾ëŠ” ì‹œë‚˜ë¦¬ì˜¤ì…ë‹ˆë‹¤.
                </div>
                
                <div class="test-interface">
                    <div class="interface-label">ğŸ“Š ëŠë¦° ëŒ€ì‹œë³´ë“œ í˜ì´ì§€</div>
                    <div class="performance-interface">
                        <div class="dashboard-grid">
                            <div class="dashboard-item" onclick="loadChart('sales')">ğŸ’° ë§¤ì¶œ ì°¨íŠ¸</div>
                            <div class="dashboard-item" onclick="loadChart('users')">ğŸ‘¥ ì‚¬ìš©ì í†µê³„</div>
                            <div class="dashboard-item" onclick="loadChart('performance')">âš¡ ì„±ëŠ¥ ì§€í‘œ</div>
                            <div class="dashboard-item" onclick="loadChart('traffic')">ğŸŒ íŠ¸ë˜í”½ ë¶„ì„</div>
                            <div class="dashboard-item" onclick="loadChart('errors')">ğŸš¨ ì˜¤ë¥˜ í˜„í™©</div>
                            <div class="dashboard-item" onclick="loadChart('system')">ğŸ–¥ï¸ ì‹œìŠ¤í…œ ìƒíƒœ</div>
                        </div>
                        <div class="load-simulator">
                            <span>ë¶€í•˜ ì‹œë®¬ë ˆì´ì…˜:</span>
                            <button class="load-button" onclick="simulateHighLoad()">ë†’ì€ ë¶€í•˜</button>
                            <button class="load-button" onclick="simulateSlowQuery()">ëŠë¦° ì¿¼ë¦¬</button>
                            <button class="load-button" onclick="simulateMemoryLeak()">ë©”ëª¨ë¦¬ ëˆ„ìˆ˜</button>
                        </div>
                    </div>
                </div>
                
                <div class="control-buttons">
                    <button class="btn btn-primary" onclick="startPerformanceScenario()">ğŸ¬ ì„±ëŠ¥ ë¶„ì„ ì‹œì‘</button>
                    <button class="btn btn-success" onclick="optimizePerformance()">ğŸš€ ì„±ëŠ¥ ìµœì í™”</button>
                    <button class="btn btn-warning" onclick="viewPerformanceReplay()">ğŸ“º ì„¸ì…˜ ë¦¬í”Œë ˆì´ ë³´ê¸°</button>
                    <button class="btn btn-info" onclick="viewPerformanceReport()">ğŸ“Š ì„±ëŠ¥ ë¦¬í¬íŠ¸ ë³´ê¸°</button>
                </div>
                
                <div class="status-display" id="performanceStatus"></div>
            </div>
        </div>

        <!-- ì„¸ì…˜ ìƒíƒœ í‘œì‹œ -->
        <div class="session-status-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
            <div class="session-status-card" style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                <h3 style="color: #2c3e50; margin-bottom: 15px;">ğŸ¬ í™œì„± ì„¸ì…˜ ìƒíƒœ</h3>
                <div id="sessionStatusList" style="font-family: 'Courier New', monospace; font-size: 0.9rem;">
                    <div style="color: #666;">ì„¸ì…˜ì´ ì‹œì‘ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤</div>
                </div>
            </div>
        </div>

        <!-- ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ í‘œì‹œ -->
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-value" id="sessionCount">0</div>
                <div class="metric-label">ìƒì„±ëœ ì„¸ì…˜ ìˆ˜</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="eventCount">0</div>
                <div class="metric-label">ê¸°ë¡ëœ ì´ë²¤íŠ¸ ìˆ˜</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="errorCount">0</div>
                <div class="metric-label">ë°œê²¬ëœ ì´ìŠˆ ìˆ˜</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="insightCount">0</div>
                <div class="metric-label">ë„ì¶œëœ ì¸ì‚¬ì´íŠ¸</div>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentScenario = null;
        let sessionData = {
            sessions: 0,
            events: 0,
            errors: 0,
            insights: 0
        };
        
        // ì„¸ì…˜ ë…¹í™” ì „ì—­ ë³€ìˆ˜ - ì‹œë‚˜ë¦¬ì˜¤ë³„ í†µí•© ê´€ë¦¬
        let scenarioSessions = {
            bug_payment: null,
            ux_navigation: null,
            security_attack: null,
            performance_slow: null
        };
        let activeScenario = null;

        // ì„¸ì…˜ ë…¹í™” ê´€ë ¨ í•¨ìˆ˜ë“¤ - í†µí•© ê´€ë¦¬ ë²„ì „
        async function startSessionRecording(scenario) {
            try {
                // ê¸°ì¡´ ì„¸ì…˜ì´ ìˆìœ¼ë©´ ì¢…ë£Œ
                if (scenarioSessions[scenario]) {
                    await endSessionRecording(scenarioSessions[scenario], 'scenario_restart');
                }
                
                const response = await fetch('/api/session-replay/start-session', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        scenario: scenario,
                        userAgent: navigator.userAgent,
                        ipAddress: 'unified_test_session'
                    })
                });
                
                const data = await response.json();
                if (data.success) {
                    scenarioSessions[scenario] = data.sessionId;
                    activeScenario = scenario;
                    updateSessionStatus(); // ì„¸ì…˜ ìƒíƒœ UI ì—…ë°ì´íŠ¸
                    console.log(`ğŸ¬ í†µí•© ì„¸ì…˜ ì‹œì‘ [${scenario}]:`, data.sessionId);
                    return data.sessionId;
                }
                throw new Error(data.error || 'ì„¸ì…˜ ì‹œì‘ ì‹¤íŒ¨');
            } catch (error) {
                console.error('ì„¸ì…˜ ë…¹í™” ì‹œì‘ ì‹¤íŒ¨:', error);
                return null;
            }
        }

        async function recordEvent(sessionId, eventData) {
            if (!sessionId) return false;
            
            try {
                const response = await fetch('/api/session-replay/add-event', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        sessionId: sessionId,
                        eventData: eventData
                    })
                });
                
                const data = await response.json();
                return data.success;
            } catch (error) {
                console.error('ì´ë²¤íŠ¸ ê¸°ë¡ ì‹¤íŒ¨:', error);
                return false;
            }
        }

        async function endSessionRecording(sessionId, reason = 'test_completed') {
            if (!sessionId) return false;
            
            try {
                const response = await fetch('/api/session-replay/end-session', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        sessionId: sessionId,
                        reason: reason
                    })
                });
                
                const data = await response.json();
                if (data.success) {
                    // ì¢…ë£Œëœ ì„¸ì…˜ì„ ì‹œë‚˜ë¦¬ì˜¤ ëª©ë¡ì—ì„œ ì œê±°
                    for (let scenario in scenarioSessions) {
                        if (scenarioSessions[scenario] === sessionId) {
                            scenarioSessions[scenario] = null;
                            break;
                        }
                    }
                    updateSessionStatus(); // ì„¸ì…˜ ìƒíƒœ UI ì—…ë°ì´íŠ¸
                    console.log(`â¹ï¸ í†µí•© ì„¸ì…˜ ì¢…ë£Œ: ${sessionId} (${reason})`);
                    return data.session;
                }
                return false;
            } catch (error) {
                console.error('ì„¸ì…˜ ì¢…ë£Œ ì‹¤íŒ¨:', error);
                return false;
            }
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // ì„¸ì…˜ ìƒíƒœ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateSessionStatus() {
            const statusList = document.getElementById('sessionStatusList');
            statusList.innerHTML = '';
            
            let hasActiveSessions = false;
            
            for (let [scenario, sessionId] of Object.entries(scenarioSessions)) {
                if (sessionId) {
                    hasActiveSessions = true;
                    const statusItem = document.createElement('div');
                    statusItem.style.cssText = 'margin-bottom: 8px; padding: 8px; background: #e3f2fd; border-radius: 4px; border-left: 4px solid #2196f3;';
                    
                    const scenarioNames = {
                        bug_payment: 'ğŸ› ë²„ê·¸ ì¬í˜„',
                        ux_navigation: 'ğŸ“Š UX ë¶„ì„',
                        security_attack: 'ğŸš¨ ë³´ì•ˆ ë¶„ì„',
                        performance_slow: 'âš¡ ì„±ëŠ¥ ì§„ë‹¨'
                    };
                    
                    statusItem.innerHTML = `
                        <div style="font-weight: bold; color: #1976d2;">${scenarioNames[scenario] || scenario}</div>
                        <div style="font-size: 0.8em; color: #666;">ì„¸ì…˜ ID: ${sessionId.substring(0, 8)}...</div>
                        <div style="font-size: 0.8em; color: #4caf50;">â— í™œì„± ìƒíƒœ</div>
                    `;
                    
                    statusList.appendChild(statusItem);
                }
            }
            
            if (!hasActiveSessions) {
                const noSessionDiv = document.createElement('div');
                noSessionDiv.style.color = '#666';
                noSessionDiv.textContent = 'í™œì„± ì„¸ì…˜ì´ ì—†ìŠµë‹ˆë‹¤';
                statusList.appendChild(noSessionDiv);
            }
        }
        
        // ì›¹ì†Œì¼“ ì—°ê²°
        const ws = new WebSocket(`ws://${window.location.host}`);
        
        ws.onmessage = function(event) {
            const data = JSON.parse(event.data);
            updateMetrics(data);
        };

        // ë©”íŠ¸ë¦­ ì—…ë°ì´íŠ¸
        function updateMetrics(data) {
            if (data.sessionCount !== undefined) {
                document.getElementById('sessionCount').textContent = data.sessionCount;
            }
            if (data.eventCount !== undefined) {
                document.getElementById('eventCount').textContent = data.eventCount;
            }
            if (data.errorCount !== undefined) {
                document.getElementById('errorCount').textContent = data.errorCount;
            }
            if (data.insightCount !== undefined) {
                document.getElementById('insightCount').textContent = data.insightCount;
            }
        }

        // ë¡œê·¸ ì¶”ê°€ í•¨ìˆ˜
        function addLog(containerId, message, type = 'info') {
            const container = document.getElementById(containerId);
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            logEntry.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            container.appendChild(logEntry);
            container.scrollTop = container.scrollHeight;
        }

        // 1. ë²„ê·¸ ì¬í˜„ ì‹œë‚˜ë¦¬ì˜¤ - í†µí•© ì„¸ì…˜ ë²„ì „
        async function startBugScenario() {
            currentScenario = 'bug';
            const sessionId = await startSessionRecording('bug_payment');
            
            addLog('bugStatus', 'ğŸ¬ í†µí•© ë²„ê·¸ ì‹œë‚˜ë¦¬ì˜¤ ì‹œì‘ (ë‹¨ì¼ ì„¸ì…˜ìœ¼ë¡œ ê´€ë¦¬)', 'info');
            addLog('bugStatus', 'ğŸ’³ ê²°ì œ í˜ì´ì§€ ë¡œë”©...', 'info');
            
            if (!sessionId) {
                addLog('bugStatus', 'âŒ ì„¸ì…˜ ë…¹í™” ì‹œì‘ ì‹¤íŒ¨', 'error');
                return;
            }
            
            addLog('bugStatus', `ğŸ“‹ ì„¸ì…˜ ID: ${sessionId.substring(0, 8)}...`, 'info');

            // ì‹¤ì œ ì‚¬ìš©ì ì´ë²¤íŠ¸ë“¤ì„ ìˆœì°¨ì ìœ¼ë¡œ ê¸°ë¡
            await recordEvent(sessionId, {
                type: 'page_load',
                page_url: '/checkout',
                page_title: 'ê²°ì œ í˜ì´ì§€',
                load_time: 2300
            });
            
            await sleep(1500);
            await recordEvent(sessionId, {
                type: 'form_input',
                element_id: 'cardNumber',
                element_type: 'input',
                value_masked: '****-****-****-1234',
                x: 450, y: 320
            });
            addLog('bugStatus', 'ğŸ“ ì‹ ìš©ì¹´ë“œ ë²ˆí˜¸ ì…ë ¥ ì™„ë£Œ', 'info');

            await sleep(800);
            await recordEvent(sessionId, {
                type: 'form_input',
                element_id: 'expiry',
                element_type: 'input',
                value_masked: '12/25',
                x: 600, y: 320
            });
            addLog('bugStatus', 'ğŸ“… ìœ íš¨ê¸°ê°„ ì…ë ¥ ì™„ë£Œ', 'info');

            await sleep(800);
            await recordEvent(sessionId, {
                type: 'form_input',
                element_id: 'cvv',
                element_type: 'input',
                value_masked: '***',
                x: 750, y: 320
            });
            addLog('bugStatus', 'ğŸ” CVV ì…ë ¥ ì™„ë£Œ', 'info');

            await sleep(1000);
            await recordEvent(sessionId, {
                type: 'click',
                element_id: 'paymentButton',
                element_type: 'button',
                element_text: 'ê²°ì œí•˜ê¸°',
                x: 550, y: 420
            });
            addLog('bugStatus', 'ğŸ‘† ê²°ì œ ë²„íŠ¼ í´ë¦­', 'info');

            // ë²„ê·¸ ìƒí™© ì‹œë®¬ë ˆì´ì…˜
            setTimeout(async () => {
                const button = document.getElementById('paymentButton');
                button.classList.add('broken');
                button.textContent = 'âŒ ê²°ì œ ì²˜ë¦¬ ì¤‘... (ì‘ë‹µì—†ìŒ)';
                button.disabled = true;
                
                await recordEvent(sessionId, {
                    type: 'javascript_error',
                    error_message: 'Cannot read property validate of undefined',
                    error_stack: 'at PaymentValidator.validate (payment.js:245:12)',
                    error_line: 245,
                    error_file: '/static/js/payment.js'
                });
                
                addLog('bugStatus', 'ğŸ› ë²„ê·¸ ë°œìƒ: JavaScript ì˜¤ë¥˜ - payment.validate() í•¨ìˆ˜ ì‹¤íŒ¨', 'error');
                
                // ì‚¬ìš©ì ì¬ì‹œë„ ì‹œë®¬ë ˆì´ì…˜
                await sleep(2000);
                await recordEvent(sessionId, {
                    type: 'click',
                    element_id: 'paymentButton',
                    element_type: 'button',
                    element_text: 'ê²°ì œí•˜ê¸°',
                    x: 550, y: 420,
                    notes: 'ë‘ ë²ˆì§¸ í´ë¦­ ì‹œë„'
                });
                addLog('bugStatus', 'ğŸ”„ ì‚¬ìš©ì ì¬ì‹œë„: ë²„íŠ¼ ë‘ ë²ˆì§¸ í´ë¦­', 'warning');

                await sleep(3000);
                await recordEvent(sessionId, {
                    type: 'page_unload',
                    page_url: '/checkout',
                    reason: 'user_frustration'
                });
                
                await endSessionRecording(sessionId, 'payment_error');
                addLog('bugStatus', 'ğŸ“Š ì„¸ì…˜ ì™„ë£Œ: ê²°ì œ ì‹¤íŒ¨ë¡œ ì¸í•œ ì‚¬ìš©ì ì´íƒˆ', 'error');
                addLog('bugStatus', `âœ… ì„¸ì…˜ ë°ì´í„° ì €ì¥ ì™„ë£Œ (ID: ${sessionId})`, 'success');
                
                sessionData.sessions++;
                sessionData.events += 7;
                sessionData.errors++;
                updateMetrics(sessionData);
            }, 2000);
        }

        function fixBugScenario() {
            addLog('bugStatus', 'ğŸ”§ ë²„ê·¸ ìˆ˜ì • ì ìš© ì¤‘...', 'warning');
            
            setTimeout(() => {
                const button = document.getElementById('paymentButton');
                button.classList.remove('broken');
                button.textContent = 'âœ… ê²°ì œ ì™„ë£Œ!';
                button.disabled = false;
                button.style.background = '#28a745';
                addLog('bugStatus', 'âœ… ë²„ê·¸ ìˆ˜ì • ì™„ë£Œ: ê²°ì œ ê¸°ëŠ¥ ì •ìƒí™”', 'success');
                
                // ìˆ˜ì • í›„ ì„¸ì…˜ ë°ì´í„°
                sendSessionData('bug_fixed', {
                    event_type: 'payment_success',
                    user_action: 'click_payment_button',
                    fix_applied: true,
                    response_time: '250ms'
                });
                
                sessionData.insights++;
                updateMetrics(sessionData);
            }, 1500);
        }

        function viewBugReplay() {
            addLog('bugStatus', 'ğŸ“º ì„¸ì…˜ ë¦¬í”Œë ˆì´ í”Œë ˆì´ì–´ë¡œ ì´ë™í•©ë‹ˆë‹¤...', 'info');
            setTimeout(() => {
                window.open('/session-replay-player', '_blank');
            }, 1000);
        }

        // 2. UX/UI ê°œì„  ì‹œë‚˜ë¦¬ì˜¤
        function navigateTo(page) {
            const content = document.getElementById('uxContent');
            const pages = {
                'home': 'ğŸ  í™ˆí˜ì´ì§€ - ë©”ì¸ ì½˜í…ì¸ ',
                'products': 'ğŸ“¦ ìƒí’ˆ ëª©ë¡ - ì „ì²´ ìƒí’ˆ',
                'categories': 'ğŸ“‚ ì¹´í…Œê³ ë¦¬ - ìƒí’ˆ ë¶„ë¥˜',
                'brands': 'ğŸ·ï¸ ë¸Œëœë“œ - ì œì¡°ì‚¬ë³„',
                'deals': 'ğŸ‰ íŠ¹ê°€ ìƒí’ˆ - í• ì¸ ì¤‘',
                'support': 'ğŸ§ ê³ ê°ì§€ì› - ë¬¸ì˜í•˜ê¸°',
                'account': 'ğŸ‘¤ ë‚´ ê³„ì • - í”„ë¡œí•„',
                'cart': 'ğŸ›’ ì¥ë°”êµ¬ë‹ˆ - ë‹´ì€ ìƒí’ˆ',
                'wishlist': 'â¤ï¸ ì°œëª©ë¡ - ê´€ì‹¬ ìƒí’ˆ',
                'orders': 'ğŸ“‹ ì£¼ë¬¸ë‚´ì—­ - êµ¬ë§¤ ê¸°ë¡'
            };
            
            content.textContent = pages[page] || 'í˜ì´ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤';
            
            // ì‹¤ì œ í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ì„¸ì…˜ì— ê¸°ë¡ (UX ì‹œë‚˜ë¦¬ì˜¤ìš©)
            if (scenarioSessions['ux_navigation']) {
                const button = event.target;
                const rect = button.getBoundingClientRect();
                recordEvent(scenarioSessions['ux_navigation'], {
                    type: 'click',
                    element_id: button.id || 'nav-' + page,
                    element_type: 'button',
                    element_text: button.textContent,
                    x: Math.round(rect.left + rect.width / 2),
                    y: Math.round(rect.top + rect.height / 2),
                    page_url: '/products',
                    timestamp: Date.now()
                });
            }
            
            // ì‚¬ìš©ì í–‰ë™ ê¸°ë¡
            sendSessionData('navigation', {
                event_type: 'page_view',
                page: page,
                user_action: 'click_navigation',
                timestamp: new Date().toISOString()
            });
            
            sessionData.events++;
            updateMetrics(sessionData);
        }

        async function startUXScenario() {
            currentScenario = 'ux';
            const sessionId = await startSessionRecording('ux_navigation');
            
            addLog('uxStatus', 'ğŸ¬ í†µí•© UX ë¶„ì„ ì‹œë‚˜ë¦¬ì˜¤ ì‹œì‘', 'info');
            addLog('uxStatus', 'ğŸ“Š ì‚¬ìš©ì í–‰ë™ íŒ¨í„´ ìˆ˜ì§‘ ì¤‘...', 'info');
            
            if (!sessionId) {
                addLog('uxStatus', 'âŒ ì„¸ì…˜ ë…¹í™” ì‹œì‘ ì‹¤íŒ¨', 'error');
                return;
            }
            
            addLog('uxStatus', `ğŸ“‹ ì„¸ì…˜ ID: ${sessionId.substring(0, 8)}...`, 'info');
            
            // í˜ì´ì§€ ë¡œë“œ ì´ë²¤íŠ¸ ê¸°ë¡
            await recordEvent(sessionId, {
                type: 'page_load',
                page_url: '/products',
                page_title: 'ìƒí’ˆ ëª©ë¡ í˜ì´ì§€',
                load_time: 1800
            });
            
            // ì‚¬ìš©ì í—¤ë§¤ëŠ” íŒ¨í„´ ì‹œë®¬ë ˆì´ì…˜
            setTimeout(async () => {
                // ì—¬ëŸ¬ ë„¤ë¹„ê²Œì´ì…˜ í´ë¦­ ì‹œë®¬ë ˆì´ì…˜
                const navItems = ['categories', 'brands', 'deals', 'products', 'support', 'account', 'cart'];
                for (let i = 0; i < navItems.length; i++) {
                    await sleep(500);
                    await recordEvent(sessionId, {
                        type: 'click',
                        element_id: 'nav-' + navItems[i],
                        element_type: 'button',
                        element_text: navItems[i],
                        x: 200 + i * 50, y: 100,
                        notes: 'navigation_confusion'
                    });
                }
                
                addLog('uxStatus', 'âš ï¸ íŒ¨í„´ ë°œê²¬: ì‚¬ìš©ìê°€ ë©”ë‰´ì—ì„œ 7íšŒ í´ë¦­ í›„ ì´íƒˆ', 'warning');
                addLog('uxStatus', 'ğŸ“ˆ ë¶„ì„: ì°¾ëŠ” ë©”ë‰´ë¥¼ ì°¾ì§€ ëª»í•´ í˜¼ë€', 'warning');
                
                // ì´íƒˆ ì´ë²¤íŠ¸ ê¸°ë¡
                await recordEvent(sessionId, {
                    type: 'page_unload',
                    page_url: '/products',
                    reason: 'user_confusion'
                });
                
                sessionData.sessions++;
                sessionData.events += 8;
                sessionData.errors++;
                updateMetrics(sessionData);
                
                // ì„¸ì…˜ ì¼ì‹œ ì¢…ë£Œ (ê°œì„  í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´)
                await endSessionRecording(sessionId, 'ux_analysis_complete');
                addLog('uxStatus', 'âœ… UX ë¶„ì„ ì™„ë£Œ - ì„¸ì…˜ ì¢…ë£Œ', 'success');
            }, 2000);
        }

        function improveNavigation() {
            addLog('uxStatus', 'âœ¨ ë„¤ë¹„ê²Œì´ì…˜ ê°œì„  ì ìš© ì¤‘...', 'warning');
            
            // ë©”ë‰´ í•­ëª©ë“¤ì„ ë” ë…¼ë¦¬ì ìœ¼ë¡œ ê·¸ë£¹í™”
            setTimeout(() => {
                addLog('uxStatus', 'âœ… ê°œì„  ì™„ë£Œ: ë©”ë‰´ë¥¼ 3ê°œ ê·¸ë£¹ìœ¼ë¡œ ì¬ì •ë ¬', 'success');
                addLog('uxStatus', 'ğŸ“Š ì˜ˆìƒ íš¨ê³¼: í´ë¦­ ìˆ˜ 50% ê°ì†Œ, ì´íƒˆë¥  30% ê°œì„ ', 'success');
                
                sessionData.insights++;
                updateMetrics(sessionData);
            }, 2000);
        }

        function viewUXReplay() {
            const sessionId = scenarioSessions['ux_navigation'];
            if (sessionId) {
                addLog('uxStatus', 'ğŸ“º UX ë¶„ì„ ì„¸ì…˜ ë¦¬í”Œë ˆì´ë¡œ ì´ë™í•©ë‹ˆë‹¤...', 'info');
                addLog('uxStatus', `ğŸ“‹ ì„¸ì…˜ ID: ${sessionId.substring(0, 8)}...`, 'info');
                setTimeout(() => {
                    const url = `/session-replay-player?scenario=ux_navigation&session=${sessionId}`;
                    window.open(url, '_blank');
                }, 1000);
            } else {
                addLog('uxStatus', 'âš ï¸ ë¨¼ì € UX ë¶„ì„ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”', 'warning');
            }
        }

        function viewUXAnalytics() {
            addLog('uxStatus', 'ğŸ“ˆ ì‚¬ìš©ì ë¶„ì„ ê²°ê³¼ í‘œì‹œ', 'info');
            addLog('uxStatus', 'â”Œâ”€ í‰ê·  í´ë¦­ ìˆ˜: 7.2íšŒ â†’ 3.4íšŒ', 'info');
            addLog('uxStatus', 'â”œâ”€ ì´íƒˆë¥ : 45% â†’ 28%', 'info');
            addLog('uxStatus', 'â”œâ”€ ë§Œì¡±ë„: 6.2/10 â†’ 8.7/10', 'info');
            addLog('uxStatus', 'â””â”€ ì „í™˜ìœ¨: 12% â†’ 18%', 'info');
        }

        // 3. ë³´ì•ˆ ë¶„ì„ ì‹œë‚˜ë¦¬ì˜¤
        function attemptLogin() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            // ì‹¤ì œ ë¡œê·¸ì¸ ì‹œë„ ì´ë²¤íŠ¸ë¥¼ ì„¸ì…˜ì— ê¸°ë¡
            if (scenarioSessions['security_attack']) {
                recordEvent(scenarioSessions['security_attack'], {
                    type: 'login_attempt',
                    username: username,
                    password_masked: password ? '***' + password.slice(-1) : '',
                    ip_address: '192.168.1.100',
                    user_agent: navigator.userAgent,
                    page_url: '/login',
                    x: 400, y: 300,
                    success: username && password ? true : false,
                    timestamp: Date.now()
                });
            }
            
            if (username && password) {
                addLog('securityStatus', `ğŸ”“ ë¡œê·¸ì¸ ì‹œë„: ${username}`, 'info');
                
                // ì •ìƒ ë¡œê·¸ì¸ ì‹œë®¬ë ˆì´ì…˜
                setTimeout(() => {
                    addLog('securityStatus', 'âœ… ë¡œê·¸ì¸ ì„±ê³µ', 'success');
                }, 1000);
            } else {
                addLog('securityStatus', 'âŒ ì‚¬ìš©ìëª…ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”', 'error');
            }
        }

        function simulateBruteForce() {
            if (scenarioSessions['security_attack']) {
                simulateBruteForceWithSession(scenarioSessions['security_attack']);
            } else {
                addLog('securityStatus', 'âš ï¸ ë³´ì•ˆ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ë¨¼ì € ì‹œì‘í•˜ì„¸ìš”', 'warning');
            }
        }
        
        async function simulateBruteForceWithSession(sessionId) {
            addLog('securityStatus', 'ğŸš¨ ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²© ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘', 'error');
            
            const commonPasswords = ['123456', 'password', 'admin', '123456789', 'qwerty'];
            let attemptCount = 0;
            
            const interval = setInterval(async () => {
                attemptCount++;
                addLog('securityStatus', `ğŸ”´ ì‹œë„ ${attemptCount}: admin/${commonPasswords[attemptCount % 5]} - ì‹¤íŒ¨`, 'error');
                
                // ì„¸ì…˜ì— ë¡œê·¸ì¸ ì‹œë„ ì´ë²¤íŠ¸ ê¸°ë¡
                await recordEvent(sessionId, {
                    type: 'login_attempt',
                    username: 'admin',
                    password_masked: commonPasswords[attemptCount % 5],
                    attempt_count: attemptCount,
                    ip_address: '192.168.1.100',
                    user_agent: 'automated_bot',
                    success: false,
                    x: 400, y: 300
                });
                
                sessionData.events++;
                sessionData.errors++;
                updateMetrics(sessionData);
                
                if (attemptCount >= 10) {
                    clearInterval(interval);
                    addLog('securityStatus', 'ğŸ›¡ï¸ ê³„ì • ì ê¸ˆ: 10íšŒ ì‹¤íŒ¨ë¡œ ì¸í•œ ìë™ ì°¨ë‹¨', 'warning');
                    
                    // ê³„ì • ì ê¸ˆ ì´ë²¤íŠ¸ ê¸°ë¡
                    await recordEvent(sessionId, {
                        type: 'account_lockout',
                        reason: 'excessive_failed_attempts',
                        attempts: attemptCount,
                        lockout_duration: '1 hour'
                    });
                    
                    // ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ ì¢…ë£Œ
                    setTimeout(async () => {
                        await endSessionRecording(sessionId, 'security_attack_blocked');
                        addLog('securityStatus', 'âœ… ë³´ì•ˆ ë¶„ì„ ì™„ë£Œ - ì„¸ì…˜ ì¢…ë£Œ', 'success');
                    }, 2000);
                }
            }, 500);
        }

        function simulateCredentialStuffing() {
            addLog('securityStatus', 'ğŸš¨ í¬ë¦¬ë´ì…œ ìŠ¤í„°í•‘ ê³µê²© ì‹œë®¬ë ˆì´ì…˜', 'error');
            addLog('securityStatus', 'ğŸ“Š ìœ ì¶œëœ ê³„ì • ì •ë³´ë¡œ ëŒ€ëŸ‰ ë¡œê·¸ì¸ ì‹œë„ ê°ì§€', 'error');
            
            sessionData.sessions++;
            sessionData.events += 50;
            sessionData.errors += 5;
            updateMetrics(sessionData);
        }

        function simulateBot() {
            addLog('securityStatus', 'ğŸ¤– ë´‡ ê³µê²© ì‹œë®¬ë ˆì´ì…˜', 'error');
            addLog('securityStatus', 'ğŸ” ë¹„ì •ìƒì ì¸ í–‰ë™ íŒ¨í„´ ê°ì§€: ì´ˆë‹¹ 10íšŒ ìš”ì²­', 'error');
            
            sessionData.events += 20;
            sessionData.errors += 2;
            updateMetrics(sessionData);
        }

        async function startSecurityScenario() {
            currentScenario = 'security';
            const sessionId = await startSessionRecording('security_attack');
            
            addLog('securityStatus', 'ğŸ¬ í†µí•© ë³´ì•ˆ ë¶„ì„ ì‹œë‚˜ë¦¬ì˜¤ ì‹œì‘', 'info');
            addLog('securityStatus', 'ğŸ” ì˜ì‹¬ìŠ¤ëŸ¬ìš´ í™œë™ ëª¨ë‹ˆí„°ë§ í™œì„±í™”', 'info');
            
            if (!sessionId) {
                addLog('securityStatus', 'âŒ ì„¸ì…˜ ë…¹í™” ì‹œì‘ ì‹¤íŒ¨', 'error');
                return;
            }
            
            addLog('securityStatus', `ğŸ“‹ ì„¸ì…˜ ID: ${sessionId.substring(0, 8)}...`, 'info');
            
            // í˜ì´ì§€ ë¡œë“œ ì´ë²¤íŠ¸ ê¸°ë¡
            await recordEvent(sessionId, {
                type: 'page_load',
                page_url: '/login',
                page_title: 'ë¡œê·¸ì¸ í˜ì´ì§€',
                load_time: 1200
            });
            
            // ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²© ì‹œë®¬ë ˆì´ì…˜ì„ ìë™ìœ¼ë¡œ ì‹œì‘
            setTimeout(() => {
                simulateBruteForceWithSession(sessionId);
            }, 1000);
            
            sessionData.sessions++;
            updateMetrics(sessionData);
        }

        function applySecurity() {
            addLog('securityStatus', 'ğŸ›¡ï¸ ë³´ì•ˆ ê°•í™” ì¡°ì¹˜ ì ìš©', 'warning');
            addLog('securityStatus', 'âœ… CAPTCHA í™œì„±í™”', 'success');
            addLog('securityStatus', 'âœ… ë¡œê·¸ì¸ ì‹œë„ ì œí•œ (5íšŒ/ì‹œê°„)', 'success');
            addLog('securityStatus', 'âœ… ì˜ì‹¬ IP ìë™ ì°¨ë‹¨', 'success');
            
            sessionData.insights++;
            updateMetrics(sessionData);
        }

        function viewSecurityReplay() {
            const sessionId = scenarioSessions['security_attack'];
            if (sessionId) {
                addLog('securityStatus', 'ğŸ“º ë³´ì•ˆ ì‚¬ê³  ë¶„ì„ ì„¸ì…˜ ë¦¬í”Œë ˆì´ë¡œ ì´ë™í•©ë‹ˆë‹¤...', 'info');
                addLog('securityStatus', `ğŸ“‹ ì„¸ì…˜ ID: ${sessionId.substring(0, 8)}...`, 'info');
                setTimeout(() => {
                    const url = `/session-replay-player?scenario=security_attack&session=${sessionId}`;
                    window.open(url, '_blank');
                }, 1000);
            } else {
                addLog('securityStatus', 'âš ï¸ ë¨¼ì € ë³´ì•ˆ ë¶„ì„ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”', 'warning');
            }
        }

        function viewSecurityReport() {
            addLog('securityStatus', 'ğŸ“‹ ë³´ì•ˆ ë¶„ì„ ë¦¬í¬íŠ¸', 'info');
            addLog('securityStatus', 'â”Œâ”€ íƒì§€ëœ ê³µê²©: ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©', 'info');
            addLog('securityStatus', 'â”œâ”€ ê³µê²© íšŸìˆ˜: 247íšŒ', 'info');
            addLog('securityStatus', 'â”œâ”€ ì°¨ë‹¨ëœ IP: 15ê°œ', 'info');
            addLog('securityStatus', 'â””â”€ ë³´ì•ˆ ê°•í™” í›„ ê³µê²© ê°ì†Œ: 95%', 'info');
        }

        // 4. ì„±ëŠ¥ ì§„ë‹¨ ì‹œë‚˜ë¦¬ì˜¤
        function loadChart(type) {
            // ì‹¤ì œ í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ì„¸ì…˜ì— ê¸°ë¡ (ì„±ëŠ¥ ì‹œë‚˜ë¦¬ì˜¤ìš©)
            if (scenarioSessions['performance_slow']) {
                const button = event.target;
                const rect = button.getBoundingClientRect();
                recordEvent(scenarioSessions['performance_slow'], {
                    type: 'click',
                    element_id: 'chart-' + type,
                    element_type: 'dashboard_item',
                    element_text: button.textContent,
                    x: Math.round(rect.left + rect.width / 2),
                    y: Math.round(rect.top + rect.height / 2),
                    page_url: '/dashboard',
                    timestamp: Date.now()
                });
                
                loadChartWithSession(scenarioSessions['performance_slow'], type);
            } else {
                addLog('performanceStatus', 'âš ï¸ ì„±ëŠ¥ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ë¨¼ì € ì‹œì‘í•˜ì„¸ìš”', 'warning');
            }
        }
        
        async function loadChartWithSession(sessionId, type) {
            const chartTypes = {
                'sales': 'ğŸ’° ë§¤ì¶œ ì°¨íŠ¸ ë¡œë”©',
                'users': 'ğŸ‘¥ ì‚¬ìš©ì í†µê³„ ë¡œë”©',
                'performance': 'âš¡ ì„±ëŠ¥ ì§€í‘œ ë¡œë”©',
                'traffic': 'ğŸŒ íŠ¸ë˜í”½ ë¶„ì„ ë¡œë”©',
                'errors': 'ğŸš¨ ì˜¤ë¥˜ í˜„í™© ë¡œë”©',
                'system': 'ğŸ–¥ï¸ ì‹œìŠ¤í…œ ìƒíƒœ ë¡œë”©'
            };
            
            addLog('performanceStatus', chartTypes[type] || 'ì°¨íŠ¸ ë¡œë”©', 'info');
            
            // ì°¨íŠ¸ í´ë¦­ ì´ë²¤íŠ¸ ê¸°ë¡
            await recordEvent(sessionId, {
                type: 'click',
                element_id: 'chart-' + type,
                element_type: 'dashboard_item',
                element_text: chartTypes[type],
                x: 300 + Math.random() * 200, 
                y: 200 + Math.random() * 100
            });
            
            // API ìš”ì²­ ì‹œì‘ ì´ë²¤íŠ¸ ê¸°ë¡
            await recordEvent(sessionId, {
                type: 'api_request',
                endpoint: `/api/charts/${type}`,
                method: 'GET',
                status: 'started'
            });
            
            // ëŠë¦° ë¡œë”© ì‹œë®¬ë ˆì´ì…˜
            setTimeout(async () => {
                const loadTime = 7500 + Math.random() * 2000; // 7.5~9.5ì´ˆ
                
                addLog('performanceStatus', `â±ï¸ ${type} ì°¨íŠ¸ ë¡œë”© ì™„ë£Œ (${(loadTime/1000).toFixed(1)}ì´ˆ ì†Œìš”)`, 'warning');
                
                // API ìš”ì²­ ì™„ë£Œ ì´ë²¤íŠ¸ ê¸°ë¡
                await recordEvent(sessionId, {
                    type: 'api_request',
                    endpoint: `/api/charts/${type}`,
                    method: 'GET',
                    status: 'completed',
                    duration: loadTime,
                    performance_issue: true
                });
                
                // ì°¨íŠ¸ ë Œë”ë§ ì´ë²¤íŠ¸ ê¸°ë¡
                await recordEvent(sessionId, {
                    type: 'chart_render_complete',
                    chart_type: type,
                    render_time: loadTime,
                    chart_id: 'chart-' + type
                });
                
                sessionData.events++;
                if (loadTime > 8000) {
                    sessionData.errors++;
                }
                updateMetrics(sessionData);
                
                // ì—¬ëŸ¬ ì°¨íŠ¸ë¥¼ ë¡œë”©í•œ í›„ ì„¸ì…˜ ì¢…ë£Œ
                if (type === 'sales') {
                    setTimeout(async () => {
                        await endSessionRecording(sessionId, 'performance_test_complete');
                        addLog('performanceStatus', 'âœ… ì„±ëŠ¥ ë¶„ì„ ì™„ë£Œ - ì„¸ì…˜ ì¢…ë£Œ', 'success');
                    }, 2000);
                }
            }, 3000);
        }

        function simulateHighLoad() {
            addLog('performanceStatus', 'ğŸ”¥ ë†’ì€ ë¶€í•˜ ì‹œë®¬ë ˆì´ì…˜', 'warning');
            addLog('performanceStatus', 'ğŸ“Š CPU ì‚¬ìš©ë¥ : 95%, ë©”ëª¨ë¦¬: 88%', 'error');
            
            sessionData.events += 10;
            sessionData.errors += 2;
            updateMetrics(sessionData);
        }

        function simulateSlowQuery() {
            addLog('performanceStatus', 'ğŸŒ ëŠë¦° ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ì‹œë®¬ë ˆì´ì…˜', 'warning');
            addLog('performanceStatus', 'â±ï¸ ì¿¼ë¦¬ ì‹¤í–‰ ì‹œê°„: 15.7ì´ˆ', 'error');
            
            sessionData.events += 5;
            sessionData.errors++;
            updateMetrics(sessionData);
        }

        function simulateMemoryLeak() {
            addLog('performanceStatus', 'ğŸ•³ï¸ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ì‹œë®¬ë ˆì´ì…˜', 'warning');
            addLog('performanceStatus', 'ğŸ“ˆ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ì§€ì†ì ìœ¼ë¡œ ì¦ê°€ ì¤‘', 'error');
            
            sessionData.events += 3;
            sessionData.errors++;
            updateMetrics(sessionData);
        }

        async function startPerformanceScenario() {
            currentScenario = 'performance';
            const sessionId = await startSessionRecording('performance_slow');
            
            addLog('performanceStatus', 'ğŸ¬ í†µí•© ì„±ëŠ¥ ë¶„ì„ ì‹œë‚˜ë¦¬ì˜¤ ì‹œì‘', 'info');
            addLog('performanceStatus', 'ğŸ“Š ëŒ€ì‹œë³´ë“œ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ í™œì„±í™”', 'info');
            
            if (!sessionId) {
                addLog('performanceStatus', 'âŒ ì„¸ì…˜ ë…¹í™” ì‹œì‘ ì‹¤íŒ¨', 'error');
                return;
            }
            
            addLog('performanceStatus', `ğŸ“‹ ì„¸ì…˜ ID: ${sessionId.substring(0, 8)}...`, 'info');
            
            // í˜ì´ì§€ ë¡œë“œ ì´ë²¤íŠ¸ ê¸°ë¡ (ëŠë¦° ë¡œë”©)
            await recordEvent(sessionId, {
                type: 'page_load',
                page_url: '/dashboard',
                page_title: 'ëŒ€ì‹œë³´ë“œ',
                load_time: 7500
            });
            
            // ìë™ìœ¼ë¡œ ì°¨íŠ¸ ë¡œë”© ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘
            setTimeout(() => {
                loadChartWithSession(sessionId, 'sales');
            }, 1000);
            
            sessionData.sessions++;
            updateMetrics(sessionData);
        }

        function optimizePerformance() {
            addLog('performanceStatus', 'ğŸš€ ì„±ëŠ¥ ìµœì í™” ì ìš©', 'warning');
            addLog('performanceStatus', 'âœ… ë°ì´í„°ë² ì´ìŠ¤ ì¸ë±ìŠ¤ ìµœì í™”', 'success');
            addLog('performanceStatus', 'âœ… ìºì‹± ë ˆì´ì–´ ì¶”ê°€', 'success');
            addLog('performanceStatus', 'âœ… ë ˆì´ì§€ ë¡œë”© êµ¬í˜„', 'success');
            addLog('performanceStatus', 'ğŸ“ˆ ë¡œë”© ì‹œê°„: 8.5ì´ˆ â†’ 2.1ì´ˆ (75% ê°œì„ )', 'success');
            
            sessionData.insights++;
            updateMetrics(sessionData);
        }

        function viewPerformanceReplay() {
            const sessionId = scenarioSessions['performance_slow'];
            if (sessionId) {
                addLog('performanceStatus', 'ğŸ“º ì„±ëŠ¥ ë¬¸ì œ ì§„ë‹¨ ì„¸ì…˜ ë¦¬í”Œë ˆì´ë¡œ ì´ë™í•©ë‹ˆë‹¤...', 'info');
                addLog('performanceStatus', `ğŸ“‹ ì„¸ì…˜ ID: ${sessionId.substring(0, 8)}...`, 'info');
                setTimeout(() => {
                    const url = `/session-replay-player?scenario=performance_slow&session=${sessionId}`;
                    window.open(url, '_blank');
                }, 1000);
            } else {
                addLog('performanceStatus', 'âš ï¸ ë¨¼ì € ì„±ëŠ¥ ë¶„ì„ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”', 'warning');
            }
        }

        function viewPerformanceReport() {
            addLog('performanceStatus', 'ğŸ“Š ì„±ëŠ¥ ë¶„ì„ ë¦¬í¬íŠ¸', 'info');
            addLog('performanceStatus', 'â”Œâ”€ í‰ê·  ë¡œë”© ì‹œê°„: 8.5ì´ˆ â†’ 2.1ì´ˆ', 'info');
            addLog('performanceStatus', 'â”œâ”€ CPU ì‚¬ìš©ë¥ : 95% â†’ 45%', 'info');
            addLog('performanceStatus', 'â”œâ”€ ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ : 88% â†’ 52%', 'info');
            addLog('performanceStatus', 'â””â”€ ì‚¬ìš©ì ë§Œì¡±ë„: +40% í–¥ìƒ', 'info');
        }

        // ê³µí†µ í•¨ìˆ˜ë“¤
        function getPaymentFormData() {
            return {
                cardNumber: document.getElementById('cardNumber').value,
                expiry: document.getElementById('expiry').value,
                cvv: document.getElementById('cvv').value,
                cardType: document.getElementById('cardType').value
            };
        }

        function sendSessionData(eventType, data) {
            // APIë¡œ ì„¸ì…˜ ë°ì´í„° ì „ì†¡
            fetch('/api/session-replay/record', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    session_id: 'session_' + Date.now(),
                    event_type: eventType,
                    timestamp: new Date().toISOString(),
                    data: data,
                    scenario: currentScenario
                })
            }).catch(err => console.log('Session data sent (simulated)'));
        }

        // ì¹´ë“œ ë²ˆí˜¸ ìë™ í¬ë§·íŒ…
        document.getElementById('cardNumber').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\s+/g, '').replace(/[^0-9]/gi, '');
            let matches = value.match(/\d{4,16}/g);
            let match = matches && matches[0] || '';
            let parts = [];
            
            for (let i = 0, len = match.length; i < len; i += 4) {
                parts.push(match.substring(i, i + 4));
            }
            
            if (parts.length) {
                e.target.value = parts.join('-');
            } else {
                e.target.value = value;
            }
        });

        // ë§Œë£Œì¼ ìë™ í¬ë§·íŒ…
        document.getElementById('expiry').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length >= 2) {
                value = value.substring(0, 2) + '/' + value.substring(2, 4);
            }
            e.target.value = value;
        });

        // ì‹¤ì œ ë§ˆìš°ìŠ¤ ë° í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        function setupEventListeners() {
            // UX ì‹œë‚˜ë¦¬ì˜¤ ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ë“¤ì— ì‹¤ì œ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            document.querySelectorAll('.nav-item').forEach(button => {
                button.addEventListener('click', function(e) {
                    if (scenarioSessions['ux_navigation']) {
                        const rect = button.getBoundingClientRect();
                        recordEvent(scenarioSessions['ux_navigation'], {
                            type: 'click',
                            element_id: button.id || button.textContent.trim(),
                            element_type: 'navigation_button',
                            element_text: button.textContent,
                            x: Math.round(rect.left + rect.width / 2),
                            y: Math.round(rect.top + rect.height / 2),
                            page_url: '/products',
                            timestamp: Date.now()
                        });
                    }
                });
            });

            // ë³´ì•ˆ ì‹œë‚˜ë¦¬ì˜¤ ì…ë ¥ í•„ë“œë“¤ì— í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            const securityInputs = ['username', 'password'];
            securityInputs.forEach(inputId => {
                const input = document.getElementById(inputId);
                if (input) {
                    input.addEventListener('input', function(e) {
                        if (scenarioSessions['security_attack']) {
                            const rect = input.getBoundingClientRect();
                            recordEvent(scenarioSessions['security_attack'], {
                                type: 'form_input',
                                element_id: inputId,
                                element_type: 'input',
                                value_masked: inputId === 'password' ? '*'.repeat(e.target.value.length) : e.target.value,
                                x: Math.round(rect.left + rect.width / 2),
                                y: Math.round(rect.top + rect.height / 2),
                                page_url: '/login',
                                timestamp: Date.now()
                            });
                        }
                    });
                }
            });

            // ì„±ëŠ¥ ì‹œë‚˜ë¦¬ì˜¤ ì°¨íŠ¸ ë²„íŠ¼ë“¤ì— í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            document.querySelectorAll('.dashboard-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    if (scenarioSessions['performance_slow']) {
                        const rect = item.getBoundingClientRect();
                        recordEvent(scenarioSessions['performance_slow'], {
                            type: 'click',
                            element_id: item.id || item.textContent.trim(),
                            element_type: 'dashboard_item',
                            element_text: item.textContent,
                            x: Math.round(rect.left + rect.width / 2),
                            y: Math.round(rect.top + rect.height / 2),
                            page_url: '/dashboard',
                            timestamp: Date.now()
                        });
                    }
                });
            });

            // ë²„ê·¸ ì‹œë‚˜ë¦¬ì˜¤ ê²°ì œ í¼ ì…ë ¥ í•„ë“œë“¤ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ (ì´ë¯¸ ìˆì§€ë§Œ ë³´ê°•)
            const paymentInputs = ['cardNumber', 'expiry', 'cvv', 'cardType'];
            paymentInputs.forEach(inputId => {
                const input = document.getElementById(inputId);
                if (input) {
                    input.addEventListener('input', function(e) {
                        if (scenarioSessions['bug_payment']) {
                            const rect = input.getBoundingClientRect();
                            recordEvent(scenarioSessions['bug_payment'], {
                                type: 'form_input',
                                element_id: inputId,
                                element_type: input.type === 'select-one' ? 'select' : 'input',
                                value_masked: inputId === 'cardNumber' ? 
                                    e.target.value.replace(/\d(?=\d{4})/g, '*') : 
                                    e.target.value,
                                x: Math.round(rect.left + rect.width / 2),
                                y: Math.round(rect.top + rect.height / 2),
                                page_url: '/checkout',
                                timestamp: Date.now()
                            });
                        }
                    });
                }
            });
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
        });

        // ì´ˆê¸° ë©”íŠ¸ë¦­ ë¡œë“œ
        updateMetrics(sessionData);
        
        // ì´ˆê¸° ì„¸ì…˜ ìƒíƒœ í‘œì‹œ
        updateSessionStatus();
        
        // í˜ì´ì§€ê°€ ì´ë¯¸ ë¡œë“œëœ ê²½ìš°ë¥¼ ìœ„í•´ ì¦‰ì‹œ ì‹¤í–‰
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', setupEventListeners);
        } else {
            setupEventListeners();
        }
    </script>
</body>
</html>