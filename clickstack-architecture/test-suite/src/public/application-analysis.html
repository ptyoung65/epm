<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIRIS-MON ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë¶„ì„</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/mermaid@10/dist/mermaid.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="/components/common-layout.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 0;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            text-decoration: none;
        }

        .nav-menu {
            display: flex;
            gap: 30px;
            list-style: none;
        }

        .nav-link {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .nav-link:hover, .nav-link.active {
            background: #667eea;
            color: white;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .page-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .page-title {
            font-size: 28px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .page-subtitle {
            color: #666;
            font-size: 16px;
            margin-bottom: 20px;
        }

        .stats-pills {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .stat-pill {
            padding: 8px 16px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stat-pill.programs {
            background: #d4edda;
            color: #155724;
        }

        .stat-pill.tables {
            background: #cce5ff;
            color: #004085;
        }

        .stat-pill.classes {
            background: #fff3cd;
            color: #856404;
        }

        .stat-pill.data {
            background: #f8d7da;
            color: #721c24;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .grid-full {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .grid-triple {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .card-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-icon {
            width: 24px;
            height: 24px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 20px;
        }

        .network-container {
            position: relative;
            height: 500px;
            margin-bottom: 20px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            overflow: hidden;
        }

        .diagram-container {
            position: relative;
            height: 600px;
            margin-bottom: 20px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            overflow: auto;
            background: #f8f9fa;
        }

        .list-container {
            max-height: 400px;
            overflow-y: auto;
        }

        .list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            background: #f8f9fa;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .list-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }

        .list-item-name {
            font-weight: 500;
            color: #333;
        }

        .list-item-type {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 12px;
            font-weight: bold;
        }

        .type-api {
            background: #28a745;
            color: white;
        }

        .type-service {
            background: #007bff;
            color: white;
        }

        .type-model {
            background: #ffc107;
            color: #333;
        }

        .type-util {
            background: #6c757d;
            color: white;
        }

        .type-master {
            background: #17a2b8;
            color: white;
        }

        .type-transaction {
            background: #dc3545;
            color: white;
        }

        .type-log {
            background: #6f42c1;
            color: white;
        }

        .progress-bar {
            background: #e9ecef;
            border-radius: 10px;
            height: 8px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .progress-fill.high {
            background: linear-gradient(90deg, #28a745, #20c997);
        }

        .progress-fill.medium {
            background: linear-gradient(90deg, #ffc107, #fd7e14);
        }

        .progress-fill.low {
            background: linear-gradient(90deg, #dc3545, #e83e8c);
        }

        .data-metrics {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        .metric-item {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 12px;
            color: #666;
            font-weight: 500;
        }

        .filter-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .filter-label {
            font-size: 12px;
            font-weight: 500;
            color: #666;
        }

        .filter-select {
            padding: 8px 12px;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            background: white;
            font-size: 14px;
        }

        .refresh-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
        }

        .refresh-btn:hover {
            background: #5a67d8;
            transform: scale(1.1);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid #dee2e6;
        }

        .tab {
            padding: 12px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 500;
            color: #666;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        @media (max-width: 768px) {
            .grid, .grid-triple {
                grid-template-columns: 1fr;
            }
            
            .nav-menu {
                display: none;
            }
            
            .data-metrics {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #667eea;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* D3.js ë„¤íŠ¸ì›Œí¬ ê·¸ë˜í”„ ìŠ¤íƒ€ì¼ */
        .node {
            cursor: pointer;
        }

        .node circle {
            transition: all 0.3s ease;
        }

        .node:hover circle {
            stroke-width: 3px;
        }

        .link {
            stroke: #999;
            stroke-opacity: 0.6;
            stroke-width: 2px;
        }

        .node text {
            font-size: 12px;
            font-weight: 500;
        }

        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            pointer-events: none;
            z-index: 1000;
        }

        /* CRUD ë§¤íŠ¸ë¦­ìŠ¤ ìŠ¤íƒ€ì¼ */
        .crud-matrix-container {
            width: 100%;
            overflow: auto;
            margin: 20px 0;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
        }

        .matrix-table-wrapper {
            min-width: 800px;
        }

        .crud-matrix {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            background: white;
            font-size: 13px;
        }

        .crud-matrix th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-weight: 600;
            border: 1px solid #5a6fd8;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .crud-matrix th.program-header {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            border: 1px solid #1e7e34;
            min-width: 200px;
            text-align: left;
            padding: 12px 16px;
            position: sticky;
            left: 0;
            z-index: 11;
        }

        .crud-matrix td.program-name {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 12px 16px;
            font-weight: 600;
            color: #495057;
            position: sticky;
            left: 0;
            z-index: 5;
            min-width: 200px;
        }

        .crud-matrix td.crud-cell {
            border: 1px solid #dee2e6;
            padding: 8px;
            text-align: center;
            min-width: 80px;
            background: white;
            transition: all 0.2s ease;
        }

        .crud-matrix td.crud-cell:hover {
            background: #e9ecef;
        }

        .crud-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 700;
            margin: 2px;
            color: white;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.3);
        }

        .crud-badge.crud-c {
            background: linear-gradient(135deg, #28a745, #20c997);
        }

        .crud-badge.crud-r {
            background: linear-gradient(135deg, #17a2b8, #138496);
        }

        .crud-badge.crud-u {
            background: linear-gradient(135deg, #ffc107, #e0a800);
        }

        .crud-badge.crud-d {
            background: linear-gradient(135deg, #dc3545, #c82333);
        }

        .matrix-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 16px;
            padding: 16px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 500;
        }

        .crud-cell-multiple {
            display: flex;
            flex-wrap: wrap;
            gap: 2px;
            justify-content: center;
            align-items: center;
        }

        .crud-matrix tbody tr:nth-child(even) td.program-name {
            background: #e9ecef;
        }

        .crud-matrix tbody tr:hover td {
            background: #e3f2fd !important;
        }

        .crud-matrix tbody tr:hover td.program-name {
            background: #bbdefb !important;
        }
    </style>
</head>
<body>
    <div class="airis-content-wrapper">
        <div class="page-header">
            <h1 class="page-title">AIRIS-MON ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë¶„ì„</h1>
            <p class="page-subtitle">ëª¨ë“ˆ ì•„í‚¤í…ì²˜, ë°ì´í„° ì €ì¥ì†Œ ê´€ê³„, ì˜ì¡´ì„± êµ¬ì¡° ë° ì‹¤ì‹œê°„ ì‹œìŠ¤í…œ ìƒíƒœ ë¶„ì„</p>
            <div class="stats-pills">
                <div class="stat-pill programs">
                    <span>ğŸ§©</span> ëª¨ë“ˆ <span id="programCount">10</span>ê°œ
                </div>
                <div class="stat-pill tables">
                    <span>ğŸ’¾</span> ë°ì´í„° ì €ì¥ì†Œ <span id="tableCount">10</span>ê°œ
                </div>
                <div class="stat-pill classes">
                    <span>ğŸ—ï¸</span> ì»´í¬ë„ŒíŠ¸ <span id="classCount">25</span>ê°œ
                </div>
                <div class="stat-pill data">
                    <span>ğŸ“Š</span> ì‹¤ì‹œê°„ ì²˜ë¦¬ìœ¨ <span id="totalRecords">92%</span>
                </div>
            </div>
        </div>

        <!-- í”„ë¡œê·¸ë¨-í…Œì´ë¸” CRUD ë§¤íŠ¸ë¦­ìŠ¤ -->
        <div class="grid-full">
            <div class="card">
                <h2 class="card-title">
                    <div class="card-icon" style="background: #28a745;">ğŸ”—</div>
                    í”„ë¡œê·¸ë¨-í…Œì´ë¸” CRUD ë§¤íŠ¸ë¦­ìŠ¤
                </h2>
                <div class="filter-controls">
                    <div class="filter-group">
                        <label class="filter-label">í”„ë¡œê·¸ë¨ ìœ í˜•</label>
                        <select class="filter-select" id="programTypeFilter">
                            <option value="">ì „ì²´</option>
                            <option value="main">ë©”ì¸</option>
                            <option value="module">ëª¨ë“ˆ</option>
                            <option value="frontend">í”„ë¡ íŠ¸ì—”ë“œ</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">ë°ì´í„°ì €ì¥ì†Œ ìœ í˜•</label>
                        <select class="filter-select" id="tableTypeFilter">
                            <option value="">ì „ì²´</option>
                            <option value="datastore">ë°ì´í„°ì €ì¥ì†Œ</option>
                            <option value="communication">í†µì‹ </option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">CRUD í•„í„°</label>
                        <select class="filter-select" id="crudFilter">
                            <option value="">ì „ì²´</option>
                            <option value="C">Create</option>
                            <option value="R">Read</option>
                            <option value="U">Update</option>
                            <option value="D">Delete</option>
                        </select>
                    </div>
                </div>
                <div class="crud-matrix-container">
                    <div class="matrix-table-wrapper">
                        <table class="crud-matrix" id="crudMatrix">
                            <thead>
                                <tr>
                                    <th class="program-header">í”„ë¡œê·¸ë¨ / í…Œì´ë¸”</th>
                                    <!-- í…Œì´ë¸” í—¤ë”ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                                </tr>
                            </thead>
                            <tbody>
                                <!-- í”„ë¡œê·¸ë¨ í–‰ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="matrix-legend">
                    <div class="legend-item">
                        <span class="crud-badge crud-c">C</span> Create (ìƒì„±)
                    </div>
                    <div class="legend-item">
                        <span class="crud-badge crud-r">R</span> Read (ì¡°íšŒ)
                    </div>
                    <div class="legend-item">
                        <span class="crud-badge crud-u">U</span> Update (ìˆ˜ì •)
                    </div>
                    <div class="legend-item">
                        <span class="crud-badge crud-d">D</span> Delete (ì‚­ì œ)
                    </div>
                </div>
            </div>
        </div>

        <!-- í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ -->
        <div class="grid-full">
            <div class="card">
                <h2 class="card-title">
                    <div class="card-icon" style="background: #ffc107;">ğŸ—ï¸</div>
                    í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨
                </h2>
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('overview')">ì „ì²´ êµ¬ì¡°</button>
                    <button class="tab" onclick="switchTab('api')">API ë ˆì´ì–´</button>
                    <button class="tab" onclick="switchTab('service')">ì„œë¹„ìŠ¤ ë ˆì´ì–´</button>
                    <button class="tab" onclick="switchTab('model')">ëª¨ë¸ ë ˆì´ì–´</button>
                </div>
                <div class="tab-content active" id="overviewTab">
                    <div class="diagram-container" id="classDiagram"></div>
                </div>
                <div class="tab-content" id="apiTab">
                    <div class="diagram-container" id="apiDiagram"></div>
                </div>
                <div class="tab-content" id="serviceTab">
                    <div class="diagram-container" id="serviceDiagram"></div>
                </div>
                <div class="tab-content" id="modelTab">
                    <div class="diagram-container" id="modelDiagram"></div>
                </div>
            </div>
        </div>

        <!-- í”„ë¡œê·¸ë¨ ë¦¬ìŠ¤íŠ¸, í…Œì´ë¸” ë¦¬ìŠ¤íŠ¸, ë°ì´í„° ì ì¬ í˜„í™© -->
        <div class="grid-triple">
            <div class="card">
                <h2 class="card-title">
                    <div class="card-icon" style="background: #6f42c1;">ğŸ“±</div>
                    í”„ë¡œê·¸ë¨ ë¦¬ìŠ¤íŠ¸
                </h2>
                <div class="filter-controls">
                    <div class="filter-group">
                        <label class="filter-label">í•„í„°</label>
                        <select class="filter-select" id="programFilter">
                            <option value="">ì „ì²´</option>
                            <option value="api">API</option>
                            <option value="service">ì„œë¹„ìŠ¤</option>
                            <option value="model">ëª¨ë¸</option>
                            <option value="util">ìœ í‹¸ë¦¬í‹°</option>
                        </select>
                    </div>
                </div>
                <div class="list-container" id="programList">
                    <!-- í”„ë¡œê·¸ë¨ ë¦¬ìŠ¤íŠ¸ê°€ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">
                    <div class="card-icon" style="background: #17a2b8;">ğŸ—„ï¸</div>
                    í…Œì´ë¸” ë¦¬ìŠ¤íŠ¸
                </h2>
                <div class="filter-controls">
                    <div class="filter-group">
                        <label class="filter-label">í•„í„°</label>
                        <select class="filter-select" id="tableFilter">
                            <option value="">ì „ì²´</option>
                            <option value="master">ë§ˆìŠ¤í„°</option>
                            <option value="transaction">íŠ¸ëœì­ì…˜</option>
                            <option value="log">ë¡œê·¸</option>
                        </select>
                    </div>
                </div>
                <div class="list-container" id="tableList">
                    <!-- í…Œì´ë¸” ë¦¬ìŠ¤íŠ¸ê°€ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">
                    <div class="card-icon" style="background: #dc3545;">ğŸ“ˆ</div>
                    ë°ì´í„° ì ì¬ í˜„í™©
                </h2>
                <div class="data-metrics">
                    <div class="metric-item">
                        <div class="metric-value" id="totalRows">1.2M</div>
                        <div class="metric-label">ì´ ë ˆì½”ë“œ</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="todayInserts">12.5K</div>
                        <div class="metric-label">ì˜¤ëŠ˜ ì¶”ê°€</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="avgGrowth">+2.3%</div>
                        <div class="metric-label">ì¼í‰ê·  ì¦ê°€ìœ¨</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="dbSize">4.8GB</div>
                        <div class="metric-label">DB ì‚¬ìš©ëŸ‰</div>
                    </div>
                </div>
                <div class="list-container" id="dataStatusList">
                    <!-- í…Œì´ë¸”ë³„ ë°ì´í„° í˜„í™©ì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>

    <script>
        // ê´€ë¦¬ì ì„¤ì • í•¨ìˆ˜
        function openAdminSettings() {
            window.location.href = '/admin-settings.html';
        }

        // íƒ­ ì „í™˜ í•¨ìˆ˜
        function switchTab(tabName) {
            // ëª¨ë“  íƒ­ê³¼ ì»¨í…ì¸  ë¹„í™œì„±í™”
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // ì„ íƒëœ íƒ­ê³¼ ì»¨í…ì¸  í™œì„±í™”
            event.target.classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            // í•´ë‹¹ ë‹¤ì´ì–´ê·¸ë¨ ë¡œë“œ
            loadClassDiagram(tabName);
        }

        // ì „ì—­ ë³€ìˆ˜
        let correlationData = null;
        let programData = null;
        let tableData = null;
        let dependencyChart = null;

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ¯ DOM ë¡œë“œ ì™„ë£Œ, ì´ˆê¸°í™” ì‹œì‘...');
            
            try {
                // ì°¨íŠ¸ ì´ˆê¸°í™”ëŠ” ìŠ¤í‚µ (ì˜ì¡´ì„± ì°¨íŠ¸ ìš”ì†Œê°€ ì—†ìŒ)
                // initializeCharts();
                
                console.log('ğŸ“Š ë¶„ì„ ë°ì´í„° ë¡œë“œ ì‹œì‘...');
                loadAnalysisData();
                
                console.log('ğŸ”§ í•„í„° ì„¤ì • ì‹œì‘...');
                setupFilters();
                
                console.log('âœ… ì• í”Œë¦¬ì¼€ì´ì…˜ ë¶„ì„ ëŒ€ì‹œë³´ë“œ ë¡œë“œ ì™„ë£Œ');
            } catch (error) {
                console.error('âŒ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
            }
        });

        // ì°¨íŠ¸ ì´ˆê¸°í™”
        function initializeCharts() {
            // ì˜ì¡´ì„± ì°¨íŠ¸ ì´ˆê¸°í™”
            const ctx = document.getElementById('dependencyChart').getContext('2d');
            dependencyChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['API ë ˆì´ì–´', 'ì„œë¹„ìŠ¤ ë ˆì´ì–´', 'ëª¨ë¸ ë ˆì´ì–´', 'ìœ í‹¸ë¦¬í‹°'],
                    datasets: [{
                        data: [35, 28, 25, 12],
                        backgroundColor: [
                            '#28a745',
                            '#007bff', 
                            '#ffc107',
                            '#6c757d'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                font: {
                                    size: 12
                                }
                            }
                        }
                    }
                }
            });
        }

        // ë¶„ì„ ë°ì´í„° ë¡œë“œ
        async function loadAnalysisData() {
            try {
                console.log('ğŸ“Š ìƒê´€ë„ ë°ì´í„° ë¡œë“œ ì‹œì‘...');
                await loadCorrelationData();
                
                console.log('ğŸ“‹ í”„ë¡œê·¸ë¨ ë¦¬ìŠ¤íŠ¸ ë¡œë“œ ì‹œì‘...');
                await loadProgramList();
                
                console.log('ğŸ—„ï¸ í…Œì´ë¸” ë¦¬ìŠ¤íŠ¸ ë¡œë“œ ì‹œì‘...');
                await loadTableList();
                
                console.log('ğŸ“ˆ ë°ì´í„° ì ì¬ í˜„í™© ë¡œë“œ ì‹œì‘...');
                await loadDataStatus();
                
                console.log('ğŸ—ï¸ í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ ë¡œë“œ ì‹œì‘...');
                await loadClassDiagram('overview');
                
                console.log('âœ… ëª¨ë“  ë¶„ì„ ë°ì´í„° ë¡œë“œ ì™„ë£Œ');
            } catch (error) {
                console.error('âŒ ë¶„ì„ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // CRUD ë§¤íŠ¸ë¦­ìŠ¤ ë°ì´í„° ë¡œë“œ ë° ë Œë”ë§
        async function loadCorrelationData() {
            try {
                console.log('ğŸ”„ /api/analysis/correlation í˜¸ì¶œ ì¤‘...');
                const response = await fetch('/api/analysis/correlation');
                console.log('ğŸ“¡ API ì‘ë‹µ ìƒíƒœ:', response.status, response.statusText);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('ğŸ“¦ ì‘ë‹µ ë°ì´í„°:', data);
                
                if (data.success) {
                    correlationData = data.data;
                    console.log('âœ… CRUD ë§¤íŠ¸ë¦­ìŠ¤ ë°ì´í„° íŒŒì‹± ì™„ë£Œ:', {
                        programs: correlationData.programs?.length,
                        tables: correlationData.tables?.length,
                        matrix: Object.keys(correlationData.matrix || {}).length
                    });
                    renderCrudMatrix(correlationData);
                } else {
                    throw new Error('API ì‘ë‹µ success: false');
                }
            } catch (error) {
                console.error('âŒ ìƒê´€ë„ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                console.log('ğŸ”„ ìƒ˜í”Œ ë°ì´í„°ë¡œ ëŒ€ì²´ ì‹œë„...');
                createSampleCrudMatrix();
            }
        }

        // ìƒ˜í”Œ CRUD ë§¤íŠ¸ë¦­ìŠ¤ ìƒì„±
        function createSampleCrudMatrix() {
            const sampleData = {
                programs: [
                    { id: 'AIRISMonTestSuite', name: 'AIRIS-MON Test Suite', type: 'main' },
                    { id: 'DataSimulator', name: 'Data Simulator', type: 'module' },
                    { id: 'MetricsGenerator', name: 'Metrics Generator', type: 'module' },
                    { id: 'EventSimulator', name: 'Event Simulator', type: 'module' },
                    { id: 'SessionStorage', name: 'Session Storage', type: 'module' },
                    { id: 'NLPSearchTester', name: 'NLP Search Tester', type: 'module' },
                    { id: 'DashboardUI', name: 'Dashboard UI', type: 'frontend' },
                    { id: 'SessionReplayPlayer', name: 'Session Replay Player', type: 'frontend' },
                    { id: 'ApplicationAnalysis', name: 'Application Analysis', type: 'frontend' }
                ],
                tables: [
                    { id: 'kafka_events', name: 'Kafka Events', type: 'datastore' },
                    { id: 'clickhouse_metrics', name: 'ClickHouse Metrics', type: 'datastore' },
                    { id: 'redis_cache', name: 'Redis Cache', type: 'datastore' },
                    { id: 'session_data', name: 'Session Data', type: 'datastore' },
                    { id: 'nlp_queries', name: 'NLP Queries', type: 'datastore' },
                    { id: 'user_sessions', name: 'User Sessions', type: 'datastore' },
                    { id: 'system_logs', name: 'System Logs', type: 'datastore' },
                    { id: 'alert_history', name: 'Alert History', type: 'datastore' }
                ],
                matrix: {
                    'AIRISMonTestSuite': {
                        'kafka_events': ['R'],
                        'clickhouse_metrics': ['R'],
                        'session_data': ['C', 'R'],
                        'system_logs': ['C', 'R']
                    },
                    'DataSimulator': {
                        'kafka_events': ['C'],
                        'clickhouse_metrics': ['C'],
                        'redis_cache': ['C', 'R']
                    },
                    'MetricsGenerator': {
                        'clickhouse_metrics': ['C'],
                        'system_logs': ['C']
                    },
                    'EventSimulator': {
                        'kafka_events': ['C'],
                        'user_sessions': ['C']
                    },
                    'SessionStorage': {
                        'session_data': ['C', 'R', 'U', 'D'],
                        'user_sessions': ['R']
                    },
                    'NLPSearchTester': {
                        'nlp_queries': ['C', 'R'],
                        'clickhouse_metrics': ['R']
                    },
                    'DashboardUI': {
                        'clickhouse_metrics': ['R'],
                        'alert_history': ['R'],
                        'system_logs': ['R']
                    },
                    'SessionReplayPlayer': {
                        'session_data': ['R'],
                        'user_sessions': ['R']
                    },
                    'ApplicationAnalysis': {
                        'clickhouse_metrics': ['R'],
                        'system_logs': ['R']
                    }
                }
            };
            
            renderCrudMatrix(sampleData);
        }

        // CRUD ë§¤íŠ¸ë¦­ìŠ¤ í…Œì´ë¸” ë Œë”ë§
        function renderCrudMatrix(data) {
            console.log('ğŸ”§ CRUD ë§¤íŠ¸ë¦­ìŠ¤ ë Œë”ë§ ì‹œì‘...', data);
            
            const matrix = document.getElementById('crudMatrix');
            if (!matrix) {
                console.error('âŒ crudMatrix ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
                return;
            }
            
            const thead = matrix.querySelector('thead tr');
            const tbody = matrix.querySelector('tbody');
            
            if (!thead || !tbody) {
                console.error('âŒ í…Œì´ë¸” thead ë˜ëŠ” tbodyë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
                return;
            }
            
            console.log('ğŸ“‹ í…Œì´ë¸” ìš”ì†Œ í™•ì¸ ì™„ë£Œ');
            
            // ê¸°ì¡´ ì»¬ëŸ¼ í—¤ë” ì œê±° (ì²« ë²ˆì§¸ ì»¬ëŸ¼ ì œì™¸)
            while (thead.children.length > 1) {
                thead.removeChild(thead.lastChild);
            }
            console.log('ğŸ—‘ï¸ ê¸°ì¡´ í—¤ë” ì œê±° ì™„ë£Œ');
            
            // í…Œì´ë¸” í—¤ë” ì¶”ê°€
            data.tables.forEach((table, index) => {
                const th = document.createElement('th');
                th.textContent = table.name;
                th.title = `${table.name} (${table.type})`;
                thead.appendChild(th);
                console.log(`â• í—¤ë” ì¶”ê°€: ${index + 1}. ${table.name}`);
            });
            
            // ê¸°ì¡´ tbody ë‚´ìš© ì œê±°
            tbody.innerHTML = '';
            console.log('ğŸ—‘ï¸ ê¸°ì¡´ tbody ë‚´ìš© ì œê±° ì™„ë£Œ');
            
            // í”„ë¡œê·¸ë¨ í–‰ ì¶”ê°€
            data.programs.forEach((program, programIndex) => {
                const tr = document.createElement('tr');
                
                // í”„ë¡œê·¸ë¨ ì´ë¦„ ì…€
                const programCell = document.createElement('td');
                programCell.className = 'program-name';
                programCell.innerHTML = `
                    <div>${program.name}</div>
                    <div style="font-size: 11px; color: #666; margin-top: 2px;">${getTypeLabel(program.type)}</div>
                `;
                tr.appendChild(programCell);
                
                // CRUD ì…€ë“¤ ì¶”ê°€
                data.tables.forEach((table, tableIndex) => {
                    const crudCell = document.createElement('td');
                    crudCell.className = 'crud-cell';
                    
                    const crudOps = data.matrix[program.id] && data.matrix[program.id][table.id];
                    if (crudOps && crudOps.length > 0) {
                        const crudContainer = document.createElement('div');
                        crudContainer.className = 'crud-cell-multiple';
                        
                        crudOps.forEach(op => {
                            const badge = document.createElement('span');
                            badge.className = `crud-badge crud-${op.toLowerCase()}`;
                            badge.textContent = op;
                            badge.title = getCrudLabel(op);
                            crudContainer.appendChild(badge);
                        });
                        
                        crudCell.appendChild(crudContainer);
                        console.log(`âœ… CRUD ì¶”ê°€: ${program.name} â†’ ${table.name}: [${crudOps.join(',')}]`);
                    }
                    
                    tr.appendChild(crudCell);
                });
                
                tbody.appendChild(tr);
                console.log(`ğŸ“ í”„ë¡œê·¸ë¨ í–‰ ì¶”ê°€: ${programIndex + 1}. ${program.name}`);
            });
            
            console.log('âœ… CRUD ë§¤íŠ¸ë¦­ìŠ¤ ë Œë”ë§ ì™„ë£Œ:', data.programs.length, 'í”„ë¡œê·¸ë¨ Ã—', data.tables.length, 'í…Œì´ë¸”');
        }
        
        // CRUD ë¼ë²¨ ê°€ì ¸ì˜¤ê¸°
        function getCrudLabel(operation) {
            const labels = {
                'C': 'Create (ìƒì„±)',
                'R': 'Read (ì¡°íšŒ)',
                'U': 'Update (ìˆ˜ì •)',
                'D': 'Delete (ì‚­ì œ)'
            };
            return labels[operation] || operation;
        }

        // í”„ë¡œê·¸ë¨ ë¦¬ìŠ¤íŠ¸ ë¡œë“œ
        async function loadProgramList() {
            try {
                console.log('ğŸ”„ /api/analysis/programs í˜¸ì¶œ ì¤‘...');
                const response = await fetch('/api/analysis/programs');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('ğŸ“¦ í”„ë¡œê·¸ë¨ ì‘ë‹µ ë°ì´í„°:', data);
                
                if (data.success) {
                    programData = data.data;
                    displayProgramList(programData);
                    console.log('âœ… í”„ë¡œê·¸ë¨ ë¦¬ìŠ¤íŠ¸ ë¡œë“œ ì™„ë£Œ:', programData.length, 'ê°œ');
                } else {
                    throw new Error('API ì‘ë‹µ success: false');
                }
            } catch (error) {
                console.error('âŒ í”„ë¡œê·¸ë¨ ë¦¬ìŠ¤íŠ¸ ë¡œë“œ ì‹¤íŒ¨:', error);
                console.log('ğŸ”„ ìƒ˜í”Œ ë°ì´í„°ë¡œ ëŒ€ì²´...');
                displaySampleProgramList();
            }
        }

        // ìƒ˜í”Œ í”„ë¡œê·¸ë¨ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
        function displaySampleProgramList() {
            const programs = [
                {name: 'UserController', type: 'api', complexity: 'medium'},
                {name: 'OrderController', type: 'api', complexity: 'high'},
                {name: 'AuthController', type: 'api', complexity: 'low'},
                {name: 'UserService', type: 'service', complexity: 'medium'},
                {name: 'OrderService', type: 'service', complexity: 'high'},
                {name: 'PaymentService', type: 'service', complexity: 'high'},
                {name: 'User', type: 'model', complexity: 'low'},
                {name: 'Order', type: 'model', complexity: 'medium'},
                {name: 'Product', type: 'model', complexity: 'low'},
                {name: 'DateUtil', type: 'util', complexity: 'low'},
                {name: 'ValidationUtil', type: 'util', complexity: 'medium'},
                {name: 'CryptoUtil', type: 'util', complexity: 'high'}
            ];
            
            displayProgramList(programs);
        }

        // í”„ë¡œê·¸ë¨ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
        function displayProgramList(programs) {
            console.log('ğŸ“‹ í”„ë¡œê·¸ë¨ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ ì‹œì‘...', programs);
            
            const container = document.getElementById('programList');
            if (!container) {
                console.error('âŒ programList ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
                return;
            }
            
            const html = programs.map((program, index) => {
                console.log(`ğŸ“ í”„ë¡œê·¸ë¨ ${index + 1}: ${program.name} (${program.type})`);
                return `
                    <div class="list-item" onclick="showProgramDetail('${program.name}')">
                        <div>
                            <div class="list-item-name">${program.name}</div>
                            <div class="list-item-type type-${getProgramTypeClass(program.type)}">${program.type}</div>
                            <div style="font-size: 11px; color: #999; margin-top: 2px;">${program.loc.toLocaleString()} LOC</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 12px; color: #666;">ë³µì¡ë„</div>
                            <div style="font-size: 10px; color: ${getComplexityColor(program.complexity)}">${getComplexityLabel(program.complexity)}</div>
                            <div style="font-size: 9px; color: #999; margin-top: 2px;">${program.dependencies} deps</div>
                        </div>
                    </div>
                `;
            }).join('');
            
            container.innerHTML = html;
            console.log('âœ… í”„ë¡œê·¸ë¨ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ ì™„ë£Œ:', programs.length, 'ê°œ');
        }
        
        // í”„ë¡œê·¸ë¨ íƒ€ì… í´ë˜ìŠ¤ ë³€í™˜
        function getProgramTypeClass(type) {
            const typeMap = {
                'Main Application': 'api',
                'Service Module': 'service', 
                'Storage Module': 'model',
                'UI Module': 'util'
            };
            return typeMap[type] || 'service';
        }

        // í…Œì´ë¸” ë¦¬ìŠ¤íŠ¸ ë¡œë“œ
        async function loadTableList() {
            try {
                console.log('ğŸ”„ /api/analysis/tables í˜¸ì¶œ ì¤‘...');
                const response = await fetch('/api/analysis/tables');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('ğŸ“¦ í…Œì´ë¸” ì‘ë‹µ ë°ì´í„°:', data);
                
                if (data.success) {
                    tableData = data.data;
                    displayTableList(tableData);
                    console.log('âœ… í…Œì´ë¸” ë¦¬ìŠ¤íŠ¸ ë¡œë“œ ì™„ë£Œ:', tableData.length, 'ê°œ');
                } else {
                    throw new Error('API ì‘ë‹µ success: false');
                }
            } catch (error) {
                console.error('âŒ í…Œì´ë¸” ë¦¬ìŠ¤íŠ¸ ë¡œë“œ ì‹¤íŒ¨:', error);
                console.log('ğŸ”„ ìƒ˜í”Œ ë°ì´í„°ë¡œ ëŒ€ì²´...');
                displaySampleTableList();
            }
        }

        // ìƒ˜í”Œ í…Œì´ë¸” ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
        function displaySampleTableList() {
            const tables = [
                {name: 'users', type: 'master', records: 50000, size: '125MB'},
                {name: 'orders', type: 'transaction', records: 180000, size: '890MB'},
                {name: 'products', type: 'master', records: 15000, size: '45MB'},
                {name: 'order_items', type: 'transaction', records: 650000, size: '1.2GB'},
                {name: 'sessions', type: 'log', records: 120000, size: '230MB'},
                {name: 'audit_logs', type: 'log', records: 500000, size: '2.1GB'},
                {name: 'categories', type: 'master', records: 200, size: '5MB'},
                {name: 'payments', type: 'transaction', records: 95000, size: '340MB'},
                {name: 'user_profiles', type: 'master', records: 48000, size: '180MB'},
                {name: 'error_logs', type: 'log', records: 75000, size: '420MB'}
            ];
            
            displayTableList(tables);
        }

        // í…Œì´ë¸” ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
        function displayTableList(tables) {
            console.log('ğŸ—„ï¸ í…Œì´ë¸” ë¦¬ìŠ¤íŠ¸ í‘œì‹œ ì‹œì‘...', tables);
            
            const container = document.getElementById('tableList');
            if (!container) {
                console.error('âŒ tableList ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
                return;
            }
            
            const html = tables.map((table, index) => {
                console.log(`ğŸ“ í…Œì´ë¸” ${index + 1}: ${table.name} (${table.type})`);
                return `
                    <div class="list-item" onclick="showTableDetail('${table.name}')">
                        <div>
                            <div class="list-item-name">${table.name}</div>
                            <div class="list-item-type type-${getTableTypeClass(table.type)}">${table.type}</div>
                            <div style="font-size: 11px; color: #999; margin-top: 2px;">${table.engine}</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 12px; color: #666;">${getTableMetric(table)}</div>
                            <div style="font-size: 10px; color: #999;">${table.size}</div>
                            <div style="font-size: 9px; color: #999; margin-top: 2px;">${table.connections} conn</div>
                        </div>
                    </div>
                `;
            }).join('');
            
            container.innerHTML = html;
            console.log('âœ… í…Œì´ë¸” ë¦¬ìŠ¤íŠ¸ í‘œì‹œ ì™„ë£Œ:', tables.length, 'ê°œ');
        }
        
        // í…Œì´ë¸” íƒ€ì… í´ë˜ìŠ¤ ë³€í™˜
        function getTableTypeClass(type) {
            const typeMap = {
                'Streaming': 'log',
                'Analytics': 'master',
                'Cache': 'transaction',
                'File Storage': 'master',
                'Model Storage': 'master',
                'Transactional': 'transaction',
                'Search Index': 'log',
                'State Management': 'transaction',
                'Real-time Communication': 'log',
                'Configuration': 'master'
            };
            return typeMap[type] || 'master';
        }
        
        // í…Œì´ë¸” ë©”íŠ¸ë¦­ í‘œì‹œ
        function getTableMetric(table) {
            if (table.records) return table.records.toLocaleString() + ' ë ˆì½”ë“œ';
            if (table.files) return table.files.toLocaleString() + ' íŒŒì¼';
            if (table.models) return table.models + ' ëª¨ë¸';
            if (table.keys) return table.keys.toLocaleString() + ' í‚¤';
            if (table.connections) return table.connections + ' ì—°ê²°';
            return table.size || 'ë°ì´í„°';
        }

        // ë°ì´í„° ì ì¬ í˜„í™© ë¡œë“œ
        async function loadDataStatus() {
            try {
                const response = await fetch('/api/analysis/data-status');
                const data = await response.json();
                
                if (data.success) {
                    displayDataStatus(data.status);
                }
            } catch (error) {
                console.error('ë°ì´í„° í˜„í™© ë¡œë“œ ì‹¤íŒ¨:', error);
                displaySampleDataStatus();
            }
        }

        // ìƒ˜í”Œ ë°ì´í„° í˜„í™© í‘œì‹œ
        function displaySampleDataStatus() {
            const status = [
                {table: 'orders', growth: 95, todayInserts: 1250, status: 'high'},
                {table: 'users', growth: 78, todayInserts: 45, status: 'medium'},
                {table: 'sessions', growth: 88, todayInserts: 3400, status: 'high'},
                {table: 'audit_logs', growth: 92, todayInserts: 8500, status: 'high'},
                {table: 'products', growth: 45, todayInserts: 12, status: 'low'},
                {table: 'payments', growth: 82, todayInserts: 890, status: 'medium'},
                {table: 'categories', growth: 15, todayInserts: 2, status: 'low'},
                {table: 'error_logs', growth: 67, todayInserts: 245, status: 'medium'}
            ];
            
            displayDataStatus(status);
        }

        // ë°ì´í„° í˜„í™© í‘œì‹œ
        function displayDataStatus(status) {
            const container = document.getElementById('dataStatusList');
            container.innerHTML = status.map(item => `
                <div class="list-item">
                    <div>
                        <div class="list-item-name">${item.table}</div>
                        <div style="font-size: 12px; color: #666;">ì˜¤ëŠ˜ ${item.todayInserts?.toLocaleString()} ê±´ ì¶”ê°€</div>
                        <div class="progress-bar">
                            <div class="progress-fill ${item.status}" style="width: ${item.growth}%"></div>
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 14px; font-weight: bold; color: ${getStatusColor(item.status)}">${item.growth}%</div>
                    </div>
                </div>
            `).join('');
        }

        // í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ ë¡œë“œ
        async function loadClassDiagram(type) {
            const diagramId = type === 'overview' ? 'classDiagram' : `${type}Diagram`;
            const container = document.getElementById(diagramId);
            
            // Mermaid ë‹¤ì´ì–´ê·¸ë¨ ìƒì„±
            const diagram = getClassDiagramDefinition(type);
            
            try {
                mermaid.initialize({
                    startOnLoad: false,
                    theme: 'default',
                    flowchart: {
                        useMaxWidth: true,
                        htmlLabels: true
                    }
                });
                
                const { svg } = await mermaid.render(`diagram-${type}`, diagram);
                container.innerHTML = svg;
            } catch (error) {
                console.error('ë‹¤ì´ì–´ê·¸ë¨ ìƒì„± ì‹¤íŒ¨:', error);
                container.innerHTML = '<div style="padding: 50px; text-align: center; color: #666;">ë‹¤ì´ì–´ê·¸ë¨ì„ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
            }
        }

        // í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ ì •ì˜ ìƒì„±
        function getClassDiagramDefinition(type) {
            const diagrams = {
                overview: `
                    classDiagram
                        class UserController {
                            +getUser(id)
                            +createUser(data)
                            +updateUser(id, data)
                            +deleteUser(id)
                        }
                        class UserService {
                            +findById(id)
                            +create(userData)
                            +update(id, data)
                            +delete(id)
                        }
                        class User {
                            +id: Long
                            +name: String
                            +email: String
                            +createdAt: Date
                        }
                        class OrderController {
                            +getOrders()
                            +createOrder(data)
                            +getOrderById(id)
                        }
                        class OrderService {
                            +findAll()
                            +create(orderData)
                            +findById(id)
                        }
                        class Order {
                            +id: Long
                            +userId: Long
                            +amount: BigDecimal
                            +status: String
                        }
                        
                        UserController --> UserService
                        UserService --> User
                        OrderController --> OrderService
                        OrderService --> Order
                        Order --> User
                `,
                api: `
                    classDiagram
                        class BaseController {
                            <<abstract>>
                            +handleException(e)
                            +validateRequest(req)
                        }
                        class UserController {
                            +getUser(id)
                            +createUser(data)
                            +updateUser(id, data)
                            +deleteUser(id)
                        }
                        class OrderController {
                            +getOrders()
                            +createOrder(data)
                            +getOrderById(id)
                            +updateOrderStatus(id, status)
                        }
                        class AuthController {
                            +login(credentials)
                            +logout()
                            +refreshToken()
                        }
                        
                        BaseController <|-- UserController
                        BaseController <|-- OrderController
                        BaseController <|-- AuthController
                `,
                service: `
                    classDiagram
                        class BaseService {
                            <<abstract>>
                            +validateData(data)
                            +handleTransaction()
                        }
                        class UserService {
                            +findById(id)
                            +create(userData)
                            +update(id, data)
                            +delete(id)
                        }
                        class OrderService {
                            +findAll()
                            +create(orderData)
                            +findById(id)
                            +updateStatus(id, status)
                        }
                        class PaymentService {
                            +processPayment(data)
                            +refund(paymentId)
                            +getPaymentStatus(id)
                        }
                        class NotificationService {
                            +sendEmail(to, subject, content)
                            +sendSMS(to, message)
                        }
                        
                        BaseService <|-- UserService
                        BaseService <|-- OrderService
                        BaseService <|-- PaymentService
                        OrderService --> PaymentService
                        OrderService --> NotificationService
                `,
                model: `
                    classDiagram
                        class BaseEntity {
                            <<abstract>>
                            +id: Long
                            +createdAt: Date
                            +updatedAt: Date
                        }
                        class User {
                            +name: String
                            +email: String
                            +password: String
                            +status: UserStatus
                        }
                        class Order {
                            +userId: Long
                            +amount: BigDecimal
                            +status: OrderStatus
                            +orderDate: Date
                        }
                        class OrderItem {
                            +orderId: Long
                            +productId: Long
                            +quantity: Integer
                            +price: BigDecimal
                        }
                        class Product {
                            +name: String
                            +description: String
                            +price: BigDecimal
                            +categoryId: Long
                        }
                        class Category {
                            +name: String
                            +description: String
                        }
                        
                        BaseEntity <|-- User
                        BaseEntity <|-- Order
                        BaseEntity <|-- OrderItem
                        BaseEntity <|-- Product
                        BaseEntity <|-- Category
                        Order --> User
                        OrderItem --> Order
                        OrderItem --> Product
                        Product --> Category
                `
            };
            
            return diagrams[type] || diagrams.overview;
        }

        // í•„í„° ì„¤ì •
        function setupFilters() {
            document.getElementById('programFilter').addEventListener('change', function() {
                filterPrograms(this.value);
            });
            
            document.getElementById('tableFilter').addEventListener('change', function() {
                filterTables(this.value);
            });
            
            document.getElementById('programTypeFilter').addEventListener('change', function() {
                filterCorrelationNetwork();
            });
            
            document.getElementById('tableTypeFilter').addEventListener('change', function() {
                filterCorrelationNetwork();
            });
            
            document.getElementById('crudFilter').addEventListener('change', function() {
                filterCorrelationNetwork();
            });
        }

        // í”„ë¡œê·¸ë¨ í•„í„°ë§
        function filterPrograms(type) {
            if (!programData) return;
            
            const filtered = type ? programData.filter(p => p.type === type) : programData;
            displayProgramList(filtered);
        }

        // í…Œì´ë¸” í•„í„°ë§
        function filterTables(type) {
            if (!tableData) return;
            
            const filtered = type ? tableData.filter(t => t.type === type) : tableData;
            displayTableList(filtered);
        }

        // CRUD ë§¤íŠ¸ë¦­ìŠ¤ í•„í„°ë§
        function filterCorrelationNetwork() {
            const programTypeFilter = document.getElementById('programTypeFilter').value;
            const tableTypeFilter = document.getElementById('tableTypeFilter').value;
            const crudFilter = document.getElementById('crudFilter').value;
            
            if (!correlationData) {
                createSampleCrudMatrix();
                return;
            }
            
            // í•„í„°ë§ëœ ë°ì´í„° ìƒì„±
            let filteredData = {
                programs: correlationData.programs,
                tables: correlationData.tables,
                matrix: correlationData.matrix
            };
            
            // í”„ë¡œê·¸ë¨ íƒ€ì… í•„í„°
            if (programTypeFilter) {
                filteredData.programs = filteredData.programs.filter(p => p.type === programTypeFilter);
            }
            
            // í…Œì´ë¸” íƒ€ì… í•„í„°
            if (tableTypeFilter) {
                filteredData.tables = filteredData.tables.filter(t => t.type === tableTypeFilter);
            }
            
            // CRUD í•„í„°
            if (crudFilter) {
                const newMatrix = {};
                for (const programId in filteredData.matrix) {
                    if (filteredData.programs.find(p => p.id === programId)) {
                        newMatrix[programId] = {};
                        for (const tableId in filteredData.matrix[programId]) {
                            if (filteredData.tables.find(t => t.id === tableId)) {
                                const operations = filteredData.matrix[programId][tableId];
                                if (operations && operations.includes(crudFilter)) {
                                    newMatrix[programId][tableId] = operations;
                                }
                            }
                        }
                    }
                }
                filteredData.matrix = newMatrix;
            }
            
            renderCrudMatrix(filteredData);
        }

        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
        function getTypeLabel(type) {
            const labels = {
                'api': 'API',
                'service': 'ì„œë¹„ìŠ¤',
                'model': 'ëª¨ë¸',
                'util': 'ìœ í‹¸ë¦¬í‹°',
                'master': 'ë§ˆìŠ¤í„°',
                'transaction': 'íŠ¸ëœì­ì…˜',
                'log': 'ë¡œê·¸'
            };
            return labels[type] || type;
        }

        function getComplexityLabel(complexity) {
            const labels = {
                'low': 'ë‚®ìŒ',
                'medium': 'ë³´í†µ',
                'high': 'ë†’ìŒ',
                'very_high': 'ë§¤ìš°ë†’ìŒ'
            };
            return labels[complexity] || complexity;
        }

        function getComplexityColor(complexity) {
            const colors = {
                'low': '#28a745',
                'medium': '#ffc107',
                'high': '#dc3545',
                'very_high': '#6f42c1'
            };
            return colors[complexity] || '#6c757d';
        }

        function getStatusColor(status) {
            const colors = {
                'low': '#dc3545',
                'medium': '#ffc107',
                'high': '#28a745'
            };
            return colors[status] || '#6c757d';
        }

        // ìƒì„¸ ì •ë³´ í‘œì‹œ í•¨ìˆ˜ë“¤
        function showProgramDetail(name) {
            alert(`í”„ë¡œê·¸ë¨ ìƒì„¸ ì •ë³´: ${name}\n(ìƒì„¸ ì •ë³´ ëª¨ë‹¬ì„ êµ¬í˜„í•  ì˜ˆì •)`);
        }

        function showTableDetail(name) {
            alert(`í…Œì´ë¸” ìƒì„¸ ì •ë³´: ${name}\n(ìƒì„¸ ì •ë³´ ëª¨ë‹¬ì„ êµ¬í˜„í•  ì˜ˆì •)`);
        }

        // ë°ì´í„° ìƒˆë¡œê³ ì¹¨
        async function refreshData() {
            const refreshBtn = document.getElementById('refreshBtn');
            refreshBtn.innerHTML = '<div class="spinner"></div>';
            refreshBtn.disabled = true;

            try {
                await loadAnalysisData();
                
                refreshBtn.innerHTML = 'âœ…';
                setTimeout(() => {
                    refreshBtn.innerHTML = 'ğŸ”„';
                    refreshBtn.disabled = false;
                }, 1000);
            } catch (error) {
                console.error('ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨:', error);
                refreshBtn.innerHTML = 'âŒ';
                setTimeout(() => {
                    refreshBtn.innerHTML = 'ğŸ”„';
                    refreshBtn.disabled = false;
                }, 2000);
            }
        }
    </script>
</body>
</html>