<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIRIS-MON 메인 대시보드</title>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
    <script src="/components/common-layout.js"></script>
    
    <style>
        :root {
            --primary: #2563eb;
            --primary-light: #3b82f6;
            --primary-dark: #1d4ed8;
            --white: #ffffff;
            --gray-50: #f8fafc;
            --gray-100: #f1f5f9;
            --gray-200: #e2e8f0;
            --gray-300: #cbd5e1;
            --gray-400: #94a3b8;
            --gray-500: #64748b;
            --gray-600: #475569;
            --gray-700: #334155;
            --gray-800: #1e293b;
            --gray-900: #0f172a;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #06b6d4;
            
            /* 표준 간격 */
            --spacing-xs: 0.25rem;  /* 4px */
            --spacing-sm: 0.5rem;   /* 8px */
            --spacing-md: 1rem;     /* 16px */
            --spacing-lg: 1.5rem;   /* 24px */
            --spacing-xl: 2rem;     /* 32px */
            --spacing-2xl: 3rem;    /* 48px */
            
            /* 표준 반지름 */
            --radius-sm: 0.375rem;  /* 6px */
            --radius-md: 0.5rem;    /* 8px */
            --radius-lg: 0.75rem;   /* 12px */
            --radius-xl: 1rem;      /* 16px */
            
            /* 표준 그림자 */
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--gray-50);
            color: var(--gray-800);
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* 표준 컨테이너 시스템 */
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--spacing-lg);
        }

        /* 표준 그리드 시스템 */
        .grid {
            display: grid;
            gap: var(--spacing-lg);
        }

        .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
        .grid-cols-12 { grid-template-columns: repeat(12, minmax(0, 1fr)); }

        .col-span-1 { grid-column: span 1 / span 1; }
        .col-span-2 { grid-column: span 2 / span 2; }
        .col-span-3 { grid-column: span 3 / span 3; }
        .col-span-4 { grid-column: span 4 / span 4; }
        .col-span-6 { grid-column: span 6 / span 6; }
        .col-span-8 { grid-column: span 8 / span 8; }
        .col-span-12 { grid-column: span 12 / span 12; }

        /* 표준 카드 컴포넌트 */
        .card {
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            transition: all 0.2s ease-in-out;
            overflow: hidden;
        }

        .card:hover {
            box-shadow: var(--shadow-md);
            border-color: var(--gray-300);
        }

        .card-header {
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--gray-200);
            background: var(--gray-50);
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: var(--spacing-sm);
        }

        .card-subtitle {
            font-size: 0.875rem;
            color: var(--gray-600);
        }

        .card-content {
            padding: var(--spacing-lg);
        }

        /* 표준 메트릭 카드 */
        .metric-card {
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            text-align: center;
            transition: all 0.2s ease-in-out;
            position: relative;
            overflow: hidden;
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary);
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
        }

        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-light);
        }

        .metric-label {
            font-size: 0.875rem;
            color: var(--gray-600);
            font-weight: 500;
            margin-bottom: var(--spacing-sm);
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: var(--spacing-xs);
            line-height: 1;
        }

        .metric-change {
            font-size: 0.75rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-xs);
        }

        .metric-change.positive {
            color: var(--success);
        }

        .metric-change.negative {
            color: var(--error);
        }

        /* 표준 버튼 시스템 */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid transparent;
            border-radius: var(--radius-md);
            font-size: 0.875rem;
            font-weight: 500;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            white-space: nowrap;
        }

        .btn-primary {
            background: var(--primary);
            color: var(--white);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: var(--gray-100);
            color: var(--gray-700);
            border-color: var(--gray-300);
        }

        .btn-secondary:hover {
            background: var(--gray-200);
            border-color: var(--gray-400);
        }

        .btn-success {
            background: var(--success);
            color: var(--white);
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-sm {
            padding: var(--spacing-xs) var(--spacing-sm);
            font-size: 0.75rem;
        }

        .btn-lg {
            padding: var(--spacing-md) var(--spacing-lg);
            font-size: 1rem;
        }

        /* 상태 배지 */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .status-badge.success {
            background: #dcfce7;
            color: #166534;
        }

        .status-badge.warning {
            background: #fef3c7;
            color: #92400e;
        }

        .status-badge.error {
            background: #fecaca;
            color: #991b1b;
        }

        .status-badge.info {
            background: #dbeafe;
            color: #1e40af;
        }

        /* 헤더 섹션 */
        .dashboard-header {
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-xl);
            padding: var(--spacing-2xl);
            margin-bottom: var(--spacing-xl);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .dashboard-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--info) 100%);
        }

        .dashboard-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: var(--spacing-md);
        }

        .dashboard-subtitle {
            font-size: 1.125rem;
            color: var(--gray-600);
            margin-bottom: var(--spacing-xl);
        }

        .status-indicators {
            display: flex;
            justify-content: center;
            gap: var(--spacing-md);
            flex-wrap: wrap;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm) var(--spacing-md);
            background: var(--gray-50);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease-in-out;
        }

        .status-indicator:hover {
            background: var(--white);
            border-color: var(--gray-300);
            transform: translateY(-1px);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-dot.success { background: var(--success); }
        .status-dot.warning { background: var(--warning); }
        .status-dot.error { background: var(--error); }
        .status-dot.info { background: var(--info); }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* 빠른 액션 버튼 */
        .quick-actions {
            display: flex;
            gap: var(--spacing-md);
            justify-content: center;
            flex-wrap: wrap;
            margin-top: var(--spacing-xl);
        }

        /* 차트 컨테이너 */
        .chart-container {
            position: relative;
            height: 300px;
            padding: var(--spacing-md);
        }

        /* 터미널 스타일 */
        .terminal {
            background: var(--gray-900);
            color: var(--success);
            font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
            padding: var(--spacing-lg);
            border-radius: var(--radius-md);
            font-size: 0.875rem;
            line-height: 1.6;
            overflow-y: auto;
            height: 300px;
            white-space: pre-wrap;
            border: 1px solid var(--gray-700);
        }

        .terminal::-webkit-scrollbar {
            width: 6px;
        }

        .terminal::-webkit-scrollbar-track {
            background: var(--gray-800);
        }

        .terminal::-webkit-scrollbar-thumb {
            background: var(--gray-600);
            border-radius: 3px;
        }

        /* 반응형 디자인 */
        @media (max-width: 1280px) {
            .grid-cols-4 {
                grid-template-columns: repeat(3, minmax(0, 1fr));
            }
        }

        @media (max-width: 1024px) {
            .dashboard-container {
                padding: var(--spacing-md);
            }
            
            .grid-cols-4,
            .grid-cols-3 {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
            
            .dashboard-title {
                font-size: 2rem;
            }
            
            .col-span-8 {
                grid-column: span 12 / span 12;
            }
        }

        @media (max-width: 768px) {
            .grid-cols-4,
            .grid-cols-3,
            .grid-cols-2 {
                grid-template-columns: repeat(1, minmax(0, 1fr));
            }
            
            .dashboard-title {
                font-size: 1.75rem;
            }
            
            .status-indicators {
                flex-direction: column;
                align-items: center;
            }
            
            .quick-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }

        /* 애니메이션 */
        .fade-in {
            animation: fadeIn 0.6s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* 데이터 테이블 */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }

        .data-table th,
        .data-table td {
            text-align: left;
            padding: var(--spacing-sm) var(--spacing-md);
            border-bottom: 1px solid var(--gray-200);
        }

        .data-table th {
            background: var(--gray-50);
            font-weight: 600;
            color: var(--gray-700);
        }

        .data-table tbody tr:hover {
            background: var(--gray-50);
        }
    </style>
</head>
<body>
    <div class="airis-content-wrapper">
        <!-- 메인 대시보드 헤더 -->
        <div class="dashboard-header fade-in">
            <h1 class="dashboard-title">AIRIS-MON 통합 모니터링 플랫폼</h1>
            <p class="dashboard-subtitle">실시간 시스템 상태 모니터링 및 세션 리플레이 관리</p>
            
            <div class="status-indicators">
                <div class="status-indicator">
                    <div class="status-dot success"></div>
                    시스템 정상
                </div>
                <div class="status-indicator">
                    <span>📊</span>
                    <span>활성 세션 <strong id="live-sessions">12</strong>개</span>
                </div>
                <div class="status-indicator">
                    <span>⚡</span>
                    <span>평균 응답시간 <strong id="avg-response">45ms</strong></span>
                </div>
                <div class="status-indicator">
                    <div class="status-dot warning"></div>
                    <span>알림 <strong id="alert-count">3</strong>건</span>
                </div>
            </div>
            
            <div class="quick-actions">
                <button class="btn btn-primary btn-lg" onclick="startSystemTest()">
                    🚀 시스템 테스트 시작
                </button>
                <button class="btn btn-success btn-lg" onclick="openSessionRecorder()">
                    🎬 세션 녹화 시작
                </button>
                <button class="btn btn-secondary btn-lg" onclick="generateReport()">
                    📊 리포트 생성
                </button>
            </div>
        </div>

        <!-- 메인 대시보드 컨테이너 -->
        <div class="dashboard-container">
            <!-- 핵심 지표 -->
            <section class="grid grid-cols-4 fade-in" style="animation-delay: 0.1s;">
                <div class="metric-card">
                    <div class="metric-label">실행 중인 세션</div>
                    <div class="metric-value" id="active-sessions">12</div>
                    <div class="metric-change positive">
                        <span>↗</span> +2.3%
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-label">API 응답 시간</div>
                    <div class="metric-value" id="response-time">45<span style="font-size: 1rem;">ms</span></div>
                    <div class="metric-change negative">
                        <span>↘</span> -8.2%
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-label">시스템 상태</div>
                    <div class="metric-value" style="color: var(--success); font-size: 1.5rem;">정상</div>
                    <div class="metric-change positive">
                        <span>✅</span> 99.9%
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-label">저장된 세션</div>
                    <div class="metric-value" id="total-sessions">1,247</div>
                    <div class="metric-change positive">
                        <span>↗</span> +15.7%
                    </div>
                </div>
            </section>

            <!-- 메인 대시보드 그리드 -->
            <div class="grid grid-cols-12 gap-6" style="margin-top: var(--spacing-xl);">
                <!-- 주요 기능 -->
                <div class="col-span-8">
                    <div class="grid grid-cols-2 gap-6 fade-in" style="animation-delay: 0.2s;">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">🎬 세션 리플레이</h3>
                                <p class="card-subtitle">사용자 행동을 픽셀 단위로 정확하게 녹화하고 재생</p>
                            </div>
                            <div class="card-content">
                                <div class="grid grid-cols-2 gap-3">
                                    <a href="/integrated-session-recorder-fixed.html" class="btn btn-primary">통합 녹화기</a>
                                    <a href="/enhanced-player.html" class="btn btn-secondary">향상된 플레이어</a>
                                </div>
                                <div class="status-badge success" style="margin-top: var(--spacing-md);">
                                    <span>✓</span> 247개 세션 저장됨
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">📊 프로젝트 분석</h3>
                                <p class="card-subtitle">GitHub/로컬 프로젝트 자동 분석 및 CRUD 매트릭스</p>
                            </div>
                            <div class="card-content">
                                <div class="grid grid-cols-2 gap-3">
                                    <a href="/project-analysis.html" class="btn btn-primary">분석 시작</a>
                                    <a href="/application-analysis.html" class="btn btn-secondary">CRUD 매트릭스</a>
                                </div>
                                <div class="status-badge info" style="margin-top: var(--spacing-md);">
                                    <span>📈</span> 34개 프로젝트 분석됨
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">📡 실시간 모니터링</h3>
                                <p class="card-subtitle">시스템 성능과 상태를 실시간으로 추적</p>
                            </div>
                            <div class="card-content">
                                <div class="grid grid-cols-2 gap-3">
                                    <a href="/application-apm.html" class="btn btn-primary">Application APM</a>
                                    <a href="/infrastructure-monitoring.html" class="btn btn-secondary">인프라 모니터링</a>
                                </div>
                                <div class="status-badge success" style="margin-top: var(--spacing-md);">
                                    <span>🟢</span> 모든 서비스 정상
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">🔍 분석 도구</h3>
                                <p class="card-subtitle">고급 데이터 시각화 및 사용자 행동 분석</p>
                            </div>
                            <div class="card-content">
                                <div class="grid grid-cols-2 gap-3">
                                    <a href="/click-heatmap-analyzer.html" class="btn btn-primary">클릭 히트맵</a>
                                    <a href="/trace-sequence-diagram.html" class="btn btn-secondary">시퀀스 다이어그램</a>
                                </div>
                                <div class="status-badge warning" style="margin-top: var(--spacing-md);">
                                    <span>⚡</span> 실시간 분석 중
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 실시간 차트 -->
                    <div class="card fade-in" style="margin-top: var(--spacing-lg); animation-delay: 0.4s;">
                        <div class="card-header">
                            <h3 class="card-title">📈 실시간 시스템 메트릭</h3>
                            <p class="card-subtitle">CPU, 메모리, 네트워크 사용률 실시간 모니터링</p>
                        </div>
                        <div class="card-content">
                            <div class="chart-container">
                                <canvas id="realtime-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 사이드바 -->
                <div class="col-span-4">
                    <!-- 시스템 제어 -->
                    <div class="card fade-in" style="animation-delay: 0.3s;">
                        <div class="card-header">
                            <h3 class="card-title">⚙️ 시스템 제어</h3>
                            <p class="card-subtitle">테스트 및 모니터링 기능 중앙 제어</p>
                        </div>
                        <div class="card-content">
                            <div class="grid grid-cols-1 gap-3">
                                <button id="start-tests" class="btn btn-success">🚀 모든 테스트 실행</button>
                                <button id="stop-tests" class="btn btn-secondary">⏹️ 테스트 중지</button>
                                <button id="generate-data" class="btn btn-primary">📋 테스트 데이터 생성</button>
                                <button id="real-time-monitor" class="btn btn-secondary">👁️ 실시간 모니터링</button>
                            </div>
                        </div>
                    </div>

                    <!-- 시스템 로그 -->
                    <div class="card fade-in" style="margin-top: var(--spacing-lg); animation-delay: 0.5s;">
                        <div class="card-header">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <h3 class="card-title">🖥️ 시스템 로그</h3>
                                    <p class="card-subtitle">실시간 시스템 이벤트 로그</p>
                                </div>
                                <button id="clear-logs" class="btn btn-sm btn-secondary">지우기</button>
                            </div>
                        </div>
                        <div class="card-content" style="padding: 0;">
                            <div id="system-logs" class="terminal">AIRIS-MON 시스템 초기화 완료...
시스템 상태: 정상
모든 서비스 실행 중...
세션 저장소 연결됨
실시간 모니터링 활성화됨</div>
                        </div>
                    </div>

                    <!-- 최근 활동 -->
                    <div class="card fade-in" style="margin-top: var(--spacing-lg); animation-delay: 0.6s;">
                        <div class="card-header">
                            <h3 class="card-title">📋 최근 활동</h3>
                            <p class="card-subtitle">최근 시스템 활동 및 세션</p>
                        </div>
                        <div class="card-content">
                            <table class="data-table">
                                <tbody>
                                    <tr>
                                        <td>
                                            <div class="status-badge success" style="margin-bottom: 4px;">세션 저장</div>
                                            <div style="font-size: 0.75rem; color: var(--gray-500);">session_1234567</div>
                                        </td>
                                        <td style="font-size: 0.75rem; color: var(--gray-500);">2분 전</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="status-badge info" style="margin-bottom: 4px;">프로젝트 분석</div>
                                            <div style="font-size: 0.75rem; color: var(--gray-500);">React 프로젝트</div>
                                        </td>
                                        <td style="font-size: 0.75rem; color: var(--gray-500);">5분 전</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="status-badge warning" style="margin-bottom: 4px;">경고 발생</div>
                                            <div style="font-size: 0.75rem; color: var(--gray-500);">높은 CPU 사용률</div>
                                        </td>
                                        <td style="font-size: 0.75rem; color: var(--gray-500);">12분 전</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="status-badge success" style="margin-bottom: 4px;">테스트 완료</div>
                                            <div style="font-size: 0.75rem; color: var(--gray-500);">시스템 헬스체크</div>
                                        </td>
                                        <td style="font-size: 0.75rem; color: var(--gray-500);">18분 전</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 전역 상태 관리
        const DashboardState = {
            isTestRunning: false,
            activeChart: null,
            logCount: 0
        };

        // 유틸리티 함수들
        function formatTime() {
            return new Date().toLocaleTimeString('ko-KR');
        }

        function addLog(message, type = 'info') {
            const logs = document.getElementById('system-logs');
            const timestamp = formatTime();
            const logEntry = `[${timestamp}] ${message}`;
            logs.textContent += '\n' + logEntry;
            logs.scrollTop = logs.scrollHeight;
            DashboardState.logCount++;
        }

        function updateMetrics() {
            // 실시간 메트릭 업데이트 시뮬레이션
            const sessions = Math.floor(Math.random() * 5) + 10;
            const responseTime = Math.floor(Math.random() * 20) + 35;
            const totalSessions = 1247 + Math.floor(Math.random() * 10);

            document.getElementById('active-sessions').textContent = sessions;
            document.getElementById('live-sessions').textContent = sessions;
            document.getElementById('response-time').innerHTML = responseTime + '<span style="font-size: 1rem;">ms</span>';
            document.getElementById('avg-response').textContent = responseTime + 'ms';
            document.getElementById('total-sessions').textContent = totalSessions.toLocaleString();

            // 차트 업데이트
            if (DashboardState.activeChart) {
                updateChart();
            }
        }

        // 실시간 차트 초기화
        function initChart() {
            const ctx = document.getElementById('realtime-chart');
            if (!ctx) return;

            DashboardState.activeChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [
                        {
                            label: 'CPU 사용률 (%)',
                            data: [],
                            borderColor: 'rgb(37, 99, 235)',
                            backgroundColor: 'rgba(37, 99, 235, 0.1)',
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: '메모리 사용률 (%)',
                            data: [],
                            borderColor: 'rgb(16, 185, 129)',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: '네트워크 I/O (Mbps)',
                            data: [],
                            borderColor: 'rgb(245, 158, 11)',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            tension: 0.4,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    plugins: {
                        legend: {
                            position: 'top'
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: 'white',
                            bodyColor: 'white'
                        }
                    },
                    scales: {
                        x: {
                            display: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        y: {
                            display: true,
                            beginAtZero: true,
                            max: 100,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    },
                    elements: {
                        point: {
                            radius: 3,
                            hoverRadius: 6
                        }
                    }
                }
            });
        }

        function updateChart() {
            if (!DashboardState.activeChart) return;

            const now = formatTime();
            const chart = DashboardState.activeChart;

            // 새 데이터 추가
            chart.data.labels.push(now);
            chart.data.datasets[0].data.push(Math.random() * 40 + 30); // CPU
            chart.data.datasets[1].data.push(Math.random() * 30 + 50); // Memory
            chart.data.datasets[2].data.push(Math.random() * 20 + 10); // Network

            // 최대 20개 데이터 포인트 유지
            if (chart.data.labels.length > 20) {
                chart.data.labels.shift();
                chart.data.datasets.forEach(dataset => dataset.data.shift());
            }

            chart.update('none');
        }

        // 이벤트 핸들러들
        function startSystemTest() {
            if (DashboardState.isTestRunning) {
                addLog('테스트가 이미 실행 중입니다.', 'warning');
                return;
            }

            DashboardState.isTestRunning = true;
            addLog('🚀 시스템 테스트 시작', 'info');
            
            document.getElementById('start-tests').disabled = true;
            document.getElementById('start-tests').textContent = '⏳ 테스트 실행 중...';

            // 테스트 시뮬레이션
            setTimeout(() => {
                addLog('✅ 시스템 테스트 완료 - 모든 테스트 통과', 'success');
                DashboardState.isTestRunning = false;
                document.getElementById('start-tests').disabled = false;
                document.getElementById('start-tests').textContent = '🚀 모든 테스트 실행';
            }, 3000);
        }

        function openSessionRecorder() {
            addLog('🎬 세션 녹화기 열기...', 'info');
            window.open('/integrated-session-recorder-fixed.html', '_blank');
        }

        function generateReport() {
            addLog('📊 시스템 리포트 생성 시작...', 'info');
            setTimeout(() => {
                addLog('📋 리포트 생성 완료 - 다운로드 준비됨', 'success');
            }, 2000);
        }

        // DOM 로드 완료 후 초기화
        document.addEventListener('DOMContentLoaded', function() {
            addLog('AIRIS-MON 대시보드 초기화 완료', 'success');
            
            // 차트 초기화
            setTimeout(() => {
                initChart();
                addLog('실시간 차트 초기화 완료', 'info');
            }, 500);

            // 이벤트 리스너 등록
            document.getElementById('start-tests').addEventListener('click', startSystemTest);
            document.getElementById('stop-tests').addEventListener('click', () => {
                addLog('⏹️ 모든 테스트 중지', 'info');
                DashboardState.isTestRunning = false;
            });
            
            document.getElementById('generate-data').addEventListener('click', () => {
                addLog('📋 테스트 데이터 생성 완료', 'info');
            });
            
            document.getElementById('real-time-monitor').addEventListener('click', () => {
                addLog('👁️ 실시간 모니터링 활성화', 'info');
            });

            document.getElementById('clear-logs').addEventListener('click', () => {
                document.getElementById('system-logs').textContent = 'AIRIS-MON 시스템 초기화 완료...\n시스템 상태: 정상\n모든 서비스 실행 중...';
                DashboardState.logCount = 0;
            });

            // 정기 업데이트 시작
            setInterval(updateMetrics, 3000);
            setInterval(() => addLog('시스템 상태 정상 - 자동 체크'), 30000);
        });

        // 페이지 언로드 시 정리
        window.addEventListener('beforeunload', function() {
            if (DashboardState.activeChart) {
                DashboardState.activeChart.destroy();
            }
        });
    </script>
</body>
</html>