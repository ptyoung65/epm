<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIRIS EPM GraphQL Playground</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/graphql-playground-react@1.7.28/build/static/css/index.css" />
    <link rel="shortcut icon" href="https://cdn.jsdelivr.net/npm/graphql-playground-react@1.7.28/build/favicon.png" />
    <script src="https://cdn.jsdelivr.net/npm/graphql-playground-react@1.7.28/build/static/js/middleware.js"></script>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: "Malgun Gothic", "ë§‘ì€ ê³ ë”•", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            height: 100vh;
            overflow: hidden;
        }
        
        .loading-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-top: 5px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 18px;
            margin-bottom: 10px;
        }
        
        .loading-subtitle {
            font-size: 14px;
            opacity: 0.8;
        }
        
        /* Custom header overlay */
        .custom-header-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(31, 41, 55, 0.95);
            color: white;
            padding: 10px 20px;
            z-index: 10000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            border-bottom: 1px solid #374151;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #48bb78;
            display: inline-block;
            margin-right: 5px;
        }
        
        .quick-query-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 5px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: background-color 0.3s;
        }
        
        .quick-query-btn:hover {
            background: #5a67d8;
        }
        
        /* Playground container adjustment */
        .playground-container {
            margin-top: 50px;
            height: calc(100vh - 50px);
        }
        
        /* Custom GraphQL Playground styling */
        .graphiql-container {
            height: 100% !important;
        }
        
        /* Hide default headers if present */
        .playground .title-area,
        .playground .toolbar {
            display: none !important;
        }
    </style>
</head>
<body>
    <div id="loading" class="loading-container">
        <div class="loading-spinner"></div>
        <div class="loading-text">AIRIS EPM GraphQL Playground ë¡œë”© ì¤‘...</div>
        <div class="loading-subtitle">Enterprise Performance Management GraphQL API</div>
    </div>
    
    <div class="custom-header-overlay">
        <div class="header-left">
            <div>
                <span class="status-dot"></span>
                <strong>AIRIS EPM GraphQL API</strong>
            </div>
            <div style="color: #9ca3af;">v1.0.0</div>
        </div>
        <div class="header-right">
            <button class="quick-query-btn" onclick="loadExampleQuery('metrics')">ì„±ëŠ¥ ë©”íŠ¸ë¦­</button>
            <button class="quick-query-btn" onclick="loadExampleQuery('health')">ì‹œìŠ¤í…œ ìƒíƒœ</button>
            <button class="quick-query-btn" onclick="loadExampleQuery('alerts')">ì•Œë¦¼ ì¡°íšŒ</button>
            <a href="./swagger-ui.html" style="color: #60a5fa; text-decoration: none;">REST API ë¬¸ì„œ</a>
        </div>
    </div>
    
    <div id="root" class="playground-container"></div>

    <script>
        // GraphQL endpoint ì„¤ì •
        const GRAPHQL_ENDPOINT = '/graphql';
        
        // ì˜ˆì œ ì¿¼ë¦¬ë“¤
        const EXAMPLE_QUERIES = {
            metrics: `# ì„±ëŠ¥ ë©”íŠ¸ë¦­ ì¡°íšŒ ì˜ˆì œ
query GetPerformanceMetrics($timeRange: TimeRange, $metricType: MetricType) {
  metrics(timeRange: $timeRange, metricType: $metricType, limit: 10) {
    success
    metrics {
      timestamp
      metricType
      value
      tags
    }
    metadata {
      totalCount
      timeRange
      aggregation
      queryDuration
    }
  }
}

# Variables
# {
#   "timeRange": "HOUR_1",
#   "metricType": "CPU"
# }`,
            
            health: `# ì‹œìŠ¤í…œ ìƒíƒœ ì¡°íšŒ ì˜ˆì œ
query GetSystemHealth {
  health {
    status
    timestamp
    version
    uptime
    dependencies {
      service
      status
      latency
      lastCheck
    }
    metrics {
      cpuUsage
      memoryUsage
      diskUsage
      networkLatency
      activeConnections
    }
  }
}`,
            
            alerts: `# ì•Œë¦¼ ì¡°íšŒ ì˜ˆì œ
query GetAlerts($status: AlertStatus, $severity: SeverityLevel) {
  alerts(status: $status, severity: $severity, limit: 20) {
    success
    alerts {
      id
      title
      description
      severity
      status
      createdAt
      updatedAt
      affectedServices
      rule {
        id
        name
        condition
      }
    }
    summary {
      active
      acknowledged
      resolved
      bySeverity {
        low
        medium
        high
        critical
      }
    }
  }
}

# Variables
# {
#   "status": "ACTIVE",
#   "severity": "HIGH"
# }`,
            
            dashboard: `# ëŒ€ì‹œë³´ë“œ ë°ì´í„° ì¡°íšŒ ì˜ˆì œ
query GetDashboardData($dashboardId: String!, $timeRange: TimeRange) {
  dashboard(dashboardId: $dashboardId, timeRange: $timeRange) {
    success
    dashboardId
    title
    widgets {
      id
      type
      title
      position {
        x
        y
        width
        height
      }
      data
      config
    }
    lastUpdated
    refreshInterval
  }
}

# Variables
# {
#   "dashboardId": "main-dashboard",
#   "timeRange": "DAY_1"
# }`,
            
            mutations: `# ë°ì´í„° ë³€ê²½ ì˜ˆì œ (ë®¤í…Œì´ì…˜)

# 1. ì„±ëŠ¥ ë©”íŠ¸ë¦­ ì œì¶œ
mutation SubmitMetrics($input: MetricsInput!) {
  submitMetrics(input: $input) {
    success
    message
  }
}

# 2. ì•Œë¦¼ ê·œì¹™ ìƒì„±
mutation CreateAlertRule($input: AlertRuleInput!) {
  createAlertRule(input: $input) {
    success
    rule {
      id
      name
      description
      condition
      severity
      enabled
    }
  }
}

# 3. ì•Œë¦¼ ìƒíƒœ ì—…ë°ì´íŠ¸
mutation UpdateAlertStatus($id: ID!, $status: AlertStatus!, $comment: String) {
  updateAlertStatus(id: $id, status: $status, comment: $comment) {
    id
    status
    updatedAt
    history {
      timestamp
      eventType
      message
      user
    }
  }
}`,
            
            subscriptions: `# ì‹¤ì‹œê°„ êµ¬ë… ì˜ˆì œ

# 1. ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ êµ¬ë…
subscription MetricsUpdates($metricTypes: [MetricType!]) {
  metricsUpdates(metricTypes: $metricTypes) {
    timestamp
    metricType
    value
    tags
  }
}

# 2. ìƒˆ ì•Œë¦¼ êµ¬ë…
subscription AlertTriggered($severity: SeverityLevel) {
  alertTriggered(severity: $severity) {
    id
    title
    description
    severity
    status
    createdAt
    affectedServices
  }
}

# 3. ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸ êµ¬ë…
subscription DashboardUpdates($dashboardId: String!) {
  dashboardUpdates(dashboardId: $dashboardId) {
    dashboardId
    widgets {
      id
      type
      data
    }
    lastUpdated
  }
}`
        };
        
        // ì˜ˆì œ ì¿¼ë¦¬ ë¡œë“œ í•¨ìˆ˜
        function loadExampleQuery(type) {
            if (window.playgroundInstance && EXAMPLE_QUERIES[type]) {
                window.playgroundInstance.setQuery(EXAMPLE_QUERIES[type]);
            }
        }
        
        // GraphQL Playground ì´ˆê¸°í™”
        function initPlayground() {
            try {
                GraphQLPlayground.init(document.getElementById('root'), {
                    endpoint: GRAPHQL_ENDPOINT,
                    
                    // ì„¤ì • ì˜µì…˜
                    settings: {
                        'editor.theme': 'dark',
                        'editor.reuseHeaders': true,
                        'tracing.hideTracingResponse': false,
                        'queryPlan.hideQueryPlanResponse': false,
                        'editor.fontSize': 14,
                        'editor.fontFamily': '"Fira Code", "Consolas", "Inconsolata", "Droid Sans Mono", "Monaco", monospace',
                        'request.credentials': 'include',
                    },
                    
                    // íƒ­ ì„¤ì •
                    tabs: [
                        {
                            name: 'ì‹œì‘í•˜ê¸°',
                            query: `# AIRIS EPM GraphQL APIì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!
# ì´ APIëŠ” Enterprise Performance Management ì‹œìŠ¤í…œì˜ ëª¨ë“  ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

# ğŸ“Š ê¸°ë³¸ ì¿¼ë¦¬ ì˜ˆì œ - ì‹œìŠ¤í…œ ì •ë³´ ì¡°íšŒ
query GetApiInfo {
  apiInfo {
    version
    name
    description
    documentation
    rateLimits {
      requestsPerHour
      requestsPerMinute
      burstLimit
    }
  }
}

# ğŸ” ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸
query HealthCheck {
  health {
    status
    version
    uptime
    dependencies {
      service
      status
      latency
    }
  }
}

# ğŸ’¡ íŒ:
# - ìš°ì¸¡ ìƒë‹¨ì˜ ë¹ ë¥¸ ì¿¼ë¦¬ ë²„íŠ¼ì„ ì‚¬ìš©í•´ë³´ì„¸ìš”
# - Ctrl+Spaceë¡œ ìë™ì™„ì„±ì„ í™œìš©í•˜ì„¸ìš”
# - ìŠ¤í‚¤ë§ˆ íƒ­ì—ì„œ ì „ì²´ API êµ¬ì¡°ë¥¼ í™•ì¸í•˜ì„¸ìš”`,
                            variables: '{}',
                            headers: JSON.stringify({
                                'Authorization': 'Bearer YOUR_API_TOKEN',
                                'Content-Type': 'application/json'
                            }, null, 2)
                        }
                    ],
                    
                    // í—¤ë” ì„¤ì •
                    headers: {
                        'Authorization': 'Bearer YOUR_API_TOKEN'
                    },
                    
                    // ìŠ¤í‚¤ë§ˆ ì„¤ì •
                    schemaPath: './schema.graphql',
                    
                    // í•œêµ­ì–´ ì§€ì›
                    workspaceName: 'AIRIS EPM API',
                    
                    // ê°œë°œì ë„êµ¬
                    env: {
                        NODE_ENV: 'development'
                    },
                    
                    // ì»¤ìŠ¤í…€ ë¡œê³ 
                    title: 'AIRIS EPM GraphQL API',
                    
                    // ì„±ëŠ¥ ì˜µì…˜
                    introspection: true,
                    playground: true
                });
                
                // ë¡œë”© í™”ë©´ ìˆ¨ê¸°ê¸°
                setTimeout(() => {
                    document.getElementById('loading').style.display = 'none';
                }, 1500);
                
            } catch (error) {
                console.error('GraphQL Playground ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
                
                // ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
                document.getElementById('loading').innerHTML = `
                    <div style="color: #f56565;">
                        <h2>âŒ GraphQL Playground ë¡œë”© ì‹¤íŒ¨</h2>
                        <p>GraphQL ì—”ë“œí¬ì¸íŠ¸ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                        <p>ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.</p>
                        <button onclick="location.reload()" style="
                            background: white;
                            color: #667eea;
                            border: none;
                            padding: 10px 20px;
                            border-radius: 5px;
                            cursor: pointer;
                            margin-top: 20px;
                        ">ë‹¤ì‹œ ì‹œë„</button>
                    </div>
                `;
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('load', function() {
            // GraphQL Playground ìŠ¤í¬ë¦½íŠ¸ê°€ ë¡œë“œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼
            if (typeof GraphQLPlayground !== 'undefined') {
                initPlayground();
            } else {
                // ìŠ¤í¬ë¦½íŠ¸ ë™ì  ë¡œë“œ
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/graphql-playground-react@1.7.28/build/static/js/middleware.js';
                script.onload = initPlayground;
                script.onerror = function() {
                    document.getElementById('loading').innerHTML = `
                        <div style="color: #f56565;">
                            <h2>âŒ ìŠ¤í¬ë¦½íŠ¸ ë¡œë”© ì‹¤íŒ¨</h2>
                            <p>GraphQL Playground ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                            <p>ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.</p>
                        </div>
                    `;
                };
                document.head.appendChild(script);
            }
        });
        
        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + Enter: ì¿¼ë¦¬ ì‹¤í–‰
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                // GraphQL Playgroundì˜ ì‹¤í–‰ ë²„íŠ¼ í´ë¦­ ì‹œë®¬ë ˆì´ì…˜
                const executeButton = document.querySelector('.execute-button, [aria-label="Execute Query"]');
                if (executeButton) {
                    executeButton.click();
                }
            }
            
            // F1: ë„ì›€ë§
            if (e.key === 'F1') {
                e.preventDefault();
                alert(`
AIRIS EPM GraphQL Playground ë„ì›€ë§:

ğŸš€ ë¹ ë¥¸ ì‹œì‘:
- ì¢Œì¸¡ íŒ¨ë„ì—ì„œ ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ì„¸ìš”
- ìš°ì¸¡ ìƒë‹¨ ë²„íŠ¼ë“¤ë¡œ ì˜ˆì œ ì¿¼ë¦¬ë¥¼ ë¡œë“œí•˜ì„¸ìš”
- Schema íƒ­ì—ì„œ ì „ì²´ API êµ¬ì¡°ë¥¼ í™•ì¸í•˜ì„¸ìš”

âŒ¨ï¸ í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤:
- Ctrl/Cmd + Enter: ì¿¼ë¦¬ ì‹¤í–‰
- Ctrl/Cmd + /: ì£¼ì„ í† ê¸€
- Ctrl + Space: ìë™ì™„ì„±
- F1: ì´ ë„ì›€ë§ ë³´ê¸°

ğŸ”‘ ì¸ì¦:
- Headers íƒ­ì—ì„œ Authorization í—¤ë”ë¥¼ ì„¤ì •í•˜ì„¸ìš”
- Bearer í† í° í˜•ì‹ì„ ì‚¬ìš©í•˜ì„¸ìš”

ğŸ“š ë” ë§ì€ ì •ë³´:
- REST API ë¬¸ì„œ: ./swagger-ui.html
- ê°œë°œì ê°€ì´ë“œ: /developer-portal
                `);
            }
        });
        
        // ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ë§
        window.addEventListener('resize', function() {
            // Playground ë ˆì´ì•„ì›ƒ ì¬ì¡°ì •
            if (window.playgroundInstance && window.playgroundInstance.resize) {
                window.playgroundInstance.resize();
            }
        });
    </script>
</body>
</html>